import{$ as Ze,A as og,Aa as yg,Ab as kg,B as au,Ba as xi,Bb as Ng,Cb as Ge,D as Lt,Db as Li,E as xn,Ea as Mi,Eb as Og,F as Mn,Fa as _g,Fb as xg,Gb as Mg,H as cu,Hb as Su,I as mr,Ia as vg,Ib as Lg,J as uo,Ja as Ig,Jb as _r,K as on,Ka as wg,Kb as Vg,L as uu,La as fo,M as ag,Ma as Eg,N as lu,Na as po,O as hu,Oa as Iu,P as ot,Q as cg,R as Oe,Ra as Tg,Rb as Fg,S as ce,Sa as Ag,Sb as Ug,Ta as wu,Tb as bu,U as ee,Ua as Eu,Ub as Bg,V as lo,Va as Sg,Vb as $g,W as ug,X as ue,Y as du,Z as ie,_ as V,a as L,aa as an,b as be,ba as lg,c as rn,ca as cn,d as y,da as ze,e as tg,ea as fu,f as tu,fa as pu,fb as bg,g as On,h as nu,i as ru,ia as gu,j as sn,ja as et,k as Ne,ka as Oi,l as ng,la as hg,m as rg,ma as ho,n as Mt,na as yr,o as co,oa as Ie,p as iu,pa as mu,q as su,qa as dg,r as $e,s as j,sa as yu,sb as Rg,t as Ni,ta as fg,tb as Cg,u as ig,ua as _u,ub as Pg,v as sg,va as pg,w as Z,wa as Ln,wb as Tu,x as gr,xa as vu,xb as Au,y as qe,ya as gg,yb as Dg,z as ou,za as mg}from"./chunk-APAHP2TZ.js";var yo=new ue(""),Du=(()=>{class n{_zone;_plugins;_eventNameToPlugin=new Map;constructor(t,r){this._zone=r,t.forEach(i=>{i.manager=this}),this._plugins=t.slice().reverse()}addEventListener(t,r,i,s){return this._findPluginFor(r).addEventListener(t,r,i,s)}getZone(){return this._zone}_findPluginFor(t){let r=this._eventNameToPlugin.get(t);if(r)return r;if(r=this._plugins.find(s=>s.supports(t)),!r)throw new ce(5101,!1);return this._eventNameToPlugin.set(t,r),r}static \u0275fac=function(r){return new(r||n)(ie(yo),ie(Ie))};static \u0275prov=ee({token:n,factory:n.\u0275fac})}return n})(),Vi=class{_doc;constructor(e){this._doc=e}manager},go="ng-app-id";function jg(n){for(let e of n)e.remove()}function qg(n,e){let t=e.createElement("style");return t.textContent=n,t}function Gw(n,e,t,r){let i=n.head?.querySelectorAll(`style[${go}="${e}"],link[${go}="${e}"]`);if(i)for(let s of i)s.removeAttribute(go),s instanceof HTMLLinkElement?r.set(s.href.slice(s.href.lastIndexOf("/")+1),{usage:0,elements:[s]}):s.textContent&&t.set(s.textContent,{usage:0,elements:[s]})}function Cu(n,e){let t=e.createElement("link");return t.setAttribute("rel","stylesheet"),t.setAttribute("href",n),t}var ku=(()=>{class n{doc;appId;nonce;inline=new Map;external=new Map;hosts=new Set;isServer;constructor(t,r,i,s={}){this.doc=t,this.appId=r,this.nonce=i,this.isServer=bu(s),Gw(t,r,this.inline,this.external),this.hosts.add(t.head)}addStyles(t,r){for(let i of t)this.addUsage(i,this.inline,qg);r?.forEach(i=>this.addUsage(i,this.external,Cu))}removeStyles(t,r){for(let i of t)this.removeUsage(i,this.inline);r?.forEach(i=>this.removeUsage(i,this.external))}addUsage(t,r,i){let s=r.get(t);s?s.usage++:r.set(t,{usage:1,elements:[...this.hosts].map(o=>this.addElement(o,i(t,this.doc)))})}removeUsage(t,r){let i=r.get(t);i&&(i.usage--,i.usage<=0&&(jg(i.elements),r.delete(t)))}ngOnDestroy(){for(let[,{elements:t}]of[...this.inline,...this.external])jg(t);this.hosts.clear()}addHost(t){this.hosts.add(t);for(let[r,{elements:i}]of this.inline)i.push(this.addElement(t,qg(r,this.doc)));for(let[r,{elements:i}]of this.external)i.push(this.addElement(t,Cu(r,this.doc)))}removeHost(t){this.hosts.delete(t)}addElement(t,r){return this.nonce&&r.setAttribute("nonce",this.nonce),this.isServer&&r.setAttribute(go,this.appId),t.appendChild(r)}static \u0275fac=function(r){return new(r||n)(ie(Ge),ie(_u),ie(vu,8),ie(Ln))};static \u0275prov=ee({token:n,factory:n.\u0275fac})}return n})(),Ru={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/",math:"http://www.w3.org/1998/Math/MathML"},Nu=/%COMP%/g;var Hg="%COMP%",Kw=`_nghost-${Hg}`,Qw=`_ngcontent-${Hg}`,Yw=!0,Jw=new ue("",{providedIn:"root",factory:()=>Yw});function Xw(n){return Qw.replace(Nu,n)}function Zw(n){return Kw.replace(Nu,n)}function Wg(n,e){return e.map(t=>t.replace(Nu,n))}var Ou=(()=>{class n{eventManager;sharedStylesHost;appId;removeStylesOnCompDestroy;doc;platformId;ngZone;nonce;tracingService;rendererByCompId=new Map;defaultRenderer;platformIsServer;constructor(t,r,i,s,o,c,u,h=null,f=null){this.eventManager=t,this.sharedStylesHost=r,this.appId=i,this.removeStylesOnCompDestroy=s,this.doc=o,this.platformId=c,this.ngZone=u,this.nonce=h,this.tracingService=f,this.platformIsServer=bu(c),this.defaultRenderer=new Fi(t,o,u,this.platformIsServer,this.tracingService)}createRenderer(t,r){if(!t||!r)return this.defaultRenderer;this.platformIsServer&&r.encapsulation===xi.ShadowDom&&(r=be(L({},r),{encapsulation:xi.Emulated}));let i=this.getOrCreateRenderer(t,r);return i instanceof mo?i.applyToHost(t):i instanceof Ui&&i.applyStyles(),i}getOrCreateRenderer(t,r){let i=this.rendererByCompId,s=i.get(r.id);if(!s){let o=this.doc,c=this.ngZone,u=this.eventManager,h=this.sharedStylesHost,f=this.removeStylesOnCompDestroy,g=this.platformIsServer,_=this.tracingService;switch(r.encapsulation){case xi.Emulated:s=new mo(u,h,r,this.appId,f,o,c,g,_);break;case xi.ShadowDom:return new Pu(u,h,t,r,o,c,this.nonce,g,_);default:s=new Ui(u,h,r,f,o,c,g,_);break}i.set(r.id,s)}return s}ngOnDestroy(){this.rendererByCompId.clear()}componentReplaced(t){this.rendererByCompId.delete(t)}static \u0275fac=function(r){return new(r||n)(ie(Du),ie(ku),ie(_u),ie(Jw),ie(Ge),ie(Ln),ie(Ie),ie(vu),ie(gg,8))};static \u0275prov=ee({token:n,factory:n.\u0275fac})}return n})(),Fi=class{eventManager;doc;ngZone;platformIsServer;tracingService;data=Object.create(null);throwOnSyntheticProps=!0;constructor(e,t,r,i,s){this.eventManager=e,this.doc=t,this.ngZone=r,this.platformIsServer=i,this.tracingService=s}destroy(){}destroyNode=null;createElement(e,t){return t?this.doc.createElementNS(Ru[t]||t,e):this.doc.createElement(e)}createComment(e){return this.doc.createComment(e)}createText(e){return this.doc.createTextNode(e)}appendChild(e,t){(zg(e)?e.content:e).appendChild(t)}insertBefore(e,t,r){e&&(zg(e)?e.content:e).insertBefore(t,r)}removeChild(e,t){t.remove()}selectRootElement(e,t){let r=typeof e=="string"?this.doc.querySelector(e):e;if(!r)throw new ce(-5104,!1);return t||(r.textContent=""),r}parentNode(e){return e.parentNode}nextSibling(e){return e.nextSibling}setAttribute(e,t,r,i){if(i){t=i+":"+t;let s=Ru[i];s?e.setAttributeNS(s,t,r):e.setAttribute(t,r)}else e.setAttribute(t,r)}removeAttribute(e,t,r){if(r){let i=Ru[r];i?e.removeAttributeNS(i,t):e.removeAttribute(`${r}:${t}`)}else e.removeAttribute(t)}addClass(e,t){e.classList.add(t)}removeClass(e,t){e.classList.remove(t)}setStyle(e,t,r,i){i&(Mi.DashCase|Mi.Important)?e.style.setProperty(t,r,i&Mi.Important?"important":""):e.style[t]=r}removeStyle(e,t,r){r&Mi.DashCase?e.style.removeProperty(t):e.style[t]=""}setProperty(e,t,r){e!=null&&(e[t]=r)}setValue(e,t){e.nodeValue=t}listen(e,t,r,i){if(typeof e=="string"&&(e=Li().getGlobalEventTarget(this.doc,e),!e))throw new ce(5102,!1);let s=this.decoratePreventDefault(r);return this.tracingService?.wrapEventListener&&(s=this.tracingService.wrapEventListener(e,t,s)),this.eventManager.addEventListener(e,t,s,i)}decoratePreventDefault(e){return t=>{if(t==="__ngUnwrap__")return e;(this.platformIsServer?this.ngZone.runGuarded(()=>e(t)):e(t))===!1&&t.preventDefault()}}};function zg(n){return n.tagName==="TEMPLATE"&&n.content!==void 0}var Pu=class extends Fi{sharedStylesHost;hostEl;shadowRoot;constructor(e,t,r,i,s,o,c,u,h){super(e,s,o,u,h),this.sharedStylesHost=t,this.hostEl=r,this.shadowRoot=r.attachShadow({mode:"open"}),this.sharedStylesHost.addHost(this.shadowRoot);let f=i.styles;f=Wg(i.id,f);for(let _ of f){let b=document.createElement("style");c&&b.setAttribute("nonce",c),b.textContent=_,this.shadowRoot.appendChild(b)}let g=i.getExternalStyles?.();if(g)for(let _ of g){let b=Cu(_,s);c&&b.setAttribute("nonce",c),this.shadowRoot.appendChild(b)}}nodeOrShadowRoot(e){return e===this.hostEl?this.shadowRoot:e}appendChild(e,t){return super.appendChild(this.nodeOrShadowRoot(e),t)}insertBefore(e,t,r){return super.insertBefore(this.nodeOrShadowRoot(e),t,r)}removeChild(e,t){return super.removeChild(null,t)}parentNode(e){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(e)))}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}},Ui=class extends Fi{sharedStylesHost;removeStylesOnCompDestroy;styles;styleUrls;constructor(e,t,r,i,s,o,c,u,h){super(e,s,o,c,u),this.sharedStylesHost=t,this.removeStylesOnCompDestroy=i;let f=r.styles;this.styles=h?Wg(h,f):f,this.styleUrls=r.getExternalStyles?.(h)}applyStyles(){this.sharedStylesHost.addStyles(this.styles,this.styleUrls)}destroy(){this.removeStylesOnCompDestroy&&this.sharedStylesHost.removeStyles(this.styles,this.styleUrls)}},mo=class extends Ui{contentAttr;hostAttr;constructor(e,t,r,i,s,o,c,u,h){let f=i+"-"+r.id;super(e,t,r,s,o,c,u,h,f),this.contentAttr=Xw(f),this.hostAttr=Zw(f)}applyToHost(e){this.applyStyles(),this.setAttribute(e,this.hostAttr,"")}createElement(e,t){let r=super.createElement(e,t);return super.setAttribute(r,this.contentAttr,""),r}};var _o=class n extends xg{supportsDOMEvents=!0;static makeCurrent(){Og(new n)}onAndCancel(e,t,r,i){return e.addEventListener(t,r,i),()=>{e.removeEventListener(t,r,i)}}dispatchEvent(e,t){e.dispatchEvent(t)}remove(e){e.remove()}createElement(e,t){return t=t||this.getDefaultDocument(),t.createElement(e)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(e){return e.nodeType===Node.ELEMENT_NODE}isShadowRoot(e){return e instanceof DocumentFragment}getGlobalEventTarget(e,t){return t==="window"?window:t==="document"?e:t==="body"?e.body:null}getBaseHref(e){let t=eE();return t==null?null:tE(t)}resetBaseElement(){Bi=null}getUserAgent(){return window.navigator.userAgent}getCookie(e){return Fg(document.cookie,e)}},Bi=null;function eE(){return Bi=Bi||document.head.querySelector("base"),Bi?Bi.getAttribute("href"):null}function tE(n){return new URL(n,document.baseURI).pathname}var nE=(()=>{class n{build(){return new XMLHttpRequest}static \u0275fac=function(r){return new(r||n)};static \u0275prov=ee({token:n,factory:n.\u0275fac})}return n})(),Kg=(()=>{class n extends Vi{constructor(t){super(t)}supports(t){return!0}addEventListener(t,r,i,s){return t.addEventListener(r,i,s),()=>this.removeEventListener(t,r,i,s)}removeEventListener(t,r,i,s){return t.removeEventListener(r,i,s)}static \u0275fac=function(r){return new(r||n)(ie(Ge))};static \u0275prov=ee({token:n,factory:n.\u0275fac})}return n})(),Gg=["alt","control","meta","shift"],rE={"\b":"Backspace","	":"Tab","\x7F":"Delete","\x1B":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},iE={alt:n=>n.altKey,control:n=>n.ctrlKey,meta:n=>n.metaKey,shift:n=>n.shiftKey},Qg=(()=>{class n extends Vi{constructor(t){super(t)}supports(t){return n.parseEventName(t)!=null}addEventListener(t,r,i,s){let o=n.parseEventName(r),c=n.eventCallback(o.fullKey,i,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>Li().onAndCancel(t,o.domEventName,c,s))}static parseEventName(t){let r=t.toLowerCase().split("."),i=r.shift();if(r.length===0||!(i==="keydown"||i==="keyup"))return null;let s=n._normalizeKey(r.pop()),o="",c=r.indexOf("code");if(c>-1&&(r.splice(c,1),o="code."),Gg.forEach(h=>{let f=r.indexOf(h);f>-1&&(r.splice(f,1),o+=h+".")}),o+=s,r.length!=0||s.length===0)return null;let u={};return u.domEventName=i,u.fullKey=o,u}static matchEventFullKeyCode(t,r){let i=rE[t.key]||t.key,s="";return r.indexOf("code.")>-1&&(i=t.code,s="code."),i==null||!i?!1:(i=i.toLowerCase(),i===" "?i="space":i==="."&&(i="dot"),Gg.forEach(o=>{if(o!==i){let c=iE[o];c(t)&&(s+=o+".")}}),s+=i,s===r)}static eventCallback(t,r,i){return s=>{n.matchEventFullKeyCode(s,t)&&i.runGuarded(()=>r(s))}}static _normalizeKey(t){return t==="esc"?"escape":t}static \u0275fac=function(r){return new(r||n)(ie(Ge))};static \u0275prov=ee({token:n,factory:n.\u0275fac})}return n})();function sE(n,e){return Dg(L({rootComponent:n},oE(e)))}function oE(n){return{appProviders:[...hE,...n?.providers??[]],platformProviders:lE}}function aE(){_o.makeCurrent()}function cE(){return new mu}function uE(){return fg(document),document}var lE=[{provide:Ln,useValue:Ug},{provide:pg,useValue:aE,multi:!0},{provide:Ge,useFactory:uE}];var hE=[{provide:lg,useValue:"root"},{provide:mu,useFactory:cE},{provide:yo,useClass:Kg,multi:!0,deps:[Ge]},{provide:yo,useClass:Qg,multi:!0,deps:[Ge]},Ou,ku,Du,{provide:_g,useExisting:Ou},{provide:Bg,useClass:nE},[]];var Yg=(()=>{class n{_doc;constructor(t){this._doc=t}getTitle(){return this._doc.title}setTitle(t){this._doc.title=t||""}static \u0275fac=function(r){return new(r||n)(ie(Ge))};static \u0275prov=ee({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();var G="primary",Zi=Symbol("RouteTitle"),Fu=class{params;constructor(e){this.params=e||{}}has(e){return Object.prototype.hasOwnProperty.call(this.params,e)}get(e){if(this.has(e)){let t=this.params[e];return Array.isArray(t)?t[0]:t}return null}getAll(e){if(this.has(e)){let t=this.params[e];return Array.isArray(t)?t:[t]}return[]}get keys(){return Object.keys(this.params)}};function Un(n){return new Fu(n)}function im(n,e,t){let r=t.path.split("/");if(r.length>n.length||t.pathMatch==="full"&&(e.hasChildren()||r.length<n.length))return null;let i={};for(let s=0;s<r.length;s++){let o=r[s],c=n[s];if(o[0]===":")i[o.substring(1)]=c;else if(o!==c.path)return null}return{consumed:n.slice(0,r.length),posParams:i}}function fE(n,e){if(n.length!==e.length)return!1;for(let t=0;t<n.length;++t)if(!mt(n[t],e[t]))return!1;return!0}function mt(n,e){let t=n?Uu(n):void 0,r=e?Uu(e):void 0;if(!t||!r||t.length!=r.length)return!1;let i;for(let s=0;s<t.length;s++)if(i=t[s],!sm(n[i],e[i]))return!1;return!0}function Uu(n){return[...Object.keys(n),...Object.getOwnPropertySymbols(n)]}function sm(n,e){if(Array.isArray(n)&&Array.isArray(e)){if(n.length!==e.length)return!1;let t=[...n].sort(),r=[...e].sort();return t.every((i,s)=>r[s]===i)}else return n===e}function om(n){return n.length>0?n[n.length-1]:null}function dn(n){return ig(n)?n:Ag(n)?$e(Promise.resolve(n)):j(n)}var pE={exact:cm,subset:um},am={exact:gE,subset:mE,ignored:()=>!0};function Jg(n,e,t){return pE[t.paths](n.root,e.root,t.matrixParams)&&am[t.queryParams](n.queryParams,e.queryParams)&&!(t.fragment==="exact"&&n.fragment!==e.fragment)}function gE(n,e){return mt(n,e)}function cm(n,e,t){if(!Vn(n.segments,e.segments)||!wo(n.segments,e.segments,t)||n.numberOfChildren!==e.numberOfChildren)return!1;for(let r in e.children)if(!n.children[r]||!cm(n.children[r],e.children[r],t))return!1;return!0}function mE(n,e){return Object.keys(e).length<=Object.keys(n).length&&Object.keys(e).every(t=>sm(n[t],e[t]))}function um(n,e,t){return lm(n,e,e.segments,t)}function lm(n,e,t,r){if(n.segments.length>t.length){let i=n.segments.slice(0,t.length);return!(!Vn(i,t)||e.hasChildren()||!wo(i,t,r))}else if(n.segments.length===t.length){if(!Vn(n.segments,t)||!wo(n.segments,t,r))return!1;for(let i in e.children)if(!n.children[i]||!um(n.children[i],e.children[i],r))return!1;return!0}else{let i=t.slice(0,n.segments.length),s=t.slice(n.segments.length);return!Vn(n.segments,i)||!wo(n.segments,i,r)||!n.children[G]?!1:lm(n.children[G],e,s,r)}}function wo(n,e,t){return e.every((r,i)=>am[t](n[i].parameters,r.parameters))}var _t=class{root;queryParams;fragment;_queryParamMap;constructor(e=new te([],{}),t={},r=null){this.root=e,this.queryParams=t,this.fragment=r}get queryParamMap(){return this._queryParamMap??=Un(this.queryParams),this._queryParamMap}toString(){return vE.serialize(this)}},te=class{segments;children;parent=null;constructor(e,t){this.segments=e,this.children=t,Object.values(t).forEach(r=>r.parent=this)}hasChildren(){return this.numberOfChildren>0}get numberOfChildren(){return Object.keys(this.children).length}toString(){return Eo(this)}},un=class{path;parameters;_parameterMap;constructor(e,t){this.path=e,this.parameters=t}get parameterMap(){return this._parameterMap??=Un(this.parameters),this._parameterMap}toString(){return dm(this)}};function yE(n,e){return Vn(n,e)&&n.every((t,r)=>mt(t.parameters,e[r].parameters))}function Vn(n,e){return n.length!==e.length?!1:n.every((t,r)=>t.path===e[r].path)}function _E(n,e){let t=[];return Object.entries(n.children).forEach(([r,i])=>{r===G&&(t=t.concat(e(i,r)))}),Object.entries(n.children).forEach(([r,i])=>{r!==G&&(t=t.concat(e(i,r)))}),t}var Bn=(()=>{class n{static \u0275fac=function(r){return new(r||n)};static \u0275prov=ee({token:n,factory:()=>new ln,providedIn:"root"})}return n})(),ln=class{parse(e){let t=new $u(e);return new _t(t.parseRootSegment(),t.parseQueryParams(),t.parseFragment())}serialize(e){let t=`/${$i(e.root,!0)}`,r=EE(e.queryParams),i=typeof e.fragment=="string"?`#${IE(e.fragment)}`:"";return`${t}${r}${i}`}},vE=new ln;function Eo(n){return n.segments.map(e=>dm(e)).join("/")}function $i(n,e){if(!n.hasChildren())return Eo(n);if(e){let t=n.children[G]?$i(n.children[G],!1):"",r=[];return Object.entries(n.children).forEach(([i,s])=>{i!==G&&r.push(`${i}:${$i(s,!1)}`)}),r.length>0?`${t}(${r.join("//")})`:t}else{let t=_E(n,(r,i)=>i===G?[$i(n.children[G],!1)]:[`${i}:${$i(r,!1)}`]);return Object.keys(n.children).length===1&&n.children[G]!=null?`${Eo(n)}/${t[0]}`:`${Eo(n)}/(${t.join("//")})`}}function hm(n){return encodeURIComponent(n).replace(/%40/g,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")}function vo(n){return hm(n).replace(/%3B/gi,";")}function IE(n){return encodeURI(n)}function Bu(n){return hm(n).replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/%26/gi,"&")}function To(n){return decodeURIComponent(n)}function Xg(n){return To(n.replace(/\+/g,"%20"))}function dm(n){return`${Bu(n.path)}${wE(n.parameters)}`}function wE(n){return Object.entries(n).map(([e,t])=>`;${Bu(e)}=${Bu(t)}`).join("")}function EE(n){let e=Object.entries(n).map(([t,r])=>Array.isArray(r)?r.map(i=>`${vo(t)}=${vo(i)}`).join("&"):`${vo(t)}=${vo(r)}`).filter(t=>t);return e.length?`?${e.join("&")}`:""}var TE=/^[^\/()?;#]+/;function xu(n){let e=n.match(TE);return e?e[0]:""}var AE=/^[^\/()?;=#]+/;function SE(n){let e=n.match(AE);return e?e[0]:""}var bE=/^[^=?&#]+/;function RE(n){let e=n.match(bE);return e?e[0]:""}var CE=/^[^&#]+/;function PE(n){let e=n.match(CE);return e?e[0]:""}var $u=class{url;remaining;constructor(e){this.url=e,this.remaining=e}parseRootSegment(){return this.consumeOptional("/"),this.remaining===""||this.peekStartsWith("?")||this.peekStartsWith("#")?new te([],{}):new te([],this.parseChildren())}parseQueryParams(){let e={};if(this.consumeOptional("?"))do this.parseQueryParam(e);while(this.consumeOptional("&"));return e}parseFragment(){return this.consumeOptional("#")?decodeURIComponent(this.remaining):null}parseChildren(){if(this.remaining==="")return{};this.consumeOptional("/");let e=[];for(this.peekStartsWith("(")||e.push(this.parseSegment());this.peekStartsWith("/")&&!this.peekStartsWith("//")&&!this.peekStartsWith("/(");)this.capture("/"),e.push(this.parseSegment());let t={};this.peekStartsWith("/(")&&(this.capture("/"),t=this.parseParens(!0));let r={};return this.peekStartsWith("(")&&(r=this.parseParens(!1)),(e.length>0||Object.keys(t).length>0)&&(r[G]=new te(e,t)),r}parseSegment(){let e=xu(this.remaining);if(e===""&&this.peekStartsWith(";"))throw new ce(4009,!1);return this.capture(e),new un(To(e),this.parseMatrixParams())}parseMatrixParams(){let e={};for(;this.consumeOptional(";");)this.parseParam(e);return e}parseParam(e){let t=SE(this.remaining);if(!t)return;this.capture(t);let r="";if(this.consumeOptional("=")){let i=xu(this.remaining);i&&(r=i,this.capture(r))}e[To(t)]=To(r)}parseQueryParam(e){let t=RE(this.remaining);if(!t)return;this.capture(t);let r="";if(this.consumeOptional("=")){let o=PE(this.remaining);o&&(r=o,this.capture(r))}let i=Xg(t),s=Xg(r);if(e.hasOwnProperty(i)){let o=e[i];Array.isArray(o)||(o=[o],e[i]=o),o.push(s)}else e[i]=s}parseParens(e){let t={};for(this.capture("(");!this.consumeOptional(")")&&this.remaining.length>0;){let r=xu(this.remaining),i=this.remaining[r.length];if(i!=="/"&&i!==")"&&i!==";")throw new ce(4010,!1);let s;r.indexOf(":")>-1?(s=r.slice(0,r.indexOf(":")),this.capture(s),this.capture(":")):e&&(s=G);let o=this.parseChildren();t[s]=Object.keys(o).length===1?o[G]:new te([],o),this.consumeOptional("//")}return t}peekStartsWith(e){return this.remaining.startsWith(e)}consumeOptional(e){return this.peekStartsWith(e)?(this.remaining=this.remaining.substring(e.length),!0):!1}capture(e){if(!this.consumeOptional(e))throw new ce(4011,!1)}};function fm(n){return n.segments.length>0?new te([],{[G]:n}):n}function pm(n){let e={};for(let[r,i]of Object.entries(n.children)){let s=pm(i);if(r===G&&s.segments.length===0&&s.hasChildren())for(let[o,c]of Object.entries(s.children))e[o]=c;else(s.segments.length>0||s.hasChildren())&&(e[r]=s)}let t=new te(n.segments,e);return DE(t)}function DE(n){if(n.numberOfChildren===1&&n.children[G]){let e=n.children[G];return new te(n.segments.concat(e.segments),e.children)}return n}function Ar(n){return n instanceof _t}function gm(n,e,t=null,r=null){let i=mm(n);return ym(i,e,t,r)}function mm(n){let e;function t(s){let o={};for(let u of s.children){let h=t(u);o[u.outlet]=h}let c=new te(s.url,o);return s===n&&(e=c),c}let r=t(n.root),i=fm(r);return e??i}function ym(n,e,t,r){let i=n;for(;i.parent;)i=i.parent;if(e.length===0)return Mu(i,i,i,t,r);let s=kE(e);if(s.toRoot())return Mu(i,i,new te([],{}),t,r);let o=NE(s,i,n),c=o.processChildren?qi(o.segmentGroup,o.index,s.commands):vm(o.segmentGroup,o.index,s.commands);return Mu(i,o.segmentGroup,c,t,r)}function So(n){return typeof n=="object"&&n!=null&&!n.outlets&&!n.segmentPath}function Hi(n){return typeof n=="object"&&n!=null&&n.outlets}function Mu(n,e,t,r,i){let s={};r&&Object.entries(r).forEach(([u,h])=>{s[u]=Array.isArray(h)?h.map(f=>`${f}`):`${h}`});let o;n===e?o=t:o=_m(n,e,t);let c=fm(pm(o));return new _t(c,s,i)}function _m(n,e,t){let r={};return Object.entries(n.children).forEach(([i,s])=>{s===e?r[i]=t:r[i]=_m(s,e,t)}),new te(n.segments,r)}var bo=class{isAbsolute;numberOfDoubleDots;commands;constructor(e,t,r){if(this.isAbsolute=e,this.numberOfDoubleDots=t,this.commands=r,e&&r.length>0&&So(r[0]))throw new ce(4003,!1);let i=r.find(Hi);if(i&&i!==om(r))throw new ce(4004,!1)}toRoot(){return this.isAbsolute&&this.commands.length===1&&this.commands[0]=="/"}};function kE(n){if(typeof n[0]=="string"&&n.length===1&&n[0]==="/")return new bo(!0,0,n);let e=0,t=!1,r=n.reduce((i,s,o)=>{if(typeof s=="object"&&s!=null){if(s.outlets){let c={};return Object.entries(s.outlets).forEach(([u,h])=>{c[u]=typeof h=="string"?h.split("/"):h}),[...i,{outlets:c}]}if(s.segmentPath)return[...i,s.segmentPath]}return typeof s!="string"?[...i,s]:o===0?(s.split("/").forEach((c,u)=>{u==0&&c==="."||(u==0&&c===""?t=!0:c===".."?e++:c!=""&&i.push(c))}),i):[...i,s]},[]);return new bo(t,e,r)}var Er=class{segmentGroup;processChildren;index;constructor(e,t,r){this.segmentGroup=e,this.processChildren=t,this.index=r}};function NE(n,e,t){if(n.isAbsolute)return new Er(e,!0,0);if(!t)return new Er(e,!1,NaN);if(t.parent===null)return new Er(t,!0,0);let r=So(n.commands[0])?0:1,i=t.segments.length-1+r;return OE(t,i,n.numberOfDoubleDots)}function OE(n,e,t){let r=n,i=e,s=t;for(;s>i;){if(s-=i,r=r.parent,!r)throw new ce(4005,!1);i=r.segments.length}return new Er(r,!1,i-s)}function xE(n){return Hi(n[0])?n[0].outlets:{[G]:n}}function vm(n,e,t){if(n??=new te([],{}),n.segments.length===0&&n.hasChildren())return qi(n,e,t);let r=ME(n,e,t),i=t.slice(r.commandIndex);if(r.match&&r.pathIndex<n.segments.length){let s=new te(n.segments.slice(0,r.pathIndex),{});return s.children[G]=new te(n.segments.slice(r.pathIndex),n.children),qi(s,0,i)}else return r.match&&i.length===0?new te(n.segments,{}):r.match&&!n.hasChildren()?ju(n,e,t):r.match?qi(n,0,i):ju(n,e,t)}function qi(n,e,t){if(t.length===0)return new te(n.segments,{});{let r=xE(t),i={};if(Object.keys(r).some(s=>s!==G)&&n.children[G]&&n.numberOfChildren===1&&n.children[G].segments.length===0){let s=qi(n.children[G],e,t);return new te(n.segments,s.children)}return Object.entries(r).forEach(([s,o])=>{typeof o=="string"&&(o=[o]),o!==null&&(i[s]=vm(n.children[s],e,o))}),Object.entries(n.children).forEach(([s,o])=>{r[s]===void 0&&(i[s]=o)}),new te(n.segments,i)}}function ME(n,e,t){let r=0,i=e,s={match:!1,pathIndex:0,commandIndex:0};for(;i<n.segments.length;){if(r>=t.length)return s;let o=n.segments[i],c=t[r];if(Hi(c))break;let u=`${c}`,h=r<t.length-1?t[r+1]:null;if(i>0&&u===void 0)break;if(u&&h&&typeof h=="object"&&h.outlets===void 0){if(!em(u,h,o))return s;r+=2}else{if(!em(u,{},o))return s;r++}i++}return{match:!0,pathIndex:i,commandIndex:r}}function ju(n,e,t){let r=n.segments.slice(0,e),i=0;for(;i<t.length;){let s=t[i];if(Hi(s)){let u=LE(s.outlets);return new te(r,u)}if(i===0&&So(t[0])){let u=n.segments[e];r.push(new un(u.path,Zg(t[0]))),i++;continue}let o=Hi(s)?s.outlets[G]:`${s}`,c=i<t.length-1?t[i+1]:null;o&&c&&So(c)?(r.push(new un(o,Zg(c))),i+=2):(r.push(new un(o,{})),i++)}return new te(r,{})}function LE(n){let e={};return Object.entries(n).forEach(([t,r])=>{typeof r=="string"&&(r=[r]),r!==null&&(e[t]=ju(new te([],{}),0,r))}),e}function Zg(n){let e={};return Object.entries(n).forEach(([t,r])=>e[t]=`${r}`),e}function em(n,e,t){return n==t.path&&mt(e,t.parameters)}var Ao="imperative",ve=function(n){return n[n.NavigationStart=0]="NavigationStart",n[n.NavigationEnd=1]="NavigationEnd",n[n.NavigationCancel=2]="NavigationCancel",n[n.NavigationError=3]="NavigationError",n[n.RoutesRecognized=4]="RoutesRecognized",n[n.ResolveStart=5]="ResolveStart",n[n.ResolveEnd=6]="ResolveEnd",n[n.GuardsCheckStart=7]="GuardsCheckStart",n[n.GuardsCheckEnd=8]="GuardsCheckEnd",n[n.RouteConfigLoadStart=9]="RouteConfigLoadStart",n[n.RouteConfigLoadEnd=10]="RouteConfigLoadEnd",n[n.ChildActivationStart=11]="ChildActivationStart",n[n.ChildActivationEnd=12]="ChildActivationEnd",n[n.ActivationStart=13]="ActivationStart",n[n.ActivationEnd=14]="ActivationEnd",n[n.Scroll=15]="Scroll",n[n.NavigationSkipped=16]="NavigationSkipped",n}(ve||{}),Qe=class{id;url;constructor(e,t){this.id=e,this.url=t}},hn=class extends Qe{type=ve.NavigationStart;navigationTrigger;restoredState;constructor(e,t,r="imperative",i=null){super(e,t),this.navigationTrigger=r,this.restoredState=i}toString(){return`NavigationStart(id: ${this.id}, url: '${this.url}')`}},ct=class extends Qe{urlAfterRedirects;type=ve.NavigationEnd;constructor(e,t,r){super(e,t),this.urlAfterRedirects=r}toString(){return`NavigationEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}')`}},He=function(n){return n[n.Redirect=0]="Redirect",n[n.SupersededByNewNavigation=1]="SupersededByNewNavigation",n[n.NoDataFromResolver=2]="NoDataFromResolver",n[n.GuardRejected=3]="GuardRejected",n}(He||{}),Sr=function(n){return n[n.IgnoredSameUrlNavigation=0]="IgnoredSameUrlNavigation",n[n.IgnoredByUrlHandlingStrategy=1]="IgnoredByUrlHandlingStrategy",n}(Sr||{}),yt=class extends Qe{reason;code;type=ve.NavigationCancel;constructor(e,t,r,i){super(e,t),this.reason=r,this.code=i}toString(){return`NavigationCancel(id: ${this.id}, url: '${this.url}')`}},vt=class extends Qe{reason;code;type=ve.NavigationSkipped;constructor(e,t,r,i){super(e,t),this.reason=r,this.code=i}},br=class extends Qe{error;target;type=ve.NavigationError;constructor(e,t,r,i){super(e,t),this.error=r,this.target=i}toString(){return`NavigationError(id: ${this.id}, url: '${this.url}', error: ${this.error})`}},Wi=class extends Qe{urlAfterRedirects;state;type=ve.RoutesRecognized;constructor(e,t,r,i){super(e,t),this.urlAfterRedirects=r,this.state=i}toString(){return`RoutesRecognized(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},Ro=class extends Qe{urlAfterRedirects;state;type=ve.GuardsCheckStart;constructor(e,t,r,i){super(e,t),this.urlAfterRedirects=r,this.state=i}toString(){return`GuardsCheckStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},Co=class extends Qe{urlAfterRedirects;state;shouldActivate;type=ve.GuardsCheckEnd;constructor(e,t,r,i,s){super(e,t),this.urlAfterRedirects=r,this.state=i,this.shouldActivate=s}toString(){return`GuardsCheckEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state}, shouldActivate: ${this.shouldActivate})`}},Po=class extends Qe{urlAfterRedirects;state;type=ve.ResolveStart;constructor(e,t,r,i){super(e,t),this.urlAfterRedirects=r,this.state=i}toString(){return`ResolveStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},Do=class extends Qe{urlAfterRedirects;state;type=ve.ResolveEnd;constructor(e,t,r,i){super(e,t),this.urlAfterRedirects=r,this.state=i}toString(){return`ResolveEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},ko=class{route;type=ve.RouteConfigLoadStart;constructor(e){this.route=e}toString(){return`RouteConfigLoadStart(path: ${this.route.path})`}},No=class{route;type=ve.RouteConfigLoadEnd;constructor(e){this.route=e}toString(){return`RouteConfigLoadEnd(path: ${this.route.path})`}},Oo=class{snapshot;type=ve.ChildActivationStart;constructor(e){this.snapshot=e}toString(){return`ChildActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},xo=class{snapshot;type=ve.ChildActivationEnd;constructor(e){this.snapshot=e}toString(){return`ChildActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},Mo=class{snapshot;type=ve.ActivationStart;constructor(e){this.snapshot=e}toString(){return`ActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},Lo=class{snapshot;type=ve.ActivationEnd;constructor(e){this.snapshot=e}toString(){return`ActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},Rr=class{routerEvent;position;anchor;type=ve.Scroll;constructor(e,t,r){this.routerEvent=e,this.position=t,this.anchor=r}toString(){let e=this.position?`${this.position[0]}, ${this.position[1]}`:null;return`Scroll(anchor: '${this.anchor}', position: '${e}')`}},Gi=class{},Cr=class{url;navigationBehaviorOptions;constructor(e,t){this.url=e,this.navigationBehaviorOptions=t}};function VE(n,e){return n.providers&&!n._injector&&(n._injector=fo(n.providers,e,`Route: ${n.path}`)),n._injector??e}function at(n){return n.outlet||G}function FE(n,e){let t=n.filter(r=>at(r)===e);return t.push(...n.filter(r=>at(r)!==e)),t}function es(n){if(!n)return null;if(n.routeConfig?._injector)return n.routeConfig._injector;for(let e=n.parent;e;e=e.parent){let t=e.routeConfig;if(t?._loadedInjector)return t._loadedInjector;if(t?._injector)return t._injector}return null}var Vo=class{rootInjector;outlet=null;route=null;children;attachRef=null;get injector(){return es(this.route?.snapshot)??this.rootInjector}constructor(e){this.rootInjector=e,this.children=new $n(this.rootInjector)}},$n=(()=>{class n{rootInjector;contexts=new Map;constructor(t){this.rootInjector=t}onChildOutletCreated(t,r){let i=this.getOrCreateContext(t);i.outlet=r,this.contexts.set(t,i)}onChildOutletDestroyed(t){let r=this.getContext(t);r&&(r.outlet=null,r.attachRef=null)}onOutletDeactivated(){let t=this.contexts;return this.contexts=new Map,t}onOutletReAttached(t){this.contexts=t}getOrCreateContext(t){let r=this.getContext(t);return r||(r=new Vo(this.rootInjector),this.contexts.set(t,r)),r}getContext(t){return this.contexts.get(t)||null}static \u0275fac=function(r){return new(r||n)(ie(cn))};static \u0275prov=ee({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),Fo=class{_root;constructor(e){this._root=e}get root(){return this._root.value}parent(e){let t=this.pathFromRoot(e);return t.length>1?t[t.length-2]:null}children(e){let t=qu(e,this._root);return t?t.children.map(r=>r.value):[]}firstChild(e){let t=qu(e,this._root);return t&&t.children.length>0?t.children[0].value:null}siblings(e){let t=zu(e,this._root);return t.length<2?[]:t[t.length-2].children.map(i=>i.value).filter(i=>i!==e)}pathFromRoot(e){return zu(e,this._root).map(t=>t.value)}};function qu(n,e){if(n===e.value)return e;for(let t of e.children){let r=qu(n,t);if(r)return r}return null}function zu(n,e){if(n===e.value)return[e];for(let t of e.children){let r=zu(n,t);if(r.length)return r.unshift(e),r}return[]}var Ke=class{value;children;constructor(e,t){this.value=e,this.children=t}toString(){return`TreeNode(${this.value})`}};function wr(n){let e={};return n&&n.children.forEach(t=>e[t.value.outlet]=t),e}var Ki=class extends Fo{snapshot;constructor(e,t){super(e),this.snapshot=t,Xu(this,e)}toString(){return this.snapshot.toString()}};function Im(n){let e=UE(n),t=new Ne([new un("",{})]),r=new Ne({}),i=new Ne({}),s=new Ne({}),o=new Ne(""),c=new Vt(t,r,s,o,i,G,n,e.root);return c.snapshot=e.root,new Ki(new Ke(c,[]),e)}function UE(n){let e={},t={},r={},i="",s=new Fn([],e,r,i,t,G,n,null,{});return new Qi("",new Ke(s,[]))}var Vt=class{urlSubject;paramsSubject;queryParamsSubject;fragmentSubject;dataSubject;outlet;component;snapshot;_futureSnapshot;_routerState;_paramMap;_queryParamMap;title;url;params;queryParams;fragment;data;constructor(e,t,r,i,s,o,c,u){this.urlSubject=e,this.paramsSubject=t,this.queryParamsSubject=r,this.fragmentSubject=i,this.dataSubject=s,this.outlet=o,this.component=c,this._futureSnapshot=u,this.title=this.dataSubject?.pipe(Z(h=>h[Zi]))??j(void 0),this.url=e,this.params=t,this.queryParams=r,this.fragment=i,this.data=s}get routeConfig(){return this._futureSnapshot.routeConfig}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap??=this.params.pipe(Z(e=>Un(e))),this._paramMap}get queryParamMap(){return this._queryParamMap??=this.queryParams.pipe(Z(e=>Un(e))),this._queryParamMap}toString(){return this.snapshot?this.snapshot.toString():`Future(${this._futureSnapshot})`}};function Uo(n,e,t="emptyOnly"){let r,{routeConfig:i}=n;return e!==null&&(t==="always"||i?.path===""||!e.component&&!e.routeConfig?.loadComponent)?r={params:L(L({},e.params),n.params),data:L(L({},e.data),n.data),resolve:L(L(L(L({},n.data),e.data),i?.data),n._resolvedData)}:r={params:L({},n.params),data:L({},n.data),resolve:L(L({},n.data),n._resolvedData??{})},i&&Em(i)&&(r.resolve[Zi]=i.title),r}var Fn=class{url;params;queryParams;fragment;data;outlet;component;routeConfig;_resolve;_resolvedData;_routerState;_paramMap;_queryParamMap;get title(){return this.data?.[Zi]}constructor(e,t,r,i,s,o,c,u,h){this.url=e,this.params=t,this.queryParams=r,this.fragment=i,this.data=s,this.outlet=o,this.component=c,this.routeConfig=u,this._resolve=h}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap??=Un(this.params),this._paramMap}get queryParamMap(){return this._queryParamMap??=Un(this.queryParams),this._queryParamMap}toString(){let e=this.url.map(r=>r.toString()).join("/"),t=this.routeConfig?this.routeConfig.path:"";return`Route(url:'${e}', path:'${t}')`}},Qi=class extends Fo{url;constructor(e,t){super(t),this.url=e,Xu(this,t)}toString(){return wm(this._root)}};function Xu(n,e){e.value._routerState=n,e.children.forEach(t=>Xu(n,t))}function wm(n){let e=n.children.length>0?` { ${n.children.map(wm).join(", ")} } `:"";return`${n.value}${e}`}function Lu(n){if(n.snapshot){let e=n.snapshot,t=n._futureSnapshot;n.snapshot=t,mt(e.queryParams,t.queryParams)||n.queryParamsSubject.next(t.queryParams),e.fragment!==t.fragment&&n.fragmentSubject.next(t.fragment),mt(e.params,t.params)||n.paramsSubject.next(t.params),fE(e.url,t.url)||n.urlSubject.next(t.url),mt(e.data,t.data)||n.dataSubject.next(t.data)}else n.snapshot=n._futureSnapshot,n.dataSubject.next(n._futureSnapshot.data)}function Hu(n,e){let t=mt(n.params,e.params)&&yE(n.url,e.url),r=!n.parent!=!e.parent;return t&&!r&&(!n.parent||Hu(n.parent,e.parent))}function Em(n){return typeof n.title=="string"||n.title===null}var Tm=new ue(""),Zu=(()=>{class n{activated=null;get activatedComponentRef(){return this.activated}_activatedRoute=null;name=G;activateEvents=new yr;deactivateEvents=new yr;attachEvents=new yr;detachEvents=new yr;routerOutletData=dg(void 0);parentContexts=V($n);location=V(Ig);changeDetector=V(Au);inputBinder=V(ts,{optional:!0});supportsBindingToComponentInputs=!0;ngOnChanges(t){if(t.name){let{firstChange:r,previousValue:i}=t.name;if(r)return;this.isTrackedInParentContexts(i)&&(this.deactivate(),this.parentContexts.onChildOutletDestroyed(i)),this.initializeOutletWithName()}}ngOnDestroy(){this.isTrackedInParentContexts(this.name)&&this.parentContexts.onChildOutletDestroyed(this.name),this.inputBinder?.unsubscribeFromRouteData(this)}isTrackedInParentContexts(t){return this.parentContexts.getContext(t)?.outlet===this}ngOnInit(){this.initializeOutletWithName()}initializeOutletWithName(){if(this.parentContexts.onChildOutletCreated(this.name,this),this.activated)return;let t=this.parentContexts.getContext(this.name);t?.route&&(t.attachRef?this.attach(t.attachRef,t.route):this.activateWith(t.route,t.injector))}get isActivated(){return!!this.activated}get component(){if(!this.activated)throw new ce(4012,!1);return this.activated.instance}get activatedRoute(){if(!this.activated)throw new ce(4012,!1);return this._activatedRoute}get activatedRouteData(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}detach(){if(!this.activated)throw new ce(4012,!1);this.location.detach();let t=this.activated;return this.activated=null,this._activatedRoute=null,this.detachEvents.emit(t.instance),t}attach(t,r){this.activated=t,this._activatedRoute=r,this.location.insert(t.hostView),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.attachEvents.emit(t.instance)}deactivate(){if(this.activated){let t=this.component;this.activated.destroy(),this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(t)}}activateWith(t,r){if(this.isActivated)throw new ce(4013,!1);this._activatedRoute=t;let i=this.location,o=t.snapshot.component,c=this.parentContexts.getOrCreateContext(this.name).children,u=new Wu(t,c,i.injector,this.routerOutletData);this.activated=i.createComponent(o,{index:i.length,injector:u,environmentInjector:r}),this.changeDetector.markForCheck(),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.activateEvents.emit(this.activated.instance)}static \u0275fac=function(r){return new(r||n)};static \u0275dir=Iu({type:n,selectors:[["router-outlet"]],inputs:{name:"name",routerOutletData:[1,"routerOutletData"]},outputs:{activateEvents:"activate",deactivateEvents:"deactivate",attachEvents:"attach",detachEvents:"detach"},exportAs:["outlet"],features:[pu]})}return n})(),Wu=class{route;childContexts;parent;outletData;constructor(e,t,r,i){this.route=e,this.childContexts=t,this.parent=r,this.outletData=i}get(e,t){return e===Vt?this.route:e===$n?this.childContexts:e===Tm?this.outletData:this.parent.get(e,t)}},ts=new ue(""),el=(()=>{class n{outletDataSubscriptions=new Map;bindActivatedRouteToOutletComponent(t){this.unsubscribeFromRouteData(t),this.subscribeToRouteData(t)}unsubscribeFromRouteData(t){this.outletDataSubscriptions.get(t)?.unsubscribe(),this.outletDataSubscriptions.delete(t)}subscribeToRouteData(t){let{activatedRoute:r}=t,i=gr([r.queryParams,r.params,r.data]).pipe(ot(([s,o,c],u)=>(c=L(L(L({},s),o),c),u===0?j(c):Promise.resolve(c)))).subscribe(s=>{if(!t.isActivated||!t.activatedComponentRef||t.activatedRoute!==r||r.component===null){this.unsubscribeFromRouteData(t);return}let o=Ng(r.component);if(!o){this.unsubscribeFromRouteData(t);return}for(let{templateName:c}of o.inputs)t.activatedComponentRef.setInput(c,s[c])});this.outletDataSubscriptions.set(t,i)}static \u0275fac=function(r){return new(r||n)};static \u0275prov=ee({token:n,factory:n.\u0275fac})}return n})(),tl=(()=>{class n{static \u0275fac=function(r){return new(r||n)};static \u0275cmp=Eg({type:n,selectors:[["ng-component"]],exportAs:["emptyRouterOutlet"],decls:1,vars:0,template:function(r,i){r&1&&bg(0,"router-outlet")},dependencies:[Zu],encapsulation:2})}return n})();function nl(n){let e=n.children&&n.children.map(nl),t=e?be(L({},n),{children:e}):L({},n);return!t.component&&!t.loadComponent&&(e||t.loadChildren)&&t.outlet&&t.outlet!==G&&(t.component=tl),t}function BE(n,e,t){let r=Yi(n,e._root,t?t._root:void 0);return new Ki(r,e)}function Yi(n,e,t){if(t&&n.shouldReuseRoute(e.value,t.value.snapshot)){let r=t.value;r._futureSnapshot=e.value;let i=$E(n,e,t);return new Ke(r,i)}else{if(n.shouldAttach(e.value)){let s=n.retrieve(e.value);if(s!==null){let o=s.route;return o.value._futureSnapshot=e.value,o.children=e.children.map(c=>Yi(n,c)),o}}let r=jE(e.value),i=e.children.map(s=>Yi(n,s));return new Ke(r,i)}}function $E(n,e,t){return e.children.map(r=>{for(let i of t.children)if(n.shouldReuseRoute(r.value,i.value.snapshot))return Yi(n,r,i);return Yi(n,r)})}function jE(n){return new Vt(new Ne(n.url),new Ne(n.params),new Ne(n.queryParams),new Ne(n.fragment),new Ne(n.data),n.outlet,n.component,n)}var Pr=class{redirectTo;navigationBehaviorOptions;constructor(e,t){this.redirectTo=e,this.navigationBehaviorOptions=t}},Am="ngNavigationCancelingError";function Bo(n,e){let{redirectTo:t,navigationBehaviorOptions:r}=Ar(e)?{redirectTo:e,navigationBehaviorOptions:void 0}:e,i=Sm(!1,He.Redirect);return i.url=t,i.navigationBehaviorOptions=r,i}function Sm(n,e){let t=new Error(`NavigationCancelingError: ${n||""}`);return t[Am]=!0,t.cancellationCode=e,t}function qE(n){return bm(n)&&Ar(n.url)}function bm(n){return!!n&&n[Am]}var zE=(n,e,t,r)=>Z(i=>(new Gu(e,i.targetRouterState,i.currentRouterState,t,r).activate(n),i)),Gu=class{routeReuseStrategy;futureState;currState;forwardEvent;inputBindingEnabled;constructor(e,t,r,i,s){this.routeReuseStrategy=e,this.futureState=t,this.currState=r,this.forwardEvent=i,this.inputBindingEnabled=s}activate(e){let t=this.futureState._root,r=this.currState?this.currState._root:null;this.deactivateChildRoutes(t,r,e),Lu(this.futureState.root),this.activateChildRoutes(t,r,e)}deactivateChildRoutes(e,t,r){let i=wr(t);e.children.forEach(s=>{let o=s.value.outlet;this.deactivateRoutes(s,i[o],r),delete i[o]}),Object.values(i).forEach(s=>{this.deactivateRouteAndItsChildren(s,r)})}deactivateRoutes(e,t,r){let i=e.value,s=t?t.value:null;if(i===s)if(i.component){let o=r.getContext(i.outlet);o&&this.deactivateChildRoutes(e,t,o.children)}else this.deactivateChildRoutes(e,t,r);else s&&this.deactivateRouteAndItsChildren(t,r)}deactivateRouteAndItsChildren(e,t){e.value.component&&this.routeReuseStrategy.shouldDetach(e.value.snapshot)?this.detachAndStoreRouteSubtree(e,t):this.deactivateRouteAndOutlet(e,t)}detachAndStoreRouteSubtree(e,t){let r=t.getContext(e.value.outlet),i=r&&e.value.component?r.children:t,s=wr(e);for(let o of Object.values(s))this.deactivateRouteAndItsChildren(o,i);if(r&&r.outlet){let o=r.outlet.detach(),c=r.children.onOutletDeactivated();this.routeReuseStrategy.store(e.value.snapshot,{componentRef:o,route:e,contexts:c})}}deactivateRouteAndOutlet(e,t){let r=t.getContext(e.value.outlet),i=r&&e.value.component?r.children:t,s=wr(e);for(let o of Object.values(s))this.deactivateRouteAndItsChildren(o,i);r&&(r.outlet&&(r.outlet.deactivate(),r.children.onOutletDeactivated()),r.attachRef=null,r.route=null)}activateChildRoutes(e,t,r){let i=wr(t);e.children.forEach(s=>{this.activateRoutes(s,i[s.value.outlet],r),this.forwardEvent(new Lo(s.value.snapshot))}),e.children.length&&this.forwardEvent(new xo(e.value.snapshot))}activateRoutes(e,t,r){let i=e.value,s=t?t.value:null;if(Lu(i),i===s)if(i.component){let o=r.getOrCreateContext(i.outlet);this.activateChildRoutes(e,t,o.children)}else this.activateChildRoutes(e,t,r);else if(i.component){let o=r.getOrCreateContext(i.outlet);if(this.routeReuseStrategy.shouldAttach(i.snapshot)){let c=this.routeReuseStrategy.retrieve(i.snapshot);this.routeReuseStrategy.store(i.snapshot,null),o.children.onOutletReAttached(c.contexts),o.attachRef=c.componentRef,o.route=c.route.value,o.outlet&&o.outlet.attach(c.componentRef,c.route.value),Lu(c.route.value),this.activateChildRoutes(e,null,o.children)}else o.attachRef=null,o.route=i,o.outlet&&o.outlet.activateWith(i,o.injector),this.activateChildRoutes(e,null,o.children)}else this.activateChildRoutes(e,null,r)}},$o=class{path;route;constructor(e){this.path=e,this.route=this.path[this.path.length-1]}},Tr=class{component;route;constructor(e,t){this.component=e,this.route=t}};function HE(n,e,t){let r=n._root,i=e?e._root:null;return ji(r,i,t,[r.value])}function WE(n){let e=n.routeConfig?n.routeConfig.canActivateChild:null;return!e||e.length===0?null:{node:n,guards:e}}function kr(n,e){let t=Symbol(),r=e.get(n,t);return r===t?typeof n=="function"&&!ug(n)?n:e.get(n):r}function ji(n,e,t,r,i={canDeactivateChecks:[],canActivateChecks:[]}){let s=wr(e);return n.children.forEach(o=>{GE(o,s[o.value.outlet],t,r.concat([o.value]),i),delete s[o.value.outlet]}),Object.entries(s).forEach(([o,c])=>zi(c,t.getContext(o),i)),i}function GE(n,e,t,r,i={canDeactivateChecks:[],canActivateChecks:[]}){let s=n.value,o=e?e.value:null,c=t?t.getContext(n.value.outlet):null;if(o&&s.routeConfig===o.routeConfig){let u=KE(o,s,s.routeConfig.runGuardsAndResolvers);u?i.canActivateChecks.push(new $o(r)):(s.data=o.data,s._resolvedData=o._resolvedData),s.component?ji(n,e,c?c.children:null,r,i):ji(n,e,t,r,i),u&&c&&c.outlet&&c.outlet.isActivated&&i.canDeactivateChecks.push(new Tr(c.outlet.component,o))}else o&&zi(e,c,i),i.canActivateChecks.push(new $o(r)),s.component?ji(n,null,c?c.children:null,r,i):ji(n,null,t,r,i);return i}function KE(n,e,t){if(typeof t=="function")return t(n,e);switch(t){case"pathParamsChange":return!Vn(n.url,e.url);case"pathParamsOrQueryParamsChange":return!Vn(n.url,e.url)||!mt(n.queryParams,e.queryParams);case"always":return!0;case"paramsOrQueryParamsChange":return!Hu(n,e)||!mt(n.queryParams,e.queryParams);case"paramsChange":default:return!Hu(n,e)}}function zi(n,e,t){let r=wr(n),i=n.value;Object.entries(r).forEach(([s,o])=>{i.component?e?zi(o,e.children.getContext(s),t):zi(o,null,t):zi(o,e,t)}),i.component?e&&e.outlet&&e.outlet.isActivated?t.canDeactivateChecks.push(new Tr(e.outlet.component,i)):t.canDeactivateChecks.push(new Tr(null,i)):t.canDeactivateChecks.push(new Tr(null,i))}function ns(n){return typeof n=="function"}function QE(n){return typeof n=="boolean"}function YE(n){return n&&ns(n.canLoad)}function JE(n){return n&&ns(n.canActivate)}function XE(n){return n&&ns(n.canActivateChild)}function ZE(n){return n&&ns(n.canDeactivate)}function eT(n){return n&&ns(n.canMatch)}function Rm(n){return n instanceof sg||n?.name==="EmptyError"}var Io=Symbol("INITIAL_VALUE");function Dr(){return ot(n=>gr(n.map(e=>e.pipe(mr(1),hu(Io)))).pipe(Z(e=>{for(let t of e)if(t!==!0){if(t===Io)return Io;if(t===!1||tT(t))return t}return!0}),Lt(e=>e!==Io),mr(1)))}function tT(n){return Ar(n)||n instanceof Pr}function nT(n,e){return qe(t=>{let{targetSnapshot:r,currentSnapshot:i,guards:{canActivateChecks:s,canDeactivateChecks:o}}=t;return o.length===0&&s.length===0?j(be(L({},t),{guardsResult:!0})):rT(o,r,i,n).pipe(qe(c=>c&&QE(c)?iT(r,s,n,e):j(c)),Z(c=>be(L({},t),{guardsResult:c})))})}function rT(n,e,t,r){return $e(n).pipe(qe(i=>uT(i.component,i.route,t,e,r)),on(i=>i!==!0,!0))}function iT(n,e,t,r){return $e(e).pipe(Mn(i=>og(oT(i.route.parent,r),sT(i.route,r),cT(n,i.path,t),aT(n,i.route,t))),on(i=>i!==!0,!0))}function sT(n,e){return n!==null&&e&&e(new Mo(n)),j(!0)}function oT(n,e){return n!==null&&e&&e(new Oo(n)),j(!0)}function aT(n,e,t){let r=e.routeConfig?e.routeConfig.canActivate:null;if(!r||r.length===0)return j(!0);let i=r.map(s=>au(()=>{let o=es(e)??t,c=kr(s,o),u=JE(c)?c.canActivate(e,n):ze(o,()=>c(e,n));return dn(u).pipe(on())}));return j(i).pipe(Dr())}function cT(n,e,t){let r=e[e.length-1],s=e.slice(0,e.length-1).reverse().map(o=>WE(o)).filter(o=>o!==null).map(o=>au(()=>{let c=o.guards.map(u=>{let h=es(o.node)??t,f=kr(u,h),g=XE(f)?f.canActivateChild(r,n):ze(h,()=>f(r,n));return dn(g).pipe(on())});return j(c).pipe(Dr())}));return j(s).pipe(Dr())}function uT(n,e,t,r,i){let s=e&&e.routeConfig?e.routeConfig.canDeactivate:null;if(!s||s.length===0)return j(!0);let o=s.map(c=>{let u=es(e)??i,h=kr(c,u),f=ZE(h)?h.canDeactivate(n,e,t,r):ze(u,()=>h(n,e,t,r));return dn(f).pipe(on())});return j(o).pipe(Dr())}function lT(n,e,t,r){let i=e.canLoad;if(i===void 0||i.length===0)return j(!0);let s=i.map(o=>{let c=kr(o,n),u=YE(c)?c.canLoad(e,t):ze(n,()=>c(e,t));return dn(u)});return j(s).pipe(Dr(),Cm(r))}function Cm(n){return tu(Oe(e=>{if(typeof e!="boolean")throw Bo(n,e)}),Z(e=>e===!0))}function hT(n,e,t,r){let i=e.canMatch;if(!i||i.length===0)return j(!0);let s=i.map(o=>{let c=kr(o,n),u=eT(c)?c.canMatch(e,t):ze(n,()=>c(e,t));return dn(u)});return j(s).pipe(Dr(),Cm(r))}var Ji=class{segmentGroup;constructor(e){this.segmentGroup=e||null}},Xi=class extends Error{urlTree;constructor(e){super(),this.urlTree=e}};function Ir(n){return Ni(new Ji(n))}function dT(n){return Ni(new ce(4e3,!1))}function fT(n){return Ni(Sm(!1,He.GuardRejected))}var Ku=class{urlSerializer;urlTree;constructor(e,t){this.urlSerializer=e,this.urlTree=t}lineralizeSegments(e,t){let r=[],i=t.root;for(;;){if(r=r.concat(i.segments),i.numberOfChildren===0)return j(r);if(i.numberOfChildren>1||!i.children[G])return dT(`${e.redirectTo}`);i=i.children[G]}}applyRedirectCommands(e,t,r,i,s){if(typeof t!="string"){let c=t,{queryParams:u,fragment:h,routeConfig:f,url:g,outlet:_,params:b,data:P,title:O}=i,k=ze(s,()=>c({params:b,data:P,queryParams:u,fragment:h,routeConfig:f,url:g,outlet:_,title:O}));if(k instanceof _t)throw new Xi(k);t=k}let o=this.applyRedirectCreateUrlTree(t,this.urlSerializer.parse(t),e,r);if(t[0]==="/")throw new Xi(o);return o}applyRedirectCreateUrlTree(e,t,r,i){let s=this.createSegmentGroup(e,t.root,r,i);return new _t(s,this.createQueryParams(t.queryParams,this.urlTree.queryParams),t.fragment)}createQueryParams(e,t){let r={};return Object.entries(e).forEach(([i,s])=>{if(typeof s=="string"&&s[0]===":"){let c=s.substring(1);r[i]=t[c]}else r[i]=s}),r}createSegmentGroup(e,t,r,i){let s=this.createSegments(e,t.segments,r,i),o={};return Object.entries(t.children).forEach(([c,u])=>{o[c]=this.createSegmentGroup(e,u,r,i)}),new te(s,o)}createSegments(e,t,r,i){return t.map(s=>s.path[0]===":"?this.findPosParam(e,s,i):this.findOrReturn(s,r))}findPosParam(e,t,r){let i=r[t.path.substring(1)];if(!i)throw new ce(4001,!1);return i}findOrReturn(e,t){let r=0;for(let i of t){if(i.path===e.path)return t.splice(r),i;r++}return e}},Qu={matched:!1,consumedSegments:[],remainingSegments:[],parameters:{},positionalParamSegments:{}};function pT(n,e,t,r,i){let s=Pm(n,e,t);return s.matched?(r=VE(e,r),hT(r,e,t,i).pipe(Z(o=>o===!0?s:L({},Qu)))):j(s)}function Pm(n,e,t){if(e.path==="**")return gT(t);if(e.path==="")return e.pathMatch==="full"&&(n.hasChildren()||t.length>0)?L({},Qu):{matched:!0,consumedSegments:[],remainingSegments:t,parameters:{},positionalParamSegments:{}};let i=(e.matcher||im)(t,n,e);if(!i)return L({},Qu);let s={};Object.entries(i.posParams??{}).forEach(([c,u])=>{s[c]=u.path});let o=i.consumed.length>0?L(L({},s),i.consumed[i.consumed.length-1].parameters):s;return{matched:!0,consumedSegments:i.consumed,remainingSegments:t.slice(i.consumed.length),parameters:o,positionalParamSegments:i.posParams??{}}}function gT(n){return{matched:!0,parameters:n.length>0?om(n).parameters:{},consumedSegments:n,remainingSegments:[],positionalParamSegments:{}}}function tm(n,e,t,r){return t.length>0&&_T(n,t,r)?{segmentGroup:new te(e,yT(r,new te(t,n.children))),slicedSegments:[]}:t.length===0&&vT(n,t,r)?{segmentGroup:new te(n.segments,mT(n,t,r,n.children)),slicedSegments:t}:{segmentGroup:new te(n.segments,n.children),slicedSegments:t}}function mT(n,e,t,r){let i={};for(let s of t)if(qo(n,e,s)&&!r[at(s)]){let o=new te([],{});i[at(s)]=o}return L(L({},r),i)}function yT(n,e){let t={};t[G]=e;for(let r of n)if(r.path===""&&at(r)!==G){let i=new te([],{});t[at(r)]=i}return t}function _T(n,e,t){return t.some(r=>qo(n,e,r)&&at(r)!==G)}function vT(n,e,t){return t.some(r=>qo(n,e,r))}function qo(n,e,t){return(n.hasChildren()||e.length>0)&&t.pathMatch==="full"?!1:t.path===""}function IT(n,e,t){return e.length===0&&!n.children[t]}var Yu=class{};function wT(n,e,t,r,i,s,o="emptyOnly"){return new Ju(n,e,t,r,i,o,s).recognize()}var ET=31,Ju=class{injector;configLoader;rootComponentType;config;urlTree;paramsInheritanceStrategy;urlSerializer;applyRedirects;absoluteRedirectCount=0;allowRedirects=!0;constructor(e,t,r,i,s,o,c){this.injector=e,this.configLoader=t,this.rootComponentType=r,this.config=i,this.urlTree=s,this.paramsInheritanceStrategy=o,this.urlSerializer=c,this.applyRedirects=new Ku(this.urlSerializer,this.urlTree)}noMatchError(e){return new ce(4002,`'${e.segmentGroup}'`)}recognize(){let e=tm(this.urlTree.root,[],[],this.config).segmentGroup;return this.match(e).pipe(Z(({children:t,rootSnapshot:r})=>{let i=new Ke(r,t),s=new Qi("",i),o=gm(r,[],this.urlTree.queryParams,this.urlTree.fragment);return o.queryParams=this.urlTree.queryParams,s.url=this.urlSerializer.serialize(o),{state:s,tree:o}}))}match(e){let t=new Fn([],Object.freeze({}),Object.freeze(L({},this.urlTree.queryParams)),this.urlTree.fragment,Object.freeze({}),G,this.rootComponentType,null,{});return this.processSegmentGroup(this.injector,this.config,e,G,t).pipe(Z(r=>({children:r,rootSnapshot:t})),xn(r=>{if(r instanceof Xi)return this.urlTree=r.urlTree,this.match(r.urlTree.root);throw r instanceof Ji?this.noMatchError(r):r}))}processSegmentGroup(e,t,r,i,s){return r.segments.length===0&&r.hasChildren()?this.processChildren(e,t,r,s):this.processSegment(e,t,r,r.segments,i,!0,s).pipe(Z(o=>o instanceof Ke?[o]:[]))}processChildren(e,t,r,i){let s=[];for(let o of Object.keys(r.children))o==="primary"?s.unshift(o):s.push(o);return $e(s).pipe(Mn(o=>{let c=r.children[o],u=FE(t,o);return this.processSegmentGroup(e,u,c,o,i)}),lu((o,c)=>(o.push(...c),o)),cu(null),ag(),qe(o=>{if(o===null)return Ir(r);let c=Dm(o);return TT(c),j(c)}))}processSegment(e,t,r,i,s,o,c){return $e(t).pipe(Mn(u=>this.processSegmentAgainstRoute(u._injector??e,t,u,r,i,s,o,c).pipe(xn(h=>{if(h instanceof Ji)return j(null);throw h}))),on(u=>!!u),xn(u=>{if(Rm(u))return IT(r,i,s)?j(new Yu):Ir(r);throw u}))}processSegmentAgainstRoute(e,t,r,i,s,o,c,u){return at(r)!==o&&(o===G||!qo(i,s,r))?Ir(i):r.redirectTo===void 0?this.matchSegmentAgainstRoute(e,i,r,s,o,u):this.allowRedirects&&c?this.expandSegmentAgainstRouteUsingRedirect(e,i,t,r,s,o,u):Ir(i)}expandSegmentAgainstRouteUsingRedirect(e,t,r,i,s,o,c){let{matched:u,parameters:h,consumedSegments:f,positionalParamSegments:g,remainingSegments:_}=Pm(t,i,s);if(!u)return Ir(t);typeof i.redirectTo=="string"&&i.redirectTo[0]==="/"&&(this.absoluteRedirectCount++,this.absoluteRedirectCount>ET&&(this.allowRedirects=!1));let b=new Fn(s,h,Object.freeze(L({},this.urlTree.queryParams)),this.urlTree.fragment,nm(i),at(i),i.component??i._loadedComponent??null,i,rm(i)),P=Uo(b,c,this.paramsInheritanceStrategy);b.params=Object.freeze(P.params),b.data=Object.freeze(P.data);let O=this.applyRedirects.applyRedirectCommands(f,i.redirectTo,g,b,e);return this.applyRedirects.lineralizeSegments(i,O).pipe(qe(k=>this.processSegment(e,r,t,k.concat(_),o,!1,c)))}matchSegmentAgainstRoute(e,t,r,i,s,o){let c=pT(t,r,i,e,this.urlSerializer);return r.path==="**"&&(t.children={}),c.pipe(ot(u=>u.matched?(e=r._injector??e,this.getChildConfig(e,r,i).pipe(ot(({routes:h})=>{let f=r._loadedInjector??e,{parameters:g,consumedSegments:_,remainingSegments:b}=u,P=new Fn(_,g,Object.freeze(L({},this.urlTree.queryParams)),this.urlTree.fragment,nm(r),at(r),r.component??r._loadedComponent??null,r,rm(r)),O=Uo(P,o,this.paramsInheritanceStrategy);P.params=Object.freeze(O.params),P.data=Object.freeze(O.data);let{segmentGroup:k,slicedSegments:z}=tm(t,_,b,h);if(z.length===0&&k.hasChildren())return this.processChildren(f,h,k,P).pipe(Z(q=>new Ke(P,q)));if(h.length===0&&z.length===0)return j(new Ke(P,[]));let $=at(r)===s;return this.processSegment(f,h,k,z,$?G:s,!0,P).pipe(Z(q=>new Ke(P,q instanceof Ke?[q]:[])))}))):Ir(t)))}getChildConfig(e,t,r){return t.children?j({routes:t.children,injector:e}):t.loadChildren?t._loadedRoutes!==void 0?j({routes:t._loadedRoutes,injector:t._loadedInjector}):lT(e,t,r,this.urlSerializer).pipe(qe(i=>i?this.configLoader.loadChildren(e,t).pipe(Oe(s=>{t._loadedRoutes=s.routes,t._loadedInjector=s.injector})):fT(t))):j({routes:[],injector:e})}};function TT(n){n.sort((e,t)=>e.value.outlet===G?-1:t.value.outlet===G?1:e.value.outlet.localeCompare(t.value.outlet))}function AT(n){let e=n.value.routeConfig;return e&&e.path===""}function Dm(n){let e=[],t=new Set;for(let r of n){if(!AT(r)){e.push(r);continue}let i=e.find(s=>r.value.routeConfig===s.value.routeConfig);i!==void 0?(i.children.push(...r.children),t.add(i)):e.push(r)}for(let r of t){let i=Dm(r.children);e.push(new Ke(r.value,i))}return e.filter(r=>!t.has(r))}function nm(n){return n.data||{}}function rm(n){return n.resolve||{}}function ST(n,e,t,r,i,s){return qe(o=>wT(n,e,t,r,o.extractedUrl,i,s).pipe(Z(({state:c,tree:u})=>be(L({},o),{targetSnapshot:c,urlAfterRedirects:u}))))}function bT(n,e){return qe(t=>{let{targetSnapshot:r,guards:{canActivateChecks:i}}=t;if(!i.length)return j(t);let s=new Set(i.map(u=>u.route)),o=new Set;for(let u of s)if(!o.has(u))for(let h of km(u))o.add(h);let c=0;return $e(o).pipe(Mn(u=>s.has(u)?RT(u,r,n,e):(u.data=Uo(u,u.parent,n).resolve,j(void 0))),Oe(()=>c++),uu(1),qe(u=>c===o.size?j(t):Mt))})}function km(n){let e=n.children.map(t=>km(t)).flat();return[n,...e]}function RT(n,e,t,r){let i=n.routeConfig,s=n._resolve;return i?.title!==void 0&&!Em(i)&&(s[Zi]=i.title),CT(s,n,e,r).pipe(Z(o=>(n._resolvedData=o,n.data=Uo(n,n.parent,t).resolve,null)))}function CT(n,e,t,r){let i=Uu(n);if(i.length===0)return j({});let s={};return $e(i).pipe(qe(o=>PT(n[o],e,t,r).pipe(on(),Oe(c=>{if(c instanceof Pr)throw Bo(new ln,c);s[o]=c}))),uu(1),Z(()=>s),xn(o=>Rm(o)?Mt:Ni(o)))}function PT(n,e,t,r){let i=es(e)??r,s=kr(n,i),o=s.resolve?s.resolve(e,t):ze(i,()=>s(e,t));return dn(o)}function Vu(n){return ot(e=>{let t=n(e);return t?$e(t).pipe(Z(()=>e)):j(e)})}var rl=(()=>{class n{buildTitle(t){let r,i=t.root;for(;i!==void 0;)r=this.getResolvedTitleForRoute(i)??r,i=i.children.find(s=>s.outlet===G);return r}getResolvedTitleForRoute(t){return t.data[Zi]}static \u0275fac=function(r){return new(r||n)};static \u0275prov=ee({token:n,factory:()=>V(Nm),providedIn:"root"})}return n})(),Nm=(()=>{class n extends rl{title;constructor(t){super(),this.title=t}updateTitle(t){let r=this.buildTitle(t);r!==void 0&&this.title.setTitle(r)}static \u0275fac=function(r){return new(r||n)(ie(Yg))};static \u0275prov=ee({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),jn=new ue("",{providedIn:"root",factory:()=>({})}),qn=new ue(""),zo=(()=>{class n{componentLoaders=new WeakMap;childrenLoaders=new WeakMap;onLoadStartListener;onLoadEndListener;compiler=V(Pg);loadComponent(t){if(this.componentLoaders.get(t))return this.componentLoaders.get(t);if(t._loadedComponent)return j(t._loadedComponent);this.onLoadStartListener&&this.onLoadStartListener(t);let r=dn(t.loadComponent()).pipe(Z(xm),Oe(s=>{this.onLoadEndListener&&this.onLoadEndListener(t),t._loadedComponent=s}),uo(()=>{this.componentLoaders.delete(t)})),i=new ru(r,()=>new sn).pipe(nu());return this.componentLoaders.set(t,i),i}loadChildren(t,r){if(this.childrenLoaders.get(r))return this.childrenLoaders.get(r);if(r._loadedRoutes)return j({routes:r._loadedRoutes,injector:r._loadedInjector});this.onLoadStartListener&&this.onLoadStartListener(r);let s=Om(r,this.compiler,t,this.onLoadEndListener).pipe(uo(()=>{this.childrenLoaders.delete(r)})),o=new ru(s,()=>new sn).pipe(nu());return this.childrenLoaders.set(r,o),o}static \u0275fac=function(r){return new(r||n)};static \u0275prov=ee({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function Om(n,e,t,r){return dn(n.loadChildren()).pipe(Z(xm),qe(i=>i instanceof wg||Array.isArray(i)?j(i):$e(e.compileModuleAsync(i))),Z(i=>{r&&r(n);let s,o,c=!1;return Array.isArray(i)?(o=i,c=!0):(s=i.create(t).injector,o=s.get(qn,[],{optional:!0,self:!0}).flat()),{routes:o.map(nl),injector:s}}))}function DT(n){return n&&typeof n=="object"&&"default"in n}function xm(n){return DT(n)?n.default:n}var Ho=(()=>{class n{static \u0275fac=function(r){return new(r||n)};static \u0275prov=ee({token:n,factory:()=>V(kT),providedIn:"root"})}return n})(),kT=(()=>{class n{shouldProcessUrl(t){return!0}extract(t){return t}merge(t,r){return t}static \u0275fac=function(r){return new(r||n)};static \u0275prov=ee({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),il=new ue(""),sl=new ue("");function Mm(n,e,t){let r=n.get(sl),i=n.get(Ge);return n.get(Ie).runOutsideAngular(()=>{if(!i.startViewTransition||r.skipNextTransition)return r.skipNextTransition=!1,new Promise(h=>setTimeout(h));let s,o=new Promise(h=>{s=h}),c=i.startViewTransition(()=>(s(),NT(n))),{onViewTransitionCreated:u}=r;return u&&ze(n,()=>u({transition:c,from:e,to:t})),o})}function NT(n){return new Promise(e=>{yg({read:()=>setTimeout(e)},{injector:n})})}var ol=new ue(""),Wo=(()=>{class n{currentNavigation=null;currentTransition=null;lastSuccessfulNavigation=null;events=new sn;transitionAbortSubject=new sn;configLoader=V(zo);environmentInjector=V(cn);destroyRef=V(Oi);urlSerializer=V(Bn);rootContexts=V($n);location=V(_r);inputBindingEnabled=V(ts,{optional:!0})!==null;titleStrategy=V(rl);options=V(jn,{optional:!0})||{};paramsInheritanceStrategy=this.options.paramsInheritanceStrategy||"emptyOnly";urlHandlingStrategy=V(Ho);createViewTransition=V(il,{optional:!0});navigationErrorHandler=V(ol,{optional:!0});navigationId=0;get hasRequestedNavigation(){return this.navigationId!==0}transitions;afterPreactivation=()=>j(void 0);rootComponentType=null;destroyed=!1;constructor(){let t=i=>this.events.next(new ko(i)),r=i=>this.events.next(new No(i));this.configLoader.onLoadEndListener=r,this.configLoader.onLoadStartListener=t,this.destroyRef.onDestroy(()=>{this.destroyed=!0})}complete(){this.transitions?.complete()}handleNavigationRequest(t){let r=++this.navigationId;this.transitions?.next(be(L({},t),{extractedUrl:this.urlHandlingStrategy.extract(t.rawUrl),targetSnapshot:null,targetRouterState:null,guards:{canActivateChecks:[],canDeactivateChecks:[]},guardsResult:null,id:r}))}setupNavigations(t){return this.transitions=new Ne(null),this.transitions.pipe(Lt(r=>r!==null),ot(r=>{let i=!1,s=!1;return j(r).pipe(ot(o=>{if(this.navigationId>r.id)return this.cancelNavigationTransition(r,"",He.SupersededByNewNavigation),Mt;this.currentTransition=r,this.currentNavigation={id:o.id,initialUrl:o.rawUrl,extractedUrl:o.extractedUrl,targetBrowserUrl:typeof o.extras.browserUrl=="string"?this.urlSerializer.parse(o.extras.browserUrl):o.extras.browserUrl,trigger:o.source,extras:o.extras,previousNavigation:this.lastSuccessfulNavigation?be(L({},this.lastSuccessfulNavigation),{previousNavigation:null}):null};let c=!t.navigated||this.isUpdatingInternalState()||this.isUpdatedBrowserUrl(),u=o.extras.onSameUrlNavigation??t.onSameUrlNavigation;if(!c&&u!=="reload"){let h="";return this.events.next(new vt(o.id,this.urlSerializer.serialize(o.rawUrl),h,Sr.IgnoredSameUrlNavigation)),o.resolve(!1),Mt}if(this.urlHandlingStrategy.shouldProcessUrl(o.rawUrl))return j(o).pipe(ot(h=>(this.events.next(new hn(h.id,this.urlSerializer.serialize(h.extractedUrl),h.source,h.restoredState)),h.id!==this.navigationId?Mt:Promise.resolve(h))),ST(this.environmentInjector,this.configLoader,this.rootComponentType,t.config,this.urlSerializer,this.paramsInheritanceStrategy),Oe(h=>{r.targetSnapshot=h.targetSnapshot,r.urlAfterRedirects=h.urlAfterRedirects,this.currentNavigation=be(L({},this.currentNavigation),{finalUrl:h.urlAfterRedirects});let f=new Wi(h.id,this.urlSerializer.serialize(h.extractedUrl),this.urlSerializer.serialize(h.urlAfterRedirects),h.targetSnapshot);this.events.next(f)}));if(c&&this.urlHandlingStrategy.shouldProcessUrl(o.currentRawUrl)){let{id:h,extractedUrl:f,source:g,restoredState:_,extras:b}=o,P=new hn(h,this.urlSerializer.serialize(f),g,_);this.events.next(P);let O=Im(this.rootComponentType).snapshot;return this.currentTransition=r=be(L({},o),{targetSnapshot:O,urlAfterRedirects:f,extras:be(L({},b),{skipLocationChange:!1,replaceUrl:!1})}),this.currentNavigation.finalUrl=f,j(r)}else{let h="";return this.events.next(new vt(o.id,this.urlSerializer.serialize(o.extractedUrl),h,Sr.IgnoredByUrlHandlingStrategy)),o.resolve(!1),Mt}}),Oe(o=>{let c=new Ro(o.id,this.urlSerializer.serialize(o.extractedUrl),this.urlSerializer.serialize(o.urlAfterRedirects),o.targetSnapshot);this.events.next(c)}),Z(o=>(this.currentTransition=r=be(L({},o),{guards:HE(o.targetSnapshot,o.currentSnapshot,this.rootContexts)}),r)),nT(this.environmentInjector,o=>this.events.next(o)),Oe(o=>{if(r.guardsResult=o.guardsResult,o.guardsResult&&typeof o.guardsResult!="boolean")throw Bo(this.urlSerializer,o.guardsResult);let c=new Co(o.id,this.urlSerializer.serialize(o.extractedUrl),this.urlSerializer.serialize(o.urlAfterRedirects),o.targetSnapshot,!!o.guardsResult);this.events.next(c)}),Lt(o=>o.guardsResult?!0:(this.cancelNavigationTransition(o,"",He.GuardRejected),!1)),Vu(o=>{if(o.guards.canActivateChecks.length!==0)return j(o).pipe(Oe(c=>{let u=new Po(c.id,this.urlSerializer.serialize(c.extractedUrl),this.urlSerializer.serialize(c.urlAfterRedirects),c.targetSnapshot);this.events.next(u)}),ot(c=>{let u=!1;return j(c).pipe(bT(this.paramsInheritanceStrategy,this.environmentInjector),Oe({next:()=>u=!0,complete:()=>{u||this.cancelNavigationTransition(c,"",He.NoDataFromResolver)}}))}),Oe(c=>{let u=new Do(c.id,this.urlSerializer.serialize(c.extractedUrl),this.urlSerializer.serialize(c.urlAfterRedirects),c.targetSnapshot);this.events.next(u)}))}),Vu(o=>{let c=u=>{let h=[];u.routeConfig?.loadComponent&&!u.routeConfig._loadedComponent&&h.push(this.configLoader.loadComponent(u.routeConfig).pipe(Oe(f=>{u.component=f}),Z(()=>{})));for(let f of u.children)h.push(...c(f));return h};return gr(c(o.targetSnapshot.root)).pipe(cu(null),mr(1))}),Vu(()=>this.afterPreactivation()),ot(()=>{let{currentSnapshot:o,targetSnapshot:c}=r,u=this.createViewTransition?.(this.environmentInjector,o.root,c.root);return u?$e(u).pipe(Z(()=>r)):j(r)}),Z(o=>{let c=BE(t.routeReuseStrategy,o.targetSnapshot,o.currentRouterState);return this.currentTransition=r=be(L({},o),{targetRouterState:c}),this.currentNavigation.targetRouterState=c,r}),Oe(()=>{this.events.next(new Gi)}),zE(this.rootContexts,t.routeReuseStrategy,o=>this.events.next(o),this.inputBindingEnabled),mr(1),Oe({next:o=>{i=!0,this.lastSuccessfulNavigation=this.currentNavigation,this.events.next(new ct(o.id,this.urlSerializer.serialize(o.extractedUrl),this.urlSerializer.serialize(o.urlAfterRedirects))),this.titleStrategy?.updateTitle(o.targetRouterState.snapshot),o.resolve(!0)},complete:()=>{i=!0}}),cg(this.transitionAbortSubject.pipe(Oe(o=>{throw o}))),uo(()=>{!i&&!s&&this.cancelNavigationTransition(r,"",He.SupersededByNewNavigation),this.currentTransition?.id===r.id&&(this.currentNavigation=null,this.currentTransition=null)}),xn(o=>{if(this.destroyed)return r.resolve(!1),Mt;if(s=!0,bm(o))this.events.next(new yt(r.id,this.urlSerializer.serialize(r.extractedUrl),o.message,o.cancellationCode)),qE(o)?this.events.next(new Cr(o.url,o.navigationBehaviorOptions)):r.resolve(!1);else{let c=new br(r.id,this.urlSerializer.serialize(r.extractedUrl),o,r.targetSnapshot??void 0);try{let u=ze(this.environmentInjector,()=>this.navigationErrorHandler?.(c));if(u instanceof Pr){let{message:h,cancellationCode:f}=Bo(this.urlSerializer,u);this.events.next(new yt(r.id,this.urlSerializer.serialize(r.extractedUrl),h,f)),this.events.next(new Cr(u.redirectTo,u.navigationBehaviorOptions))}else throw this.events.next(c),o}catch(u){this.options.resolveNavigationPromiseOnError?r.resolve(!1):r.reject(u)}}return Mt}))}))}cancelNavigationTransition(t,r,i){let s=new yt(t.id,this.urlSerializer.serialize(t.extractedUrl),r,i);this.events.next(s),t.resolve(!1)}isUpdatingInternalState(){return this.currentTransition?.extractedUrl.toString()!==this.currentTransition?.currentUrlTree.toString()}isUpdatedBrowserUrl(){let t=this.urlHandlingStrategy.extract(this.urlSerializer.parse(this.location.path(!0))),r=this.currentNavigation?.targetBrowserUrl??this.currentNavigation?.extractedUrl;return t.toString()!==r?.toString()&&!this.currentNavigation?.extras.skipLocationChange}static \u0275fac=function(r){return new(r||n)};static \u0275prov=ee({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function OT(n){return n!==Ao}var Lm=(()=>{class n{static \u0275fac=function(r){return new(r||n)};static \u0275prov=ee({token:n,factory:()=>V(xT),providedIn:"root"})}return n})(),jo=class{shouldDetach(e){return!1}store(e,t){}shouldAttach(e){return!1}retrieve(e){return null}shouldReuseRoute(e,t){return e.routeConfig===t.routeConfig}},xT=(()=>{class n extends jo{static \u0275fac=(()=>{let t;return function(i){return(t||(t=gu(n)))(i||n)}})();static \u0275prov=ee({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),Vm=(()=>{class n{urlSerializer=V(Bn);options=V(jn,{optional:!0})||{};canceledNavigationResolution=this.options.canceledNavigationResolution||"replace";location=V(_r);urlHandlingStrategy=V(Ho);urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred";currentUrlTree=new _t;getCurrentUrlTree(){return this.currentUrlTree}rawUrlTree=this.currentUrlTree;getRawUrlTree(){return this.rawUrlTree}createBrowserPath({finalUrl:t,initialUrl:r,targetBrowserUrl:i}){let s=t!==void 0?this.urlHandlingStrategy.merge(t,r):r,o=i??s;return o instanceof _t?this.urlSerializer.serialize(o):o}commitTransition({targetRouterState:t,finalUrl:r,initialUrl:i}){r&&t?(this.currentUrlTree=r,this.rawUrlTree=this.urlHandlingStrategy.merge(r,i),this.routerState=t):this.rawUrlTree=i}routerState=Im(null);getRouterState(){return this.routerState}stateMemento=this.createStateMemento();updateStateMemento(){this.stateMemento=this.createStateMemento()}createStateMemento(){return{rawUrlTree:this.rawUrlTree,currentUrlTree:this.currentUrlTree,routerState:this.routerState}}resetInternalState({finalUrl:t}){this.routerState=this.stateMemento.routerState,this.currentUrlTree=this.stateMemento.currentUrlTree,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,t??this.rawUrlTree)}static \u0275fac=function(r){return new(r||n)};static \u0275prov=ee({token:n,factory:()=>V(MT),providedIn:"root"})}return n})(),MT=(()=>{class n extends Vm{currentPageId=0;lastSuccessfulId=-1;restoredState(){return this.location.getState()}get browserPageId(){return this.canceledNavigationResolution!=="computed"?this.currentPageId:this.restoredState()?.\u0275routerPageId??this.currentPageId}registerNonRouterCurrentEntryChangeListener(t){return this.location.subscribe(r=>{r.type==="popstate"&&setTimeout(()=>{t(r.url,r.state,"popstate")})})}handleRouterEvent(t,r){t instanceof hn?this.updateStateMemento():t instanceof vt?this.commitTransition(r):t instanceof Wi?this.urlUpdateStrategy==="eager"&&(r.extras.skipLocationChange||this.setBrowserUrl(this.createBrowserPath(r),r)):t instanceof Gi?(this.commitTransition(r),this.urlUpdateStrategy==="deferred"&&!r.extras.skipLocationChange&&this.setBrowserUrl(this.createBrowserPath(r),r)):t instanceof yt&&(t.code===He.GuardRejected||t.code===He.NoDataFromResolver)?this.restoreHistory(r):t instanceof br?this.restoreHistory(r,!0):t instanceof ct&&(this.lastSuccessfulId=t.id,this.currentPageId=this.browserPageId)}setBrowserUrl(t,{extras:r,id:i}){let{replaceUrl:s,state:o}=r;if(this.location.isCurrentPathEqualTo(t)||s){let c=this.browserPageId,u=L(L({},o),this.generateNgRouterState(i,c));this.location.replaceState(t,"",u)}else{let c=L(L({},o),this.generateNgRouterState(i,this.browserPageId+1));this.location.go(t,"",c)}}restoreHistory(t,r=!1){if(this.canceledNavigationResolution==="computed"){let i=this.browserPageId,s=this.currentPageId-i;s!==0?this.location.historyGo(s):this.getCurrentUrlTree()===t.finalUrl&&s===0&&(this.resetInternalState(t),this.resetUrlToCurrentUrlTree())}else this.canceledNavigationResolution==="replace"&&(r&&this.resetInternalState(t),this.resetUrlToCurrentUrlTree())}resetUrlToCurrentUrlTree(){this.location.replaceState(this.urlSerializer.serialize(this.getRawUrlTree()),"",this.generateNgRouterState(this.lastSuccessfulId,this.currentPageId))}generateNgRouterState(t,r){return this.canceledNavigationResolution==="computed"?{navigationId:t,\u0275routerPageId:r}:{navigationId:t}}static \u0275fac=(()=>{let t;return function(i){return(t||(t=gu(n)))(i||n)}})();static \u0275prov=ee({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function Go(n,e){n.events.pipe(Lt(t=>t instanceof ct||t instanceof yt||t instanceof br||t instanceof vt),Z(t=>t instanceof ct||t instanceof vt?0:(t instanceof yt?t.code===He.Redirect||t.code===He.SupersededByNewNavigation:!1)?2:1),Lt(t=>t!==2),mr(1)).subscribe(()=>{e()})}var LT={paths:"exact",fragment:"ignored",matrixParams:"ignored",queryParams:"exact"},VT={paths:"subset",fragment:"ignored",matrixParams:"ignored",queryParams:"subset"},Ft=(()=>{class n{get currentUrlTree(){return this.stateManager.getCurrentUrlTree()}get rawUrlTree(){return this.stateManager.getRawUrlTree()}disposed=!1;nonRouterCurrentEntryChangeSubscription;console=V(Tg);stateManager=V(Vm);options=V(jn,{optional:!0})||{};pendingTasks=V(hg);urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred";navigationTransitions=V(Wo);urlSerializer=V(Bn);location=V(_r);urlHandlingStrategy=V(Ho);_events=new sn;get events(){return this._events}get routerState(){return this.stateManager.getRouterState()}navigated=!1;routeReuseStrategy=V(Lm);onSameUrlNavigation=this.options.onSameUrlNavigation||"ignore";config=V(qn,{optional:!0})?.flat()??[];componentInputBindingEnabled=!!V(ts,{optional:!0});constructor(){this.resetConfig(this.config),this.navigationTransitions.setupNavigations(this).subscribe({error:t=>{this.console.warn(t)}}),this.subscribeToNavigationEvents()}eventsSubscription=new tg;subscribeToNavigationEvents(){let t=this.navigationTransitions.events.subscribe(r=>{try{let i=this.navigationTransitions.currentTransition,s=this.navigationTransitions.currentNavigation;if(i!==null&&s!==null){if(this.stateManager.handleRouterEvent(r,s),r instanceof yt&&r.code!==He.Redirect&&r.code!==He.SupersededByNewNavigation)this.navigated=!0;else if(r instanceof ct)this.navigated=!0;else if(r instanceof Cr){let o=r.navigationBehaviorOptions,c=this.urlHandlingStrategy.merge(r.url,i.currentRawUrl),u=L({browserUrl:i.extras.browserUrl,info:i.extras.info,skipLocationChange:i.extras.skipLocationChange,replaceUrl:i.extras.replaceUrl||this.urlUpdateStrategy==="eager"||OT(i.source)},o);this.scheduleNavigation(c,Ao,null,u,{resolve:i.resolve,reject:i.reject,promise:i.promise})}}UT(r)&&this._events.next(r)}catch(i){this.navigationTransitions.transitionAbortSubject.next(i)}});this.eventsSubscription.add(t)}resetRootComponentType(t){this.routerState.root.component=t,this.navigationTransitions.rootComponentType=t}initialNavigation(){this.setUpLocationChangeListener(),this.navigationTransitions.hasRequestedNavigation||this.navigateToSyncWithBrowser(this.location.path(!0),Ao,this.stateManager.restoredState())}setUpLocationChangeListener(){this.nonRouterCurrentEntryChangeSubscription??=this.stateManager.registerNonRouterCurrentEntryChangeListener((t,r,i)=>{this.navigateToSyncWithBrowser(t,i,r)})}navigateToSyncWithBrowser(t,r,i){let s={replaceUrl:!0},o=i?.navigationId?i:null;if(i){let u=L({},i);delete u.navigationId,delete u.\u0275routerPageId,Object.keys(u).length!==0&&(s.state=u)}let c=this.parseUrl(t);this.scheduleNavigation(c,r,o,s)}get url(){return this.serializeUrl(this.currentUrlTree)}getCurrentNavigation(){return this.navigationTransitions.currentNavigation}get lastSuccessfulNavigation(){return this.navigationTransitions.lastSuccessfulNavigation}resetConfig(t){this.config=t.map(nl),this.navigated=!1}ngOnDestroy(){this.dispose()}dispose(){this._events.unsubscribe(),this.navigationTransitions.complete(),this.nonRouterCurrentEntryChangeSubscription&&(this.nonRouterCurrentEntryChangeSubscription.unsubscribe(),this.nonRouterCurrentEntryChangeSubscription=void 0),this.disposed=!0,this.eventsSubscription.unsubscribe()}createUrlTree(t,r={}){let{relativeTo:i,queryParams:s,fragment:o,queryParamsHandling:c,preserveFragment:u}=r,h=u?this.currentUrlTree.fragment:o,f=null;switch(c??this.options.defaultQueryParamsHandling){case"merge":f=L(L({},this.currentUrlTree.queryParams),s);break;case"preserve":f=this.currentUrlTree.queryParams;break;default:f=s||null}f!==null&&(f=this.removeEmptyProps(f));let g;try{let _=i?i.snapshot:this.routerState.snapshot.root;g=mm(_)}catch{(typeof t[0]!="string"||t[0][0]!=="/")&&(t=[]),g=this.currentUrlTree.root}return ym(g,t,f,h??null)}navigateByUrl(t,r={skipLocationChange:!1}){let i=Ar(t)?t:this.parseUrl(t),s=this.urlHandlingStrategy.merge(i,this.rawUrlTree);return this.scheduleNavigation(s,Ao,null,r)}navigate(t,r={skipLocationChange:!1}){return FT(t),this.navigateByUrl(this.createUrlTree(t,r),r)}serializeUrl(t){return this.urlSerializer.serialize(t)}parseUrl(t){try{return this.urlSerializer.parse(t)}catch{return this.urlSerializer.parse("/")}}isActive(t,r){let i;if(r===!0?i=L({},LT):r===!1?i=L({},VT):i=r,Ar(t))return Jg(this.currentUrlTree,t,i);let s=this.parseUrl(t);return Jg(this.currentUrlTree,s,i)}removeEmptyProps(t){return Object.entries(t).reduce((r,[i,s])=>(s!=null&&(r[i]=s),r),{})}scheduleNavigation(t,r,i,s,o){if(this.disposed)return Promise.resolve(!1);let c,u,h;o?(c=o.resolve,u=o.reject,h=o.promise):h=new Promise((g,_)=>{c=g,u=_});let f=this.pendingTasks.add();return Go(this,()=>{queueMicrotask(()=>this.pendingTasks.remove(f))}),this.navigationTransitions.handleNavigationRequest({source:r,restoredState:i,currentUrlTree:this.currentUrlTree,currentRawUrl:this.currentUrlTree,rawUrl:t,extras:s,resolve:c,reject:u,promise:h,currentSnapshot:this.routerState.snapshot,currentRouterState:this.routerState}),h.catch(g=>Promise.reject(g))}static \u0275fac=function(r){return new(r||n)};static \u0275prov=ee({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function FT(n){for(let e=0;e<n.length;e++)if(n[e]==null)throw new ce(4008,!1)}function UT(n){return!(n instanceof Gi)&&!(n instanceof Cr)}var rs=class{};var Fm=(()=>{class n{router;injector;preloadingStrategy;loader;subscription;constructor(t,r,i,s){this.router=t,this.injector=r,this.preloadingStrategy=i,this.loader=s}setUpPreloading(){this.subscription=this.router.events.pipe(Lt(t=>t instanceof ct),Mn(()=>this.preload())).subscribe(()=>{})}preload(){return this.processRoutes(this.injector,this.router.config)}ngOnDestroy(){this.subscription&&this.subscription.unsubscribe()}processRoutes(t,r){let i=[];for(let s of r){s.providers&&!s._injector&&(s._injector=fo(s.providers,t,`Route: ${s.path}`));let o=s._injector??t,c=s._loadedInjector??o;(s.loadChildren&&!s._loadedRoutes&&s.canLoad===void 0||s.loadComponent&&!s._loadedComponent)&&i.push(this.preloadConfig(o,s)),(s.children||s._loadedRoutes)&&i.push(this.processRoutes(c,s.children??s._loadedRoutes))}return $e(i).pipe(ou())}preloadConfig(t,r){return this.preloadingStrategy.preload(r,()=>{let i;r.loadChildren&&r.canLoad===void 0?i=this.loader.loadChildren(t,r):i=j(null);let s=i.pipe(qe(o=>o===null?j(void 0):(r._loadedRoutes=o.routes,r._loadedInjector=o.injector,this.processRoutes(o.injector??t,o.routes))));if(r.loadComponent&&!r._loadedComponent){let o=this.loader.loadComponent(r);return $e([s,o]).pipe(ou())}else return s})}static \u0275fac=function(r){return new(r||n)(ie(Ft),ie(cn),ie(rs),ie(zo))};static \u0275prov=ee({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),Um=new ue(""),BT=(()=>{class n{urlSerializer;transitions;viewportScroller;zone;options;routerEventsSubscription;scrollEventsSubscription;lastId=0;lastSource="imperative";restoredId=0;store={};constructor(t,r,i,s,o={}){this.urlSerializer=t,this.transitions=r,this.viewportScroller=i,this.zone=s,this.options=o,o.scrollPositionRestoration||="disabled",o.anchorScrolling||="disabled"}init(){this.options.scrollPositionRestoration!=="disabled"&&this.viewportScroller.setHistoryScrollRestoration("manual"),this.routerEventsSubscription=this.createScrollEvents(),this.scrollEventsSubscription=this.consumeScrollEvents()}createScrollEvents(){return this.transitions.events.subscribe(t=>{t instanceof hn?(this.store[this.lastId]=this.viewportScroller.getScrollPosition(),this.lastSource=t.navigationTrigger,this.restoredId=t.restoredState?t.restoredState.navigationId:0):t instanceof ct?(this.lastId=t.id,this.scheduleScrollEvent(t,this.urlSerializer.parse(t.urlAfterRedirects).fragment)):t instanceof vt&&t.code===Sr.IgnoredSameUrlNavigation&&(this.lastSource=void 0,this.restoredId=0,this.scheduleScrollEvent(t,this.urlSerializer.parse(t.url).fragment))})}consumeScrollEvents(){return this.transitions.events.subscribe(t=>{t instanceof Rr&&(t.position?this.options.scrollPositionRestoration==="top"?this.viewportScroller.scrollToPosition([0,0]):this.options.scrollPositionRestoration==="enabled"&&this.viewportScroller.scrollToPosition(t.position):t.anchor&&this.options.anchorScrolling==="enabled"?this.viewportScroller.scrollToAnchor(t.anchor):this.options.scrollPositionRestoration!=="disabled"&&this.viewportScroller.scrollToPosition([0,0]))})}scheduleScrollEvent(t,r){this.zone.runOutsideAngular(()=>{setTimeout(()=>{this.zone.run(()=>{this.transitions.events.next(new Rr(t,this.lastSource==="popstate"?this.store[this.restoredId]:null,r))})},0)})}ngOnDestroy(){this.routerEventsSubscription?.unsubscribe(),this.scrollEventsSubscription?.unsubscribe()}static \u0275fac=function(r){vg()};static \u0275prov=ee({token:n,factory:n.\u0275fac})}return n})();function $T(n,...e){return an([{provide:qn,multi:!0,useValue:n},[],{provide:Vt,useFactory:Bm,deps:[Ft]},{provide:Eu,multi:!0,useFactory:$m},e.map(t=>t.\u0275providers)])}function Bm(n){return n.routerState.root}function is(n,e){return{\u0275kind:n,\u0275providers:e}}function $m(){let n=V(et);return e=>{let t=n.get(Sg);if(e!==t.components[0])return;let r=n.get(Ft),i=n.get(jm);n.get(cl)===1&&r.initialNavigation(),n.get(Hm,null,du.Optional)?.setUpPreloading(),n.get(Um,null,du.Optional)?.init(),r.resetRootComponentType(t.componentTypes[0]),i.closed||(i.next(),i.complete(),i.unsubscribe())}}var jm=new ue("",{factory:()=>new sn}),cl=new ue("",{providedIn:"root",factory:()=>1});function qm(){let n=[{provide:cl,useValue:0},wu(()=>{let e=V(et);return e.get(Mg,Promise.resolve()).then(()=>new Promise(r=>{let i=e.get(Ft),s=e.get(jm);Go(i,()=>{r(!0)}),e.get(Wo).afterPreactivation=()=>(r(!0),s.closed?j(void 0):s),i.initialNavigation()}))})];return is(2,n)}function zm(){let n=[wu(()=>{V(Ft).setUpLocationChangeListener()}),{provide:cl,useValue:2}];return is(3,n)}var Hm=new ue("");function Wm(n){return is(0,[{provide:Hm,useExisting:Fm},{provide:rs,useExisting:n}])}function Gm(){return is(8,[el,{provide:ts,useExisting:el}])}function Km(n){mg("NgRouterViewTransitions");let e=[{provide:il,useValue:Mm},{provide:sl,useValue:L({skipNextTransition:!!n?.skipInitialTransition},n)}];return is(9,e)}var Qm=[_r,{provide:Bn,useClass:ln},Ft,$n,{provide:Vt,useFactory:Bm,deps:[Ft]},zo,[]],jT=(()=>{class n{constructor(){}static forRoot(t,r){return{ngModule:n,providers:[Qm,[],{provide:qn,multi:!0,useValue:t},[],r?.errorHandler?{provide:ol,useValue:r.errorHandler}:[],{provide:jn,useValue:r||{}},r?.useHash?zT():HT(),qT(),r?.preloadingStrategy?Wm(r.preloadingStrategy).\u0275providers:[],r?.initialNavigation?WT(r):[],r?.bindToComponentInputs?Gm().\u0275providers:[],r?.enableViewTransitions?Km().\u0275providers:[],GT()]}}static forChild(t){return{ngModule:n,providers:[{provide:qn,multi:!0,useValue:t}]}}static \u0275fac=function(r){return new(r||n)};static \u0275mod=po({type:n});static \u0275inj=lo({})}return n})();function qT(){return{provide:Um,useFactory:()=>{let n=V($g),e=V(Ie),t=V(jn),r=V(Wo),i=V(Bn);return t.scrollOffset&&n.setOffset(t.scrollOffset),new BT(i,r,n,e,t)}}}function zT(){return{provide:Su,useClass:Vg}}function HT(){return{provide:Su,useClass:Lg}}function WT(n){return[n.initialNavigation==="disabled"?zm().\u0275providers:[],n.initialNavigation==="enabledBlocking"?qm().\u0275providers:[]]}var al=new ue("");function GT(){return[{provide:al,useFactory:$m},{provide:Eu,multi:!0,useExisting:al}]}function QT(n,e){let t=!e?.manualCleanup;t&&!e?.injector&&fu(QT);let r=t?e?.injector?.get(Oi)??V(Oi):null,i=YT(e?.equal),s;e?.requireSync?s=yu({kind:0},{equal:i}):s=yu({kind:1,value:e?.initialValue},{equal:i});let o,c=n.subscribe({next:u=>s.set({kind:1,value:u}),error:u=>{if(e?.rejectErrors)throw u;s.set({kind:2,error:u})},complete:()=>{o?.()}});if(e?.requireSync&&s().kind===0)throw new ce(601,!1);return o=r?.onDestroy(c.unsubscribe.bind(c)),kg(()=>{let u=s();switch(u.kind){case 1:return u.value;case 2:throw u.error;case 0:throw new ce(601,!1)}},{equal:e?.equal})}function YT(n=Object.is){return(e,t)=>e.kind===1&&t.kind===1&&n(e.value,t.value)}function ul(n){n===void 0&&(fu(ul),n=V(et));let e=n.get(ho);return t=>new On(r=>{let i=e.add(),s=!1;function o(){s||(i(),s=!0)}let c=t.subscribe({next:u=>{r.next(u),o()},complete:()=>{r.complete(),o()},error:u=>{r.error(u),o()}});return c.add(()=>{r.unsubscribe(),o()}),c})}var Ym=()=>{};var Zm=function(n){let e=[],t=0;for(let r=0;r<n.length;r++){let i=n.charCodeAt(r);i<128?e[t++]=i:i<2048?(e[t++]=i>>6|192,e[t++]=i&63|128):(i&64512)===55296&&r+1<n.length&&(n.charCodeAt(r+1)&64512)===56320?(i=65536+((i&1023)<<10)+(n.charCodeAt(++r)&1023),e[t++]=i>>18|240,e[t++]=i>>12&63|128,e[t++]=i>>6&63|128,e[t++]=i&63|128):(e[t++]=i>>12|224,e[t++]=i>>6&63|128,e[t++]=i&63|128)}return e},JT=function(n){let e=[],t=0,r=0;for(;t<n.length;){let i=n[t++];if(i<128)e[r++]=String.fromCharCode(i);else if(i>191&&i<224){let s=n[t++];e[r++]=String.fromCharCode((i&31)<<6|s&63)}else if(i>239&&i<365){let s=n[t++],o=n[t++],c=n[t++],u=((i&7)<<18|(s&63)<<12|(o&63)<<6|c&63)-65536;e[r++]=String.fromCharCode(55296+(u>>10)),e[r++]=String.fromCharCode(56320+(u&1023))}else{let s=n[t++],o=n[t++];e[r++]=String.fromCharCode((i&15)<<12|(s&63)<<6|o&63)}}return e.join("")},Ko={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(n,e){if(!Array.isArray(n))throw Error("encodeByteArray takes an array as a parameter");this.init_();let t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let i=0;i<n.length;i+=3){let s=n[i],o=i+1<n.length,c=o?n[i+1]:0,u=i+2<n.length,h=u?n[i+2]:0,f=s>>2,g=(s&3)<<4|c>>4,_=(c&15)<<2|h>>6,b=h&63;u||(b=64,o||(_=64)),r.push(t[f],t[g],t[_],t[b])}return r.join("")},encodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(n):this.encodeByteArray(Zm(n),e)},decodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(n):JT(this.decodeStringToByteArray(n,e))},decodeStringToByteArray(n,e){this.init_();let t=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let i=0;i<n.length;){let s=t[n.charAt(i++)],c=i<n.length?t[n.charAt(i)]:0;++i;let h=i<n.length?t[n.charAt(i)]:64;++i;let g=i<n.length?t[n.charAt(i)]:64;if(++i,s==null||c==null||h==null||g==null)throw new hl;let _=s<<2|c>>4;if(r.push(_),h!==64){let b=c<<4&240|h>>2;if(r.push(b),g!==64){let P=h<<6&192|g;r.push(P)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let n=0;n<this.ENCODED_VALS.length;n++)this.byteToCharMap_[n]=this.ENCODED_VALS.charAt(n),this.charToByteMap_[this.byteToCharMap_[n]]=n,this.byteToCharMapWebSafe_[n]=this.ENCODED_VALS_WEBSAFE.charAt(n),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[n]]=n,n>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(n)]=n,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(n)]=n)}}},hl=class extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}},XT=function(n){let e=Zm(n);return Ko.encodeByteArray(e,!0)},os=function(n){return XT(n).replace(/\./g,"")},Qo=function(n){try{return Ko.decodeString(n,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};function fl(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}var ZT=()=>fl().__FIREBASE_DEFAULTS__,eA=()=>{if(typeof process>"u"||typeof process.env>"u")return;let n=process.env.__FIREBASE_DEFAULTS__;if(n)return JSON.parse(n)},tA=()=>{if(typeof document>"u")return;let n;try{n=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}let e=n&&Qo(n[1]);return e&&JSON.parse(e)},Yo=()=>{try{return Ym()||ZT()||eA()||tA()}catch(n){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${n}`);return}},pl=n=>{var e,t;return(t=(e=Yo())===null||e===void 0?void 0:e.emulatorHosts)===null||t===void 0?void 0:t[n]},ey=n=>{let e=pl(n);if(!e)return;let t=e.lastIndexOf(":");if(t<=0||t+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);let r=parseInt(e.substring(t+1),10);return e[0]==="["?[e.substring(1,t-1),r]:[e.substring(0,t),r]},gl=()=>{var n;return(n=Yo())===null||n===void 0?void 0:n.config},ml=n=>{var e;return(e=Yo())===null||e===void 0?void 0:e[`_${n}`]};var zn=class{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,r)=>{t?this.reject(t):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,r))}}};function Hn(n){return n.endsWith(".cloudworkstations.dev")}function Jo(n){return y(this,null,function*(){return(yield fetch(n,{credentials:"include"})).ok})}function ty(n,e){if(n.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');let t={alg:"none",type:"JWT"},r=e||"demo-project",i=n.iat||0,s=n.sub||n.user_id;if(!s)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");let o=Object.assign({iss:`https://securetoken.google.com/${r}`,aud:r,iat:i,exp:i+3600,auth_time:i,sub:s,user_id:s,firebase:{sign_in_provider:"custom",identities:{}}},n);return[os(JSON.stringify(t)),os(JSON.stringify(o)),""].join(".")}var ss={};function nA(){let n={prod:[],emulator:[]};for(let e of Object.keys(ss))ss[e]?n.emulator.push(e):n.prod.push(e);return n}function rA(n){let e=document.getElementById(n),t=!1;return e||(e=document.createElement("div"),e.setAttribute("id",n),t=!0),{created:t,element:e}}var Jm=!1;function Xo(n,e){if(typeof window>"u"||typeof document>"u"||!Hn(window.location.host)||ss[n]===e||ss[n]||Jm)return;ss[n]=e;function t(_){return`__firebase__banner__${_}`}let r="__firebase__banner",s=nA().prod.length>0;function o(){let _=document.getElementById(r);_&&_.remove()}function c(_){_.style.display="flex",_.style.background="#7faaf0",_.style.position="fixed",_.style.bottom="5px",_.style.left="5px",_.style.padding=".5em",_.style.borderRadius="5px",_.style.alignItems="center"}function u(_,b){_.setAttribute("width","24"),_.setAttribute("id",b),_.setAttribute("height","24"),_.setAttribute("viewBox","0 0 24 24"),_.setAttribute("fill","none"),_.style.marginLeft="-6px"}function h(){let _=document.createElement("span");return _.style.cursor="pointer",_.style.marginLeft="16px",_.style.fontSize="24px",_.innerHTML=" &times;",_.onclick=()=>{Jm=!0,o()},_}function f(_,b){_.setAttribute("id",b),_.innerText="Learn more",_.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",_.setAttribute("target","__blank"),_.style.paddingLeft="5px",_.style.textDecoration="underline"}function g(){let _=rA(r),b=t("text"),P=document.getElementById(b)||document.createElement("span"),O=t("learnmore"),k=document.getElementById(O)||document.createElement("a"),z=t("preprendIcon"),$=document.getElementById(z)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(_.created){let q=_.element;c(q),f(k,O);let se=h();u($,z),q.append($,P,k,se),document.body.appendChild(q)}s?(P.innerText="Preview backend disconnected.",$.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):($.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,P.innerText="Preview backend running in this workspace."),P.setAttribute("id",b)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",g):g()}function we(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function ny(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(we())}function iA(){var n;let e=(n=Yo())===null||n===void 0?void 0:n.forceEnvironment;if(e==="node")return!0;if(e==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function ry(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function iy(){let n=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof n=="object"&&n.id!==void 0}function sy(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function oy(){let n=we();return n.indexOf("MSIE ")>=0||n.indexOf("Trident/")>=0}function ay(){return!iA()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function as(){try{return typeof indexedDB=="object"}catch{return!1}}function cy(){return new Promise((n,e)=>{try{let t=!0,r="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(r);i.onsuccess=()=>{i.result.close(),t||self.indexedDB.deleteDatabase(r),n(!0)},i.onupgradeneeded=()=>{t=!1},i.onerror=()=>{var s;e(((s=i.error)===null||s===void 0?void 0:s.message)||"")}}catch(t){e(t)}})}var sA="FirebaseError",Ye=class n extends Error{constructor(e,t,r){super(t),this.code=e,this.customData=r,this.name=sA,Object.setPrototypeOf(this,n.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,ut.prototype.create)}},ut=class{constructor(e,t,r){this.service=e,this.serviceName=t,this.errors=r}create(e,...t){let r=t[0]||{},i=`${this.service}/${e}`,s=this.errors[e],o=s?oA(s,r):"Error",c=`${this.serviceName}: ${o} (${i}).`;return new Ye(i,c,r)}};function oA(n,e){return n.replace(aA,(t,r)=>{let i=e[r];return i!=null?String(i):`<${r}?>`})}var aA=/\{\$([^}]+)}/g;function uy(n){for(let e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}function lt(n,e){if(n===e)return!0;let t=Object.keys(n),r=Object.keys(e);for(let i of t){if(!r.includes(i))return!1;let s=n[i],o=e[i];if(Xm(s)&&Xm(o)){if(!lt(s,o))return!1}else if(s!==o)return!1}for(let i of r)if(!t.includes(i))return!1;return!0}function Xm(n){return n!==null&&typeof n=="object"}function Nr(n){let e=[];for(let[t,r]of Object.entries(n))Array.isArray(r)?r.forEach(i=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(i))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(r));return e.length?"&"+e.join("&"):""}function Or(n){let e={};return n.replace(/^\?/,"").split("&").forEach(r=>{if(r){let[i,s]=r.split("=");e[decodeURIComponent(i)]=decodeURIComponent(s)}}),e}function xr(n){let e=n.indexOf("?");if(!e)return"";let t=n.indexOf("#",e);return n.substring(e,t>0?t:void 0)}function ly(n,e){let t=new dl(n,e);return t.subscribe.bind(t)}var dl=class{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(r=>{this.error(r)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,r){let i;if(e===void 0&&t===void 0&&r===void 0)throw new Error("Missing Observer.");cA(e,["next","error","complete"])?i=e:i={next:e,error:t,complete:r},i.next===void 0&&(i.next=ll),i.error===void 0&&(i.error=ll),i.complete===void 0&&(i.complete=ll);let s=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?i.error(this.finalError):i.complete()}catch{}}),this.observers.push(i),s}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{t(this.observers[e])}catch(r){typeof console<"u"&&console.error&&console.error(r)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}};function cA(n,e){if(typeof n!="object"||n===null)return!1;for(let t of e)if(t in n&&typeof n[t]=="function")return!0;return!1}function ll(){}var Nk=4*60*60*1e3;function fe(n){return n&&n._delegate?n._delegate:n}var je=class{constructor(e,t,r){this.name=e,this.instanceFactory=t,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}};var Wn="[DEFAULT]";var yl=class{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){let t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){let r=new zn;if(this.instancesDeferred.set(t,r),this.isInitialized(t)||this.shouldAutoInitialize())try{let i=this.getOrInitializeService({instanceIdentifier:t});i&&r.resolve(i)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){var t;let r=this.normalizeInstanceIdentifier(e?.identifier),i=(t=e?.optional)!==null&&t!==void 0?t:!1;if(this.isInitialized(r)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:r})}catch(s){if(i)return null;throw s}else{if(i)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(lA(e))try{this.getOrInitializeService({instanceIdentifier:Wn})}catch{}for(let[t,r]of this.instancesDeferred.entries()){let i=this.normalizeInstanceIdentifier(t);try{let s=this.getOrInitializeService({instanceIdentifier:i});r.resolve(s)}catch{}}}}clearInstance(e=Wn){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}delete(){return y(this,null,function*(){let e=Array.from(this.instances.values());yield Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])})}isComponentSet(){return this.component!=null}isInitialized(e=Wn){return this.instances.has(e)}getOptions(e=Wn){return this.instancesOptions.get(e)||{}}initialize(e={}){let{options:t={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);let i=this.getOrInitializeService({instanceIdentifier:r,options:t});for(let[s,o]of this.instancesDeferred.entries()){let c=this.normalizeInstanceIdentifier(s);r===c&&o.resolve(i)}return i}onInit(e,t){var r;let i=this.normalizeInstanceIdentifier(t),s=(r=this.onInitCallbacks.get(i))!==null&&r!==void 0?r:new Set;s.add(e),this.onInitCallbacks.set(i,s);let o=this.instances.get(i);return o&&e(o,i),()=>{s.delete(e)}}invokeOnInitCallbacks(e,t){let r=this.onInitCallbacks.get(t);if(r)for(let i of r)try{i(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:uA(e),options:t}),this.instances.set(e,r),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=Wn){return this.component?this.component.multipleInstances?e:Wn:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}};function uA(n){return n===Wn?void 0:n}function lA(n){return n.instantiationMode==="EAGER"}var Zo=class{constructor(e){this.name=e,this.providers=new Map}addComponent(e){let t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);let t=new yl(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}};var hA=[],Q=function(n){return n[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT",n}(Q||{}),dA={debug:Q.DEBUG,verbose:Q.VERBOSE,info:Q.INFO,warn:Q.WARN,error:Q.ERROR,silent:Q.SILENT},fA=Q.INFO,pA={[Q.DEBUG]:"log",[Q.VERBOSE]:"log",[Q.INFO]:"info",[Q.WARN]:"warn",[Q.ERROR]:"error"},gA=(n,e,...t)=>{if(e<n.logLevel)return;let r=new Date().toISOString(),i=pA[e];if(i)console[i](`[${r}]  ${n.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)},It=class{constructor(e){this.name=e,this._logLevel=fA,this._logHandler=gA,this._userLogHandler=null,hA.push(this)}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in Q))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?dA[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,Q.DEBUG,...e),this._logHandler(this,Q.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,Q.VERBOSE,...e),this._logHandler(this,Q.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,Q.INFO,...e),this._logHandler(this,Q.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,Q.WARN,...e),this._logHandler(this,Q.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,Q.ERROR,...e),this._logHandler(this,Q.ERROR,...e)}};var mA=(n,e)=>e.some(t=>n instanceof t),hy,dy;function yA(){return hy||(hy=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function _A(){return dy||(dy=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}var fy=new WeakMap,vl=new WeakMap,py=new WeakMap,_l=new WeakMap,wl=new WeakMap;function vA(n){let e=new Promise((t,r)=>{let i=()=>{n.removeEventListener("success",s),n.removeEventListener("error",o)},s=()=>{t(wt(n.result)),i()},o=()=>{r(n.error),i()};n.addEventListener("success",s),n.addEventListener("error",o)});return e.then(t=>{t instanceof IDBCursor&&fy.set(t,n)}).catch(()=>{}),wl.set(e,n),e}function IA(n){if(vl.has(n))return;let e=new Promise((t,r)=>{let i=()=>{n.removeEventListener("complete",s),n.removeEventListener("error",o),n.removeEventListener("abort",o)},s=()=>{t(),i()},o=()=>{r(n.error||new DOMException("AbortError","AbortError")),i()};n.addEventListener("complete",s),n.addEventListener("error",o),n.addEventListener("abort",o)});vl.set(n,e)}var Il={get(n,e,t){if(n instanceof IDBTransaction){if(e==="done")return vl.get(n);if(e==="objectStoreNames")return n.objectStoreNames||py.get(n);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return wt(n[e])},set(n,e,t){return n[e]=t,!0},has(n,e){return n instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in n}};function gy(n){Il=n(Il)}function wA(n){return n===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){let r=n.call(ea(this),e,...t);return py.set(r,e.sort?e.sort():[e]),wt(r)}:_A().includes(n)?function(...e){return n.apply(ea(this),e),wt(fy.get(this))}:function(...e){return wt(n.apply(ea(this),e))}}function EA(n){return typeof n=="function"?wA(n):(n instanceof IDBTransaction&&IA(n),mA(n,yA())?new Proxy(n,Il):n)}function wt(n){if(n instanceof IDBRequest)return vA(n);if(_l.has(n))return _l.get(n);let e=EA(n);return e!==n&&(_l.set(n,e),wl.set(e,n)),e}var ea=n=>wl.get(n);function yy(n,e,{blocked:t,upgrade:r,blocking:i,terminated:s}={}){let o=indexedDB.open(n,e),c=wt(o);return r&&o.addEventListener("upgradeneeded",u=>{r(wt(o.result),u.oldVersion,u.newVersion,wt(o.transaction),u)}),t&&o.addEventListener("blocked",u=>t(u.oldVersion,u.newVersion,u)),c.then(u=>{s&&u.addEventListener("close",()=>s()),i&&u.addEventListener("versionchange",h=>i(h.oldVersion,h.newVersion,h))}).catch(()=>{}),c}var TA=["get","getKey","getAll","getAllKeys","count"],AA=["put","add","delete","clear"],El=new Map;function my(n,e){if(!(n instanceof IDBDatabase&&!(e in n)&&typeof e=="string"))return;if(El.get(e))return El.get(e);let t=e.replace(/FromIndex$/,""),r=e!==t,i=AA.includes(t);if(!(t in(r?IDBIndex:IDBObjectStore).prototype)||!(i||TA.includes(t)))return;let s=function(o,...c){return y(this,null,function*(){let u=this.transaction(o,i?"readwrite":"readonly"),h=u.store;return r&&(h=h.index(c.shift())),(yield Promise.all([h[t](...c),i&&u.done]))[0]})};return El.set(e,s),s}gy(n=>be(L({},n),{get:(e,t,r)=>my(e,t)||n.get(e,t,r),has:(e,t)=>!!my(e,t)||n.has(e,t)}));var Al=class{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(SA(t)){let r=t.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(t=>t).join(" ")}};function SA(n){let e=n.getComponent();return e?.type==="VERSION"}var Sl="@firebase/app",_y="0.13.0";var Ut=new It("@firebase/app"),bA="@firebase/app-compat",RA="@firebase/analytics-compat",CA="@firebase/analytics",PA="@firebase/app-check-compat",DA="@firebase/app-check",kA="@firebase/auth",NA="@firebase/auth-compat",OA="@firebase/database",xA="@firebase/data-connect",MA="@firebase/database-compat",LA="@firebase/functions",VA="@firebase/functions-compat",FA="@firebase/installations",UA="@firebase/installations-compat",BA="@firebase/messaging",$A="@firebase/messaging-compat",jA="@firebase/performance",qA="@firebase/performance-compat",zA="@firebase/remote-config",HA="@firebase/remote-config-compat",WA="@firebase/storage",GA="@firebase/storage-compat",KA="@firebase/firestore",QA="@firebase/ai",YA="@firebase/firestore-compat",JA="firebase",XA="11.8.0";var bl="[DEFAULT]",ZA={[Sl]:"fire-core",[bA]:"fire-core-compat",[CA]:"fire-analytics",[RA]:"fire-analytics-compat",[DA]:"fire-app-check",[PA]:"fire-app-check-compat",[kA]:"fire-auth",[NA]:"fire-auth-compat",[OA]:"fire-rtdb",[xA]:"fire-data-connect",[MA]:"fire-rtdb-compat",[LA]:"fire-fn",[VA]:"fire-fn-compat",[FA]:"fire-iid",[UA]:"fire-iid-compat",[BA]:"fire-fcm",[$A]:"fire-fcm-compat",[jA]:"fire-perf",[qA]:"fire-perf-compat",[zA]:"fire-rc",[HA]:"fire-rc-compat",[WA]:"fire-gcs",[GA]:"fire-gcs-compat",[KA]:"fire-fst",[YA]:"fire-fst-compat",[QA]:"fire-vertex","fire-js":"fire-js",[JA]:"fire-js-all"};var cs=new Map,eS=new Map,Rl=new Map;function vy(n,e){try{n.container.addComponent(e)}catch(t){Ut.debug(`Component ${e.name} failed to register with FirebaseApp ${n.name}`,t)}}function ht(n){let e=n.name;if(Rl.has(e))return Ut.debug(`There were multiple attempts to register component ${e}.`),!1;Rl.set(e,n);for(let t of cs.values())vy(t,n);for(let t of eS.values())vy(t,n);return!0}function Mr(n,e){let t=n.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),n.container.getProvider(e)}function xe(n){return n==null?!1:n.settings!==void 0}var tS={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},fn=new ut("app","Firebase",tS);var Cl=class{constructor(e,t,r){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},t),this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new je("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw fn.create("app-deleted",{appName:this._name})}};var pn=XA;function kl(n,e={}){let t=n;typeof e!="object"&&(e={name:e});let r=Object.assign({name:bl,automaticDataCollectionEnabled:!0},e),i=r.name;if(typeof i!="string"||!i)throw fn.create("bad-app-name",{appName:String(i)});if(t||(t=gl()),!t)throw fn.create("no-options");let s=cs.get(i);if(s){if(lt(t,s.options)&&lt(r,s.config))return s;throw fn.create("duplicate-app",{appName:i})}let o=new Zo(i);for(let u of Rl.values())o.addComponent(u);let c=new Cl(t,r,o);return cs.set(i,c),c}function Gn(n=bl){let e=cs.get(n);if(!e&&n===bl&&gl())return kl();if(!e)throw fn.create("no-app",{appName:n});return e}function ta(){return Array.from(cs.values())}function pe(n,e,t){var r;let i=(r=ZA[n])!==null&&r!==void 0?r:n;t&&(i+=`-${t}`);let s=i.match(/\s|\//),o=e.match(/\s|\//);if(s||o){let c=[`Unable to register library "${i}" with version "${e}":`];s&&c.push(`library name "${i}" contains illegal characters (whitespace or "/")`),s&&o&&c.push("and"),o&&c.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Ut.warn(c.join(" "));return}ht(new je(`${i}-version`,()=>({library:i,version:e}),"VERSION"))}var nS="firebase-heartbeat-database",rS=1,us="firebase-heartbeat-store",Tl=null;function Ty(){return Tl||(Tl=yy(nS,rS,{upgrade:(n,e)=>{switch(e){case 0:try{n.createObjectStore(us)}catch(t){console.warn(t)}}}}).catch(n=>{throw fn.create("idb-open",{originalErrorMessage:n.message})})),Tl}function iS(n){return y(this,null,function*(){try{let t=(yield Ty()).transaction(us),r=yield t.objectStore(us).get(Ay(n));return yield t.done,r}catch(e){if(e instanceof Ye)Ut.warn(e.message);else{let t=fn.create("idb-get",{originalErrorMessage:e?.message});Ut.warn(t.message)}}})}function Iy(n,e){return y(this,null,function*(){try{let r=(yield Ty()).transaction(us,"readwrite");yield r.objectStore(us).put(e,Ay(n)),yield r.done}catch(t){if(t instanceof Ye)Ut.warn(t.message);else{let r=fn.create("idb-set",{originalErrorMessage:t?.message});Ut.warn(r.message)}}})}function Ay(n){return`${n.name}!${n.options.appId}`}var sS=1024,oS=30,Pl=class{constructor(e){this.container=e,this._heartbeatsCache=null;let t=this.container.getProvider("app").getImmediate();this._storage=new Dl(t),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}triggerHeartbeat(){return y(this,null,function*(){var e,t;try{let i=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),s=wy();if(((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=yield this._heartbeatsCachePromise,((t=this._heartbeatsCache)===null||t===void 0?void 0:t.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===s||this._heartbeatsCache.heartbeats.some(o=>o.date===s))return;if(this._heartbeatsCache.heartbeats.push({date:s,agent:i}),this._heartbeatsCache.heartbeats.length>oS){let o=cS(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(o,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(r){Ut.warn(r)}})}getHeartbeatsHeader(){return y(this,null,function*(){var e;try{if(this._heartbeatsCache===null&&(yield this._heartbeatsCachePromise),((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";let t=wy(),{heartbeatsToSend:r,unsentEntries:i}=aS(this._heartbeatsCache.heartbeats),s=os(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=t,i.length>0?(this._heartbeatsCache.heartbeats=i,yield this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),s}catch(t){return Ut.warn(t),""}})}};function wy(){return new Date().toISOString().substring(0,10)}function aS(n,e=sS){let t=[],r=n.slice();for(let i of n){let s=t.find(o=>o.agent===i.agent);if(s){if(s.dates.push(i.date),Ey(t)>e){s.dates.pop();break}}else if(t.push({agent:i.agent,dates:[i.date]}),Ey(t)>e){t.pop();break}r=r.slice(1)}return{heartbeatsToSend:t,unsentEntries:r}}var Dl=class{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}runIndexedDBEnvironmentCheck(){return y(this,null,function*(){return as()?cy().then(()=>!0).catch(()=>!1):!1})}read(){return y(this,null,function*(){if(yield this._canUseIndexedDBPromise){let t=yield iS(this.app);return t?.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}})}overwrite(e){return y(this,null,function*(){var t;if(yield this._canUseIndexedDBPromise){let i=yield this.read();return Iy(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:i.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return})}add(e){return y(this,null,function*(){var t;if(yield this._canUseIndexedDBPromise){let i=yield this.read();return Iy(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:i.lastSentHeartbeatDate,heartbeats:[...i.heartbeats,...e.heartbeats]})}else return})}};function Ey(n){return os(JSON.stringify({version:2,heartbeats:n})).length}function cS(n){if(n.length===0)return-1;let e=0,t=n[0].date;for(let r=1;r<n.length;r++)n[r].date<t&&(t=n[r].date,e=r);return e}function uS(n){ht(new je("platform-logger",e=>new Al(e),"PRIVATE")),ht(new je("heartbeat",e=>new Pl(e),"PRIVATE")),pe(Sl,_y,n),pe(Sl,_y,"esm2017"),pe("fire-js","")}uS("");var lS="firebase",hS="11.8.1";pe(lS,hS,"app");var gn=new Rg("ANGULARFIRE2_VERSION");function ls(n,e,t){if(e){if(e.length===1)return e[0];let s=e.filter(o=>o.app===t);if(s.length===1)return s[0]}return t.container.getProvider(n).getImmediate({optional:!0})}var Vr=(n,e)=>{let t=e?[e]:ta(),r=[];return t.forEach(i=>{i.container.getProvider(n).instances.forEach(o=>{r.includes(o)||r.push(o)})}),r},Lr=function(n){return n[n.SILENT=0]="SILENT",n[n.WARN=1]="WARN",n[n.VERBOSE=2]="VERBOSE",n}(Lr||{}),Sy=Tu()&&typeof Zone<"u"?Lr.WARN:Lr.SILENT;var na=class{zone;delegate;constructor(e,t=rg){this.zone=e,this.delegate=t}now(){return this.delegate.now()}schedule(e,t,r){let i=this.zone,s=function(o){i?i.runGuarded(()=>{e.apply(this,[o])}):e.apply(this,[o])};return this.delegate.schedule(s,t,r)}},mn=(()=>{class n{outsideAngular;insideAngular;constructor(){let t=V(Ie);this.outsideAngular=t.runOutsideAngular(()=>new na(typeof Zone>"u"?void 0:Zone.current)),this.insideAngular=t.run(()=>new na(typeof Zone>"u"?void 0:Zone.current,ng))}static \u0275fac=function(r){return new(r||n)};static \u0275prov=ee({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),by=!1;function dS(n,e){!by&&(Sy>Lr.SILENT||Tu())&&(by=!0,console.warn("Calling Firebase APIs outside of an Injection context may destabilize your application leading to subtle change-detection and hydration bugs. Find more at https://github.com/angular/angularfire/blob/main/docs/zones.md")),Sy>=e&&console.warn(`Firebase API called outside injection context: ${n.name}`)}function fS(n){let e=V(Ie,{optional:!0});return e?e.runOutsideAngular(()=>n()):n()}function Kn(n){let e=V(Ie,{optional:!0});return e?e.run(()=>n()):n()}var pS=(n,e,t)=>(...r)=>(e&&setTimeout(e,0),ze(t,()=>Kn(()=>n.apply(void 0,r)))),Ee=(n,e,t)=>(t||=e?Lr.WARN:Lr.VERBOSE,function(){let r,i=arguments,s,o,c;try{s=V(mn),o=V(ho),c=V(cn)}catch{return dS(n,t),n.apply(this,i)}for(let h=0;h<arguments.length;h++)typeof i[h]=="function"&&(e&&(r||=Kn(()=>o.add())),i[h]=pS(i[h],r,c));let u=fS(()=>n.apply(this,i));return e?u instanceof On?u.pipe(su(s.outsideAngular),iu(s.insideAngular),ul(c)):u instanceof Promise?Kn(()=>new Promise((h,f)=>{o.run(()=>u).then(g=>ze(c,()=>Kn(()=>h(g))),g=>ze(c,()=>Kn(()=>f(g))))})):typeof u=="function"&&r?function(){return setTimeout(r,0),u.apply(this,arguments)}:Kn(()=>u):u instanceof On?u.pipe(su(s.outsideAngular),iu(s.insideAngular)):Kn(()=>u)});var Bt=class{constructor(e){return e}},Qn=class{constructor(){return ta()}};function gS(n){return n&&n.length===1?n[0]:new Bt(Gn())}var Nl=new ue("angularfire2._apps"),mS={provide:Bt,useFactory:gS,deps:[[new Ze,Nl]]},yS={provide:Qn,deps:[[new Ze,Nl]]};function _S(n){return(e,t)=>{let r=t.get(Ln);pe("angularfire",gn.full,"core"),pe("angularfire",gn.full,"app"),pe("angular",Cg.full,r.toString());let i=e.runOutsideAngular(()=>n(t));return new Bt(i)}}function IN(n,...e){return an([mS,yS,{provide:Nl,useFactory:_S(n),multi:!0,deps:[Ie,et,mn,...e]}])}var wN=Ee(kl,!0);function jy(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}var qy=jy,zy=new ut("auth","Firebase",jy());var ca=new It("@firebase/auth");function vS(n,...e){ca.logLevel<=Q.WARN&&ca.warn(`Auth (${pn}): ${n}`,...e)}function ia(n,...e){ca.logLevel<=Q.ERROR&&ca.error(`Auth (${pn}): ${n}`,...e)}function tt(n,...e){throw th(n,...e)}function dt(n,...e){return th(n,...e)}function eh(n,e,t){let r=Object.assign(Object.assign({},qy()),{[e]:t});return new ut("auth","Firebase",r).create(e,{appName:n.name})}function Et(n){return eh(n,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function IS(n,e,t){let r=t;if(!(e instanceof r))throw r.name!==e.constructor.name&&tt(n,"argument-error"),eh(n,"argument-error",`Type of ${e.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function th(n,...e){if(typeof n!="string"){let t=e[0],r=[...e.slice(1)];return r[0]&&(r[0].appName=n.name),n._errorFactory.create(t,...r)}return zy.create(n,...e)}function B(n,e,...t){if(!n)throw th(e,...t)}function $t(n){let e="INTERNAL ASSERTION FAILED: "+n;throw ia(e),new Error(e)}function qt(n,e){n||$t(e)}function Ml(){var n;return typeof self<"u"&&((n=self.location)===null||n===void 0?void 0:n.href)||""}function wS(){return Ry()==="http:"||Ry()==="https:"}function Ry(){var n;return typeof self<"u"&&((n=self.location)===null||n===void 0?void 0:n.protocol)||null}function ES(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(wS()||iy()||"connection"in navigator)?navigator.onLine:!0}function TS(){if(typeof navigator>"u")return null;let n=navigator;return n.languages&&n.languages[0]||n.language||null}var Yn=class{constructor(e,t){this.shortDelay=e,this.longDelay=t,qt(t>e,"Short delay should be less than long delay!"),this.isMobile=ny()||sy()}get(){return ES()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}};function nh(n,e){qt(n.emulator,"Emulator should always be set here");let{url:t}=n.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}var ua=class{static initialize(e,t,r){this.fetchImpl=e,t&&(this.headersImpl=t),r&&(this.responseImpl=r)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;$t("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;$t("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;$t("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}};var AS={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};var SS=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],bS=new Yn(3e4,6e4);function In(n,e){return n.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:n.tenantId}):e}function zt(s,o,c,u){return y(this,arguments,function*(n,e,t,r,i={}){return Hy(n,i,()=>y(null,null,function*(){let h={},f={};r&&(e==="GET"?f=r:h={body:JSON.stringify(r)});let g=Nr(Object.assign({key:n.config.apiKey},f)).slice(1),_=yield n._getAdditionalHeaders();_["Content-Type"]="application/json",n.languageCode&&(_["X-Firebase-Locale"]=n.languageCode);let b=Object.assign({method:e,headers:_},h);return ry()||(b.referrerPolicy="no-referrer"),n.emulatorConfig&&Hn(n.emulatorConfig.host)&&(b.credentials="include"),ua.fetch()(yield Wy(n,n.config.apiHost,t,g),b)}))})}function Hy(n,e,t){return y(this,null,function*(){n._canInitEmulator=!1;let r=Object.assign(Object.assign({},AS),e);try{let i=new Ll(n),s=yield Promise.race([t(),i.promise]);i.clearNetworkTimeout();let o=yield s.json();if("needConfirmation"in o)throw ra(n,"account-exists-with-different-credential",o);if(s.ok&&!("errorMessage"in o))return o;{let c=s.ok?o.errorMessage:o.error.message,[u,h]=c.split(" : ");if(u==="FEDERATED_USER_ID_ALREADY_LINKED")throw ra(n,"credential-already-in-use",o);if(u==="EMAIL_EXISTS")throw ra(n,"email-already-in-use",o);if(u==="USER_DISABLED")throw ra(n,"user-disabled",o);let f=r[u]||u.toLowerCase().replace(/[_\s]+/g,"-");if(h)throw eh(n,f,h);tt(n,f)}}catch(i){if(i instanceof Ye)throw i;tt(n,"network-request-failed",{message:String(i)})}})}function _s(s,o,c,u){return y(this,arguments,function*(n,e,t,r,i={}){let h=yield zt(n,e,t,r,i);return"mfaPendingCredential"in h&&tt(n,"multi-factor-auth-required",{_serverResponse:h}),h})}function Wy(n,e,t,r){return y(this,null,function*(){let i=`${e}${t}?${r}`,s=n,o=s.config.emulator?nh(n.config,i):`${n.config.apiScheme}://${i}`;return SS.includes(t)&&(yield s._persistenceManagerAvailable,s._getPersistenceType()==="COOKIE")?s._getPersistence()._getFinalTarget(o).toString():o})}function RS(n){switch(n){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}var Ll=class{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,r)=>{this.timer=setTimeout(()=>r(dt(this.auth,"network-request-failed")),bS.get())})}};function ra(n,e,t){let r={appName:n.name};t.email&&(r.email=t.email),t.phoneNumber&&(r.phoneNumber=t.phoneNumber);let i=dt(n,e,r);return i.customData._tokenResponse=t,i}function Cy(n){return n!==void 0&&n.enterprise!==void 0}var Vl=class{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(let t of this.recaptchaEnforcementState)if(t.provider&&t.provider===e)return RS(t.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}};function CS(n,e){return y(this,null,function*(){return zt(n,"GET","/v2/recaptchaConfig",In(n,e))})}function PS(n,e){return y(this,null,function*(){return zt(n,"POST","/v1/accounts:delete",e)})}function la(n,e){return y(this,null,function*(){return zt(n,"POST","/v1/accounts:lookup",e)})}function ds(n){if(n)try{let e=new Date(Number(n));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}function rh(n,e=!1){return y(this,null,function*(){let t=fe(n),r=yield t.getIdToken(e),i=ih(r);B(i&&i.exp&&i.auth_time&&i.iat,t.auth,"internal-error");let s=typeof i.firebase=="object"?i.firebase:void 0,o=s?.sign_in_provider;return{claims:i,token:r,authTime:ds(Ol(i.auth_time)),issuedAtTime:ds(Ol(i.iat)),expirationTime:ds(Ol(i.exp)),signInProvider:o||null,signInSecondFactor:s?.sign_in_second_factor||null}})}function Ol(n){return Number(n)*1e3}function ih(n){let[e,t,r]=n.split(".");if(e===void 0||t===void 0||r===void 0)return ia("JWT malformed, contained fewer than 3 sections"),null;try{let i=Qo(t);return i?JSON.parse(i):(ia("Failed to decode base64 JWT payload"),null)}catch(i){return ia("Caught error parsing JWT payload as JSON",i?.toString()),null}}function Py(n){let e=ih(n);return B(e,"internal-error"),B(typeof e.exp<"u","internal-error"),B(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}function Ur(n,e,t=!1){return y(this,null,function*(){if(t)return e;try{return yield e}catch(r){throw r instanceof Ye&&DS(r)&&n.auth.currentUser===n&&(yield n.auth.signOut()),r}})}function DS({code:n}){return n==="auth/user-disabled"||n==="auth/user-token-expired"}var Fl=class{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){var t;if(e){let r=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),r}else{this.errorBackoff=3e4;let i=((t=this.user.stsTokenManager.expirationTime)!==null&&t!==void 0?t:0)-Date.now()-3e5;return Math.max(0,i)}}schedule(e=!1){if(!this.isRunning)return;let t=this.getInterval(e);this.timerId=setTimeout(()=>y(this,null,function*(){yield this.iteration()}),t)}iteration(){return y(this,null,function*(){try{yield this.user.getIdToken(!0)}catch(e){e?.code==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()})}};var ps=class{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=ds(this.lastLoginAt),this.creationTime=ds(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}};function ha(n){return y(this,null,function*(){var e;let t=n.auth,r=yield n.getIdToken(),i=yield Ur(n,la(t,{idToken:r}));B(i?.users.length,t,"internal-error");let s=i.users[0];n._notifyReloadListener(s);let o=!((e=s.providerUserInfo)===null||e===void 0)&&e.length?Gy(s.providerUserInfo):[],c=kS(n.providerData,o),u=n.isAnonymous,h=!(n.email&&s.passwordHash)&&!c?.length,f=u?h:!1,g={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:c,metadata:new ps(s.createdAt,s.lastLoginAt),isAnonymous:f};Object.assign(n,g)})}function sh(n){return y(this,null,function*(){let e=fe(n);yield ha(e),yield e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)})}function kS(n,e){return[...n.filter(r=>!e.some(i=>i.providerId===r.providerId)),...e]}function Gy(n){return n.map(e=>{var{providerId:t}=e,r=co(e,["providerId"]);return{providerId:t,uid:r.rawId||"",displayName:r.displayName||null,email:r.email||null,phoneNumber:r.phoneNumber||null,photoURL:r.photoUrl||null}})}function NS(n,e){return y(this,null,function*(){let t=yield Hy(n,{},()=>y(null,null,function*(){let r=Nr({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:i,apiKey:s}=n.config,o=yield Wy(n,i,"/v1/token",`key=${s}`),c=yield n._getAdditionalHeaders();return c["Content-Type"]="application/x-www-form-urlencoded",ua.fetch()(o,{method:"POST",headers:c,body:r})}));return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}})}function OS(n,e){return y(this,null,function*(){return zt(n,"POST","/v2/accounts:revokeToken",In(n,e))})}var fs=class n{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){B(e.idToken,"internal-error"),B(typeof e.idToken<"u","internal-error"),B(typeof e.refreshToken<"u","internal-error");let t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):Py(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){B(e.length!==0,"internal-error");let t=Py(e);this.updateTokensAndExpiration(e,null,t)}getToken(e,t=!1){return y(this,null,function*(){return!t&&this.accessToken&&!this.isExpired?this.accessToken:(B(this.refreshToken,e,"user-token-expired"),this.refreshToken?(yield this.refresh(e,this.refreshToken),this.accessToken):null)})}clearRefreshToken(){this.refreshToken=null}refresh(e,t){return y(this,null,function*(){let{accessToken:r,refreshToken:i,expiresIn:s}=yield NS(e,t);this.updateTokensAndExpiration(r,i,Number(s))})}updateTokensAndExpiration(e,t,r){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+r*1e3}static fromJSON(e,t){let{refreshToken:r,accessToken:i,expirationTime:s}=t,o=new n;return r&&(B(typeof r=="string","internal-error",{appName:e}),o.refreshToken=r),i&&(B(typeof i=="string","internal-error",{appName:e}),o.accessToken=i),s&&(B(typeof s=="number","internal-error",{appName:e}),o.expirationTime=s),o}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new n,this.toJSON())}_performRefresh(){return $t("not implemented")}};function yn(n,e){B(typeof n=="string"||typeof n>"u","internal-error",{appName:e})}var _n=class n{constructor(e){var{uid:t,auth:r,stsTokenManager:i}=e,s=co(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new Fl(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=t,this.auth=r,this.stsTokenManager=i,this.accessToken=i.accessToken,this.displayName=s.displayName||null,this.email=s.email||null,this.emailVerified=s.emailVerified||!1,this.phoneNumber=s.phoneNumber||null,this.photoURL=s.photoURL||null,this.isAnonymous=s.isAnonymous||!1,this.tenantId=s.tenantId||null,this.providerData=s.providerData?[...s.providerData]:[],this.metadata=new ps(s.createdAt||void 0,s.lastLoginAt||void 0)}getIdToken(e){return y(this,null,function*(){let t=yield Ur(this,this.stsTokenManager.getToken(this.auth,e));return B(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,yield this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t})}getIdTokenResult(e){return rh(this,e)}reload(){return sh(this)}_assign(e){this!==e&&(B(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>Object.assign({},t)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){let t=new n(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return t.metadata._copy(this.metadata),t}_onReload(e){B(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}_updateTokensIfNecessary(e,t=!1){return y(this,null,function*(){let r=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),r=!0),t&&(yield ha(this)),yield this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)})}delete(){return y(this,null,function*(){if(xe(this.auth.app))return Promise.reject(Et(this.auth));let e=yield this.getIdToken();return yield Ur(this,PS(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()})}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){var r,i,s,o,c,u,h,f;let g=(r=t.displayName)!==null&&r!==void 0?r:void 0,_=(i=t.email)!==null&&i!==void 0?i:void 0,b=(s=t.phoneNumber)!==null&&s!==void 0?s:void 0,P=(o=t.photoURL)!==null&&o!==void 0?o:void 0,O=(c=t.tenantId)!==null&&c!==void 0?c:void 0,k=(u=t._redirectEventId)!==null&&u!==void 0?u:void 0,z=(h=t.createdAt)!==null&&h!==void 0?h:void 0,$=(f=t.lastLoginAt)!==null&&f!==void 0?f:void 0,{uid:q,emailVerified:se,isAnonymous:Fe,providerData:re,stsTokenManager:E}=t;B(q&&E,e,"internal-error");let m=fs.fromJSON(this.name,E);B(typeof q=="string",e,"internal-error"),yn(g,e.name),yn(_,e.name),B(typeof se=="boolean",e,"internal-error"),B(typeof Fe=="boolean",e,"internal-error"),yn(b,e.name),yn(P,e.name),yn(O,e.name),yn(k,e.name),yn(z,e.name),yn($,e.name);let I=new n({uid:q,auth:e,email:_,emailVerified:se,displayName:g,isAnonymous:Fe,photoURL:P,phoneNumber:b,tenantId:O,stsTokenManager:m,createdAt:z,lastLoginAt:$});return re&&Array.isArray(re)&&(I.providerData=re.map(w=>Object.assign({},w))),k&&(I._redirectEventId=k),I}static _fromIdTokenResponse(e,t,r=!1){return y(this,null,function*(){let i=new fs;i.updateFromServerResponse(t);let s=new n({uid:t.localId,auth:e,stsTokenManager:i,isAnonymous:r});return yield ha(s),s})}static _fromGetAccountInfoResponse(e,t,r){return y(this,null,function*(){let i=t.users[0];B(i.localId!==void 0,"internal-error");let s=i.providerUserInfo!==void 0?Gy(i.providerUserInfo):[],o=!(i.email&&i.passwordHash)&&!s?.length,c=new fs;c.updateFromIdToken(r);let u=new n({uid:i.localId,auth:e,stsTokenManager:c,isAnonymous:o}),h={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:s,metadata:new ps(i.createdAt,i.lastLoginAt),isAnonymous:!(i.email&&i.passwordHash)&&!s?.length};return Object.assign(u,h),u})}};var Dy=new Map;function jt(n){qt(n instanceof Function,"Expected a class definition");let e=Dy.get(n);return e?(qt(e instanceof n,"Instance stored in cache mismatched with class"),e):(e=new n,Dy.set(n,e),e)}var xS=(()=>{class n{constructor(){this.type="NONE",this.storage={}}_isAvailable(){return y(this,null,function*(){return!0})}_set(t,r){return y(this,null,function*(){this.storage[t]=r})}_get(t){return y(this,null,function*(){let r=this.storage[t];return r===void 0?null:r})}_remove(t){return y(this,null,function*(){delete this.storage[t]})}_addListener(t,r){}_removeListener(t,r){}}return n.type="NONE",n})(),Ul=xS;function sa(n,e,t){return`firebase:${n}:${e}:${t}`}var da=class n{constructor(e,t,r){this.persistence=e,this.auth=t,this.userKey=r;let{config:i,name:s}=this.auth;this.fullUserKey=sa(this.userKey,i.apiKey,s),this.fullPersistenceKey=sa("persistence",i.apiKey,s),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}getCurrentUser(){return y(this,null,function*(){let e=yield this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){let t=yield la(this.auth,{idToken:e}).catch(()=>{});return t?_n._fromGetAccountInfoResponse(this.auth,t,e):null}return _n._fromJSON(this.auth,e)})}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}setPersistence(e){return y(this,null,function*(){if(this.persistence===e)return;let t=yield this.getCurrentUser();if(yield this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)})}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static create(e,t,r="authUser"){return y(this,null,function*(){if(!t.length)return new n(jt(Ul),e,r);let i=(yield Promise.all(t.map(h=>y(null,null,function*(){if(yield h._isAvailable())return h})))).filter(h=>h),s=i[0]||jt(Ul),o=sa(r,e.config.apiKey,e.name),c=null;for(let h of t)try{let f=yield h._get(o);if(f){let g;if(typeof f=="string"){let _=yield la(e,{idToken:f}).catch(()=>{});if(!_)break;g=yield _n._fromGetAccountInfoResponse(e,_,f)}else g=_n._fromJSON(e,f);h!==s&&(c=g),s=h;break}}catch{}let u=i.filter(h=>h._shouldAllowMigration);return!s._shouldAllowMigration||!u.length?new n(s,e,r):(s=u[0],c&&(yield s._set(o,c.toJSON())),yield Promise.all(t.map(h=>y(null,null,function*(){if(h!==s)try{yield h._remove(o)}catch{}}))),new n(s,e,r))})}};function ky(n){let e=n.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(Jy(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(Ky(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(Zy(e))return"Blackberry";if(e_(e))return"Webos";if(Qy(e))return"Safari";if((e.includes("chrome/")||Yy(e))&&!e.includes("edge/"))return"Chrome";if(Xy(e))return"Android";{let t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,r=n.match(t);if(r?.length===2)return r[1]}return"Other"}function Ky(n=we()){return/firefox\//i.test(n)}function Qy(n=we()){let e=n.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function Yy(n=we()){return/crios\//i.test(n)}function Jy(n=we()){return/iemobile/i.test(n)}function Xy(n=we()){return/android/i.test(n)}function Zy(n=we()){return/blackberry/i.test(n)}function e_(n=we()){return/webos/i.test(n)}function oh(n=we()){return/iphone|ipad|ipod/i.test(n)||/macintosh/i.test(n)&&/mobile/i.test(n)}function MS(n=we()){var e;return oh(n)&&!!(!((e=window.navigator)===null||e===void 0)&&e.standalone)}function LS(){return oy()&&document.documentMode===10}function t_(n=we()){return oh(n)||Xy(n)||e_(n)||Zy(n)||/windows phone/i.test(n)||Jy(n)}function n_(n,e=[]){let t;switch(n){case"Browser":t=ky(we());break;case"Worker":t=`${ky(we())}-${n}`;break;default:t=n}let r=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${pn}/${r}`}var Bl=class{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){let r=s=>new Promise((o,c)=>{try{let u=e(s);o(u)}catch(u){c(u)}});r.onAbort=t,this.queue.push(r);let i=this.queue.length-1;return()=>{this.queue[i]=()=>Promise.resolve()}}runMiddleware(e){return y(this,null,function*(){if(this.auth.currentUser===e)return;let t=[];try{for(let r of this.queue)yield r(e),r.onAbort&&t.push(r.onAbort)}catch(r){t.reverse();for(let i of t)try{i()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:r?.message})}})}};function VS(t){return y(this,arguments,function*(n,e={}){return zt(n,"GET","/v2/passwordPolicy",In(n,e))})}var FS=6,$l=class{constructor(e){var t,r,i,s;let o=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=(t=o.minPasswordLength)!==null&&t!==void 0?t:FS,o.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=o.maxPasswordLength),o.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=o.containsLowercaseCharacter),o.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=o.containsUppercaseCharacter),o.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=o.containsNumericCharacter),o.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=o.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=(i=(r=e.allowedNonAlphanumericCharacters)===null||r===void 0?void 0:r.join(""))!==null&&i!==void 0?i:"",this.forceUpgradeOnSignin=(s=e.forceUpgradeOnSignin)!==null&&s!==void 0?s:!1,this.schemaVersion=e.schemaVersion}validatePassword(e){var t,r,i,s,o,c;let u={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,u),this.validatePasswordCharacterOptions(e,u),u.isValid&&(u.isValid=(t=u.meetsMinPasswordLength)!==null&&t!==void 0?t:!0),u.isValid&&(u.isValid=(r=u.meetsMaxPasswordLength)!==null&&r!==void 0?r:!0),u.isValid&&(u.isValid=(i=u.containsLowercaseLetter)!==null&&i!==void 0?i:!0),u.isValid&&(u.isValid=(s=u.containsUppercaseLetter)!==null&&s!==void 0?s:!0),u.isValid&&(u.isValid=(o=u.containsNumericCharacter)!==null&&o!==void 0?o:!0),u.isValid&&(u.isValid=(c=u.containsNonAlphanumericCharacter)!==null&&c!==void 0?c:!0),u}validatePasswordLengthOptions(e,t){let r=this.customStrengthOptions.minPasswordLength,i=this.customStrengthOptions.maxPasswordLength;r&&(t.meetsMinPasswordLength=e.length>=r),i&&(t.meetsMaxPasswordLength=e.length<=i)}validatePasswordCharacterOptions(e,t){this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);let r;for(let i=0;i<e.length;i++)r=e.charAt(i),this.updatePasswordCharacterOptionsStatuses(t,r>="a"&&r<="z",r>="A"&&r<="Z",r>="0"&&r<="9",this.allowedNonAlphanumericCharacters.includes(r))}updatePasswordCharacterOptionsStatuses(e,t,r,i,s){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=r)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=i)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=s))}};var jl=class{constructor(e,t,r,i){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=r,this.config=i,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new fa(this),this.idTokenSubscription=new fa(this),this.beforeStateQueue=new Bl(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=zy,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=i.sdkClientVersion,this._persistenceManagerAvailable=new Promise(s=>this._resolvePersistenceManagerAvailable=s)}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=jt(t)),this._initializationPromise=this.queue(()=>y(this,null,function*(){var r,i,s;if(!this._deleted&&(this.persistenceManager=yield da.create(this,e),(r=this._resolvePersistenceManagerAvailable)===null||r===void 0||r.call(this),!this._deleted)){if(!((i=this._popupRedirectResolver)===null||i===void 0)&&i._shouldInitProactively)try{yield this._popupRedirectResolver._initialize(this)}catch{}yield this.initializeCurrentUser(t),this.lastNotifiedUid=((s=this.currentUser)===null||s===void 0?void 0:s.uid)||null,!this._deleted&&(this._isInitialized=!0)}})),this._initializationPromise}_onStorageEvent(){return y(this,null,function*(){if(this._deleted)return;let e=yield this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),yield this.currentUser.getIdToken();return}yield this._updateCurrentUser(e,!0)}})}initializeCurrentUserFromIdToken(e){return y(this,null,function*(){try{let t=yield la(this,{idToken:e}),r=yield _n._fromGetAccountInfoResponse(this,t,e);yield this.directlySetCurrentUser(r)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),yield this.directlySetCurrentUser(null)}})}initializeCurrentUser(e){return y(this,null,function*(){var t;if(xe(this.app)){let o=this.app.settings.authIdToken;return o?new Promise(c=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(o).then(c,c))}):this.directlySetCurrentUser(null)}let r=yield this.assertedPersistence.getCurrentUser(),i=r,s=!1;if(e&&this.config.authDomain){yield this.getOrInitRedirectPersistenceManager();let o=(t=this.redirectUser)===null||t===void 0?void 0:t._redirectEventId,c=i?._redirectEventId,u=yield this.tryRedirectSignIn(e);(!o||o===c)&&u?.user&&(i=u.user,s=!0)}if(!i)return this.directlySetCurrentUser(null);if(!i._redirectEventId){if(s)try{yield this.beforeStateQueue.runMiddleware(i)}catch(o){i=r,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(o))}return i?this.reloadAndSetCurrentUserOrClear(i):this.directlySetCurrentUser(null)}return B(this._popupRedirectResolver,this,"argument-error"),yield this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===i._redirectEventId?this.directlySetCurrentUser(i):this.reloadAndSetCurrentUserOrClear(i)})}tryRedirectSignIn(e){return y(this,null,function*(){let t=null;try{t=yield this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{yield this._setRedirectUser(null)}return t})}reloadAndSetCurrentUserOrClear(e){return y(this,null,function*(){try{yield ha(e)}catch(t){if(t?.code!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)})}useDeviceLanguage(){this.languageCode=TS()}_delete(){return y(this,null,function*(){this._deleted=!0})}updateCurrentUser(e){return y(this,null,function*(){if(xe(this.app))return Promise.reject(Et(this));let t=e?fe(e):null;return t&&B(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))})}_updateCurrentUser(e,t=!1){return y(this,null,function*(){if(!this._deleted)return e&&B(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||(yield this.beforeStateQueue.runMiddleware(e)),this.queue(()=>y(this,null,function*(){yield this.directlySetCurrentUser(e),this.notifyAuthListeners()}))})}signOut(){return y(this,null,function*(){return xe(this.app)?Promise.reject(Et(this)):(yield this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&(yield this._setRedirectUser(null)),this._updateCurrentUser(null,!0))})}setPersistence(e){return xe(this.app)?Promise.reject(Et(this)):this.queue(()=>y(this,null,function*(){yield this.assertedPersistence.setPersistence(jt(e))}))}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}validatePassword(e){return y(this,null,function*(){this._getPasswordPolicyInternal()||(yield this._updatePasswordPolicy());let t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)})}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}_updatePasswordPolicy(){return y(this,null,function*(){let e=yield VS(this),t=new $l(e);this.tenantId===null?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t})}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new ut("auth","Firebase",e())}onAuthStateChanged(e,t,r){return this.registerStateListener(this.authStateSubscription,e,t,r)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,r){return this.registerStateListener(this.idTokenSubscription,e,t,r)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{let r=this.onAuthStateChanged(()=>{r(),e()},t)}})}revokeAccessToken(e){return y(this,null,function*(){if(this.currentUser){let t=yield this.currentUser.getIdToken(),r={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:t};this.tenantId!=null&&(r.tenantId=this.tenantId),yield OS(this,r)}})}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)===null||e===void 0?void 0:e.toJSON()}}_setRedirectUser(e,t){return y(this,null,function*(){let r=yield this.getOrInitRedirectPersistenceManager(t);return e===null?r.removeCurrentUser():r.setCurrentUser(e)})}getOrInitRedirectPersistenceManager(e){return y(this,null,function*(){if(!this.redirectPersistenceManager){let t=e&&jt(e)||this._popupRedirectResolver;B(t,this,"argument-error"),this.redirectPersistenceManager=yield da.create(this,[jt(t._redirectPersistence)],"redirectUser"),this.redirectUser=yield this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager})}_redirectUserForId(e){return y(this,null,function*(){var t,r;return this._isInitialized&&(yield this.queue(()=>y(this,null,function*(){}))),((t=this._currentUser)===null||t===void 0?void 0:t._redirectEventId)===e?this._currentUser:((r=this.redirectUser)===null||r===void 0?void 0:r._redirectEventId)===e?this.redirectUser:null})}_persistUserIfCurrent(e){return y(this,null,function*(){if(e===this.currentUser)return this.queue(()=>y(this,null,function*(){return this.directlySetCurrentUser(e)}))})}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,t;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);let r=(t=(e=this.currentUser)===null||e===void 0?void 0:e.uid)!==null&&t!==void 0?t:null;this.lastNotifiedUid!==r&&(this.lastNotifiedUid=r,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,r,i){if(this._deleted)return()=>{};let s=typeof t=="function"?t:t.next.bind(t),o=!1,c=this._isInitialized?Promise.resolve():this._initializationPromise;if(B(c,this,"internal-error"),c.then(()=>{o||s(this.currentUser)}),typeof t=="function"){let u=e.addObserver(t,r,i);return()=>{o=!0,u()}}else{let u=e.addObserver(t);return()=>{o=!0,u()}}}directlySetCurrentUser(e){return y(this,null,function*(){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?yield this.assertedPersistence.setCurrentUser(e):yield this.assertedPersistence.removeCurrentUser()})}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return B(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=n_(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}_getAdditionalHeaders(){return y(this,null,function*(){var e;let t={"X-Client-Version":this.clientVersion};this.app.options.appId&&(t["X-Firebase-gmpid"]=this.app.options.appId);let r=yield(e=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getHeartbeatsHeader();r&&(t["X-Firebase-Client"]=r);let i=yield this._getAppCheckToken();return i&&(t["X-Firebase-AppCheck"]=i),t})}_getAppCheckToken(){return y(this,null,function*(){var e;if(xe(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;let t=yield(e=this.appCheckServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getToken();return t?.error&&vS(`Error while retrieving App Check token: ${t.error}`),t?.token})}};function Ht(n){return fe(n)}var fa=class{constructor(e){this.auth=e,this.observer=null,this.addObserver=ly(t=>this.observer=t)}get next(){return B(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}};var Ea={loadJS(){return y(this,null,function*(){throw new Error("Unable to load external scripts")})},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function US(n){Ea=n}function r_(n){return Ea.loadJS(n)}function BS(){return Ea.recaptchaEnterpriseScript}function $S(){return Ea.gapiScript}function i_(n){return`__${n}${Math.floor(Math.random()*1e6)}`}var ql=class{constructor(){this.enterprise=new zl}ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}},zl=class{ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}};var jS="recaptcha-enterprise",s_="NO_RECAPTCHA",Hl=class{constructor(e){this.type=jS,this.auth=Ht(e)}verify(e="verify",t=!1){return y(this,null,function*(){function r(s){return y(this,null,function*(){if(!t){if(s.tenantId==null&&s._agentRecaptchaConfig!=null)return s._agentRecaptchaConfig.siteKey;if(s.tenantId!=null&&s._tenantRecaptchaConfigs[s.tenantId]!==void 0)return s._tenantRecaptchaConfigs[s.tenantId].siteKey}return new Promise((o,c)=>y(null,null,function*(){CS(s,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(u=>{if(u.recaptchaKey===void 0)c(new Error("recaptcha Enterprise site key undefined"));else{let h=new Vl(u);return s.tenantId==null?s._agentRecaptchaConfig=h:s._tenantRecaptchaConfigs[s.tenantId]=h,o(h.siteKey)}}).catch(u=>{c(u)})}))})}function i(s,o,c){let u=window.grecaptcha;Cy(u)?u.enterprise.ready(()=>{u.enterprise.execute(s,{action:e}).then(h=>{o(h)}).catch(()=>{o(s_)})}):c(Error("No reCAPTCHA enterprise script loaded."))}return this.auth.settings.appVerificationDisabledForTesting?new ql().execute("siteKey",{action:"verify"}):new Promise((s,o)=>{r(this.auth).then(c=>{if(!t&&Cy(window.grecaptcha))i(c,s,o);else{if(typeof window>"u"){o(new Error("RecaptchaVerifier is only supported in browser"));return}let u=BS();u.length!==0&&(u+=c),r_(u).then(()=>{i(c,s,o)}).catch(h=>{o(h)})}}).catch(c=>{o(c)})})})}};function hs(n,e,t,r=!1,i=!1){return y(this,null,function*(){let s=new Hl(n),o;if(i)o=s_;else try{o=yield s.verify(t)}catch{o=yield s.verify(t,!0)}let c=Object.assign({},e);if(t==="mfaSmsEnrollment"||t==="mfaSmsSignIn"){if("phoneEnrollmentInfo"in c){let u=c.phoneEnrollmentInfo.phoneNumber,h=c.phoneEnrollmentInfo.recaptchaToken;Object.assign(c,{phoneEnrollmentInfo:{phoneNumber:u,recaptchaToken:h,captchaResponse:o,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in c){let u=c.phoneSignInInfo.recaptchaToken;Object.assign(c,{phoneSignInInfo:{recaptchaToken:u,captchaResponse:o,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return c}return r?Object.assign(c,{captchaResp:o}):Object.assign(c,{captchaResponse:o}),Object.assign(c,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(c,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),c})}function Wl(n,e,t,r,i){return y(this,null,function*(){var s,o;if(i==="EMAIL_PASSWORD_PROVIDER")if(!((s=n._getRecaptchaConfig())===null||s===void 0)&&s.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){let c=yield hs(n,e,t,t==="getOobCode");return r(n,c)}else return r(n,e).catch(c=>y(null,null,function*(){if(c.code==="auth/missing-recaptcha-token"){console.log(`${t} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);let u=yield hs(n,e,t,t==="getOobCode");return r(n,u)}else return Promise.reject(c)}));else if(i==="PHONE_PROVIDER")if(!((o=n._getRecaptchaConfig())===null||o===void 0)&&o.isProviderEnabled("PHONE_PROVIDER")){let c=yield hs(n,e,t);return r(n,c).catch(u=>y(null,null,function*(){var h;if(((h=n._getRecaptchaConfig())===null||h===void 0?void 0:h.getProviderEnforcementState("PHONE_PROVIDER"))==="AUDIT"&&(u.code==="auth/missing-recaptcha-token"||u.code==="auth/invalid-app-credential")){console.log(`Failed to verify with reCAPTCHA Enterprise. Automatically triggering the reCAPTCHA v2 flow to complete the ${t} flow.`);let f=yield hs(n,e,t,!1,!0);return r(n,f)}return Promise.reject(u)}))}else{let c=yield hs(n,e,t,!1,!0);return r(n,c)}else return Promise.reject(i+" provider is not supported.")})}function ah(n,e){let t=Mr(n,"auth");if(t.isInitialized()){let i=t.getImmediate(),s=t.getOptions();if(lt(s,e??{}))return i;tt(i,"already-initialized")}return t.initialize({options:e})}function qS(n,e){let t=e?.persistence||[],r=(Array.isArray(t)?t:[t]).map(jt);e?.errorMap&&n._updateErrorMap(e.errorMap),n._initializeWithPersistence(r,e?.popupRedirectResolver)}function ch(n,e,t){let r=Ht(n);B(/^https?:\/\//.test(e),r,"invalid-emulator-scheme");let i=!!t?.disableWarnings,s=o_(e),{host:o,port:c}=zS(e),u=c===null?"":`:${c}`,h={url:`${s}//${o}${u}/`},f=Object.freeze({host:o,port:c,protocol:s.replace(":",""),options:Object.freeze({disableWarnings:i})});if(!r._canInitEmulator){B(r.config.emulator&&r.emulatorConfig,r,"emulator-config-failed"),B(lt(h,r.config.emulator)&&lt(f,r.emulatorConfig),r,"emulator-config-failed");return}r.config.emulator=h,r.emulatorConfig=f,r.settings.appVerificationDisabledForTesting=!0,Hn(o)?(Jo(`${s}//${o}${u}`),Xo("Auth",!0)):i||HS()}function o_(n){let e=n.indexOf(":");return e<0?"":n.substr(0,e+1)}function zS(n){let e=o_(n),t=/(\/\/)?([^?#/]+)/.exec(n.substr(e.length));if(!t)return{host:"",port:null};let r=t[2].split("@").pop()||"",i=/^(\[[^\]]+\])(:|$)/.exec(r);if(i){let s=i[1];return{host:s,port:Ny(r.substr(s.length+1))}}else{let[s,o]=r.split(":");return{host:s,port:Ny(o)}}}function Ny(n){if(!n)return null;let e=Number(n);return isNaN(e)?null:e}function HS(){function n(){let e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",n):n())}var Br=class{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return $t("not implemented")}_getIdTokenResponse(e){return $t("not implemented")}_linkToIdToken(e,t){return $t("not implemented")}_getReauthenticationResolver(e){return $t("not implemented")}};function WS(n,e){return y(this,null,function*(){return zt(n,"POST","/v1/accounts:signUp",e)})}function GS(n,e){return y(this,null,function*(){return _s(n,"POST","/v1/accounts:signInWithPassword",In(n,e))})}function KS(n,e){return y(this,null,function*(){return _s(n,"POST","/v1/accounts:signInWithEmailLink",In(n,e))})}function QS(n,e){return y(this,null,function*(){return _s(n,"POST","/v1/accounts:signInWithEmailLink",In(n,e))})}var gs=class n extends Br{constructor(e,t,r,i=null){super("password",r),this._email=e,this._password=t,this._tenantId=i}static _fromEmailAndPassword(e,t){return new n(e,t,"password")}static _fromEmailAndCode(e,t,r=null){return new n(e,t,"emailLink",r)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){let t=typeof e=="string"?JSON.parse(e):e;if(t?.email&&t?.password){if(t.signInMethod==="password")return this._fromEmailAndPassword(t.email,t.password);if(t.signInMethod==="emailLink")return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}_getIdTokenResponse(e){return y(this,null,function*(){switch(this.signInMethod){case"password":let t={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Wl(e,t,"signInWithPassword",GS,"EMAIL_PASSWORD_PROVIDER");case"emailLink":return KS(e,{email:this._email,oobCode:this._password});default:tt(e,"internal-error")}})}_linkToIdToken(e,t){return y(this,null,function*(){switch(this.signInMethod){case"password":let r={idToken:t,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Wl(e,r,"signUpPassword",WS,"EMAIL_PASSWORD_PROVIDER");case"emailLink":return QS(e,{idToken:t,email:this._email,oobCode:this._password});default:tt(e,"internal-error")}})}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}};function Fr(n,e){return y(this,null,function*(){return _s(n,"POST","/v1/accounts:signInWithIdp",In(n,e))})}var YS="http://localhost",pa=class n extends Br{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){let t=new n(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):tt("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){let t=typeof e=="string"?JSON.parse(e):e,{providerId:r,signInMethod:i}=t,s=co(t,["providerId","signInMethod"]);if(!r||!i)return null;let o=new n(r,i);return o.idToken=s.idToken||void 0,o.accessToken=s.accessToken||void 0,o.secret=s.secret,o.nonce=s.nonce,o.pendingToken=s.pendingToken||null,o}_getIdTokenResponse(e){let t=this.buildRequest();return Fr(e,t)}_linkToIdToken(e,t){let r=this.buildRequest();return r.idToken=t,Fr(e,r)}_getReauthenticationResolver(e){let t=this.buildRequest();return t.autoCreate=!1,Fr(e,t)}buildRequest(){let e={requestUri:YS,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{let t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=Nr(t)}return e}};function JS(n){switch(n){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function XS(n){let e=Or(xr(n)).link,t=e?Or(xr(e)).deep_link_id:null,r=Or(xr(n)).deep_link_id;return(r?Or(xr(r)).link:null)||r||t||e||n}var ga=class n{constructor(e){var t,r,i,s,o,c;let u=Or(xr(e)),h=(t=u.apiKey)!==null&&t!==void 0?t:null,f=(r=u.oobCode)!==null&&r!==void 0?r:null,g=JS((i=u.mode)!==null&&i!==void 0?i:null);B(h&&f&&g,"argument-error"),this.apiKey=h,this.operation=g,this.code=f,this.continueUrl=(s=u.continueUrl)!==null&&s!==void 0?s:null,this.languageCode=(o=u.lang)!==null&&o!==void 0?o:null,this.tenantId=(c=u.tenantId)!==null&&c!==void 0?c:null}static parseLink(e){let t=XS(e);try{return new n(t)}catch{return null}}};var a_=(()=>{class n{constructor(){this.providerId=n.PROVIDER_ID}static credential(t,r){return gs._fromEmailAndPassword(t,r)}static credentialWithLink(t,r){let i=ga.parseLink(r);return B(i,"argument-error"),gs._fromEmailAndCode(t,i.code,i.tenantId)}}n.PROVIDER_ID="password",n.EMAIL_PASSWORD_SIGN_IN_METHOD="password",n.EMAIL_LINK_SIGN_IN_METHOD="emailLink";return n})(),ms=class{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}};var ma=class extends ms{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}};var ZS=(()=>{class n extends ma{constructor(){super("google.com"),this.addScope("profile")}static credential(t,r){return pa._fromParams({providerId:n.PROVIDER_ID,signInMethod:n.GOOGLE_SIGN_IN_METHOD,idToken:t,accessToken:r})}static credentialFromResult(t){return n.credentialFromTaggedObject(t)}static credentialFromError(t){return n.credentialFromTaggedObject(t.customData||{})}static credentialFromTaggedObject({_tokenResponse:t}){if(!t)return null;let{oauthIdToken:r,oauthAccessToken:i}=t;if(!r&&!i)return null;try{return n.credential(r,i)}catch{return null}}}n.GOOGLE_SIGN_IN_METHOD="google.com",n.PROVIDER_ID="google.com";return n})();function c_(n,e){return y(this,null,function*(){return _s(n,"POST","/v1/accounts:signUp",In(n,e))})}var vn=class n{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static _fromIdTokenResponse(e,t,r,i=!1){return y(this,null,function*(){let s=yield _n._fromIdTokenResponse(e,r,i),o=Oy(r);return new n({user:s,providerId:o,_tokenResponse:r,operationType:t})})}static _forOperation(e,t,r){return y(this,null,function*(){yield e._updateTokensIfNecessary(r,!0);let i=Oy(r);return new n({user:e,providerId:i,_tokenResponse:r,operationType:t})})}};function Oy(n){return n.providerId?n.providerId:"phoneNumber"in n?"phone":null}function u_(n){return y(this,null,function*(){var e;if(xe(n.app))return Promise.reject(Et(n));let t=Ht(n);if(yield t._initializationPromise,!((e=t.currentUser)===null||e===void 0)&&e.isAnonymous)return new vn({user:t.currentUser,providerId:null,operationType:"signIn"});let r=yield c_(t,{returnSecureToken:!0}),i=yield vn._fromIdTokenResponse(t,"signIn",r,!0);return yield t._updateCurrentUser(i.user),i})}var Gl=class n extends Ye{constructor(e,t,r,i){var s;super(t.code,t.message),this.operationType=r,this.user=i,Object.setPrototypeOf(this,n.prototype),this.customData={appName:e.name,tenantId:(s=e.tenantId)!==null&&s!==void 0?s:void 0,_serverResponse:t.customData._serverResponse,operationType:r}}static _fromErrorAndOperation(e,t,r,i){return new n(e,t,r,i)}};function l_(n,e,t,r){return(e==="reauthenticate"?t._getReauthenticationResolver(n):t._getIdTokenResponse(n)).catch(s=>{throw s.code==="auth/multi-factor-auth-required"?Gl._fromErrorAndOperation(n,s,e,r):s})}function eb(n,e,t=!1){return y(this,null,function*(){let r=yield Ur(n,e._linkToIdToken(n.auth,yield n.getIdToken()),t);return vn._forOperation(n,"link",r)})}function tb(n,e,t=!1){return y(this,null,function*(){let{auth:r}=n;if(xe(r.app))return Promise.reject(Et(r));let i="reauthenticate";try{let s=yield Ur(n,l_(r,i,e,n),t);B(s.idToken,r,"internal-error");let o=ih(s.idToken);B(o,r,"internal-error");let{sub:c}=o;return B(n.uid===c,r,"user-mismatch"),vn._forOperation(n,i,s)}catch(s){throw s?.code==="auth/user-not-found"&&tt(r,"user-mismatch"),s}})}function h_(n,e,t=!1){return y(this,null,function*(){if(xe(n.app))return Promise.reject(Et(n));let r="signIn",i=yield l_(n,r,e),s=yield vn._fromIdTokenResponse(n,r,i);return t||(yield n._updateCurrentUser(s.user)),s})}function uh(n,e){return y(this,null,function*(){return h_(Ht(n),e)})}function d_(n){return y(this,null,function*(){let e=Ht(n);e._getPasswordPolicyInternal()&&(yield e._updatePasswordPolicy())})}function lh(n,e,t){return y(this,null,function*(){if(xe(n.app))return Promise.reject(Et(n));let r=Ht(n),o=yield Wl(r,{returnSecureToken:!0,email:e,password:t,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",c_,"EMAIL_PASSWORD_PROVIDER").catch(u=>{throw u.code==="auth/password-does-not-meet-requirements"&&d_(n),u}),c=yield vn._fromIdTokenResponse(r,"signIn",o);return yield r._updateCurrentUser(c.user),c})}function hh(n,e,t){return xe(n.app)?Promise.reject(Et(n)):uh(fe(n),a_.credential(e,t)).catch(r=>y(null,null,function*(){throw r.code==="auth/password-does-not-meet-requirements"&&d_(n),r}))}function nb(n,e){return y(this,null,function*(){return zt(n,"POST","/v1/accounts:update",e)})}function dh(r,i){return y(this,arguments,function*(n,{displayName:e,photoURL:t}){if(e===void 0&&t===void 0)return;let s=fe(n),c={idToken:yield s.getIdToken(),displayName:e,photoUrl:t,returnSecureToken:!0},u=yield Ur(s,nb(s.auth,c));s.displayName=u.displayName||null,s.photoURL=u.photoUrl||null;let h=s.providerData.find(({providerId:f})=>f==="password");h&&(h.displayName=s.displayName,h.photoURL=s.photoURL),yield s._updateTokensIfNecessary(u)})}function fh(n,e,t,r){return fe(n).onIdTokenChanged(e,t,r)}function ph(n,e,t){return fe(n).beforeAuthStateChanged(e,t)}function gh(n,e,t,r){return fe(n).onAuthStateChanged(e,t,r)}var ya="__sak";var _a=class{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(ya,"1"),this.storage.removeItem(ya),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){let t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}};var rb=1e3,ib=10,sb=(()=>{class n extends _a{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(t,r)=>this.onStorageEvent(t,r),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=t_(),this._shouldAllowMigration=!0}forAllChangedKeys(t){for(let r of Object.keys(this.listeners)){let i=this.storage.getItem(r),s=this.localCache[r];i!==s&&t(r,s,i)}}onStorageEvent(t,r=!1){if(!t.key){this.forAllChangedKeys((c,u,h)=>{this.notifyListeners(c,h)});return}let i=t.key;r?this.detachListener():this.stopPolling();let s=()=>{let c=this.storage.getItem(i);!r&&this.localCache[i]===c||this.notifyListeners(i,c)},o=this.storage.getItem(i);LS()&&o!==t.newValue&&t.newValue!==t.oldValue?setTimeout(s,ib):s()}notifyListeners(t,r){this.localCache[t]=r;let i=this.listeners[t];if(i)for(let s of Array.from(i))s(r&&JSON.parse(r))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((t,r,i)=>{this.onStorageEvent(new StorageEvent("storage",{key:t,oldValue:r,newValue:i}),!0)})},rb)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(t,r){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[t]||(this.listeners[t]=new Set,this.localCache[t]=this.storage.getItem(t)),this.listeners[t].add(r)}_removeListener(t,r){this.listeners[t]&&(this.listeners[t].delete(r),this.listeners[t].size===0&&delete this.listeners[t]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}_set(t,r){return y(this,null,function*(){yield rn(n.prototype,this,"_set").call(this,t,r),this.localCache[t]=JSON.stringify(r)})}_get(t){return y(this,null,function*(){let r=yield rn(n.prototype,this,"_get").call(this,t);return this.localCache[t]=JSON.stringify(r),r})}_remove(t){return y(this,null,function*(){yield rn(n.prototype,this,"_remove").call(this,t),delete this.localCache[t]})}}return n.type="LOCAL",n})(),f_=sb;var ob=(()=>{class n extends _a{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(t,r){}_removeListener(t,r){}}return n.type="SESSION",n})(),mh=ob;function ab(n){return Promise.all(n.map(e=>y(null,null,function*(){try{return{fulfilled:!0,value:yield e}}catch(t){return{fulfilled:!1,reason:t}}})))}var cb=(()=>{class n{constructor(t){this.eventTarget=t,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(t){let r=this.receivers.find(s=>s.isListeningto(t));if(r)return r;let i=new n(t);return this.receivers.push(i),i}isListeningto(t){return this.eventTarget===t}handleEvent(t){return y(this,null,function*(){let r=t,{eventId:i,eventType:s,data:o}=r.data,c=this.handlersMap[s];if(!c?.size)return;r.ports[0].postMessage({status:"ack",eventId:i,eventType:s});let u=Array.from(c).map(f=>y(this,null,function*(){return f(r.origin,o)})),h=yield ab(u);r.ports[0].postMessage({status:"done",eventId:i,eventType:s,response:h})})}_subscribe(t,r){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[t]||(this.handlersMap[t]=new Set),this.handlersMap[t].add(r)}_unsubscribe(t,r){this.handlersMap[t]&&r&&this.handlersMap[t].delete(r),(!r||this.handlersMap[t].size===0)&&delete this.handlersMap[t],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}n.receivers=[];return n})();function yh(n="",e=10){let t="";for(let r=0;r<e;r++)t+=Math.floor(Math.random()*10);return n+t}var Kl=class{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}_send(e,t,r=50){return y(this,null,function*(){let i=typeof MessageChannel<"u"?new MessageChannel:null;if(!i)throw new Error("connection_unavailable");let s,o;return new Promise((c,u)=>{let h=yh("",20);i.port1.start();let f=setTimeout(()=>{u(new Error("unsupported_event"))},r);o={messageChannel:i,onMessage(g){let _=g;if(_.data.eventId===h)switch(_.data.status){case"ack":clearTimeout(f),s=setTimeout(()=>{u(new Error("timeout"))},3e3);break;case"done":clearTimeout(s),c(_.data.response);break;default:clearTimeout(f),clearTimeout(s),u(new Error("invalid_response"));break}}},this.handlers.add(o),i.port1.addEventListener("message",o.onMessage),this.target.postMessage({eventType:e,eventId:h,data:t},[i.port2])}).finally(()=>{o&&this.removeMessageHandler(o)})})}};function Tt(){return window}function ub(n){Tt().location.href=n}function p_(){return typeof Tt().WorkerGlobalScope<"u"&&typeof Tt().importScripts=="function"}function lb(){return y(this,null,function*(){if(!navigator?.serviceWorker)return null;try{return(yield navigator.serviceWorker.ready).active}catch{return null}})}function hb(){var n;return((n=navigator?.serviceWorker)===null||n===void 0?void 0:n.controller)||null}function db(){return p_()?self:null}var g_="firebaseLocalStorageDb",fb=1,va="firebaseLocalStorage",m_="fbase_key",Jn=class{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}};function Ta(n,e){return n.transaction([va],e?"readwrite":"readonly").objectStore(va)}function pb(){let n=indexedDB.deleteDatabase(g_);return new Jn(n).toPromise()}function Ql(){let n=indexedDB.open(g_,fb);return new Promise((e,t)=>{n.addEventListener("error",()=>{t(n.error)}),n.addEventListener("upgradeneeded",()=>{let r=n.result;try{r.createObjectStore(va,{keyPath:m_})}catch(i){t(i)}}),n.addEventListener("success",()=>y(null,null,function*(){let r=n.result;r.objectStoreNames.contains(va)?e(r):(r.close(),yield pb(),e(yield Ql()))}))})}function xy(n,e,t){return y(this,null,function*(){let r=Ta(n,!0).put({[m_]:e,value:t});return new Jn(r).toPromise()})}function gb(n,e){return y(this,null,function*(){let t=Ta(n,!1).get(e),r=yield new Jn(t).toPromise();return r===void 0?null:r.value})}function My(n,e){let t=Ta(n,!0).delete(e);return new Jn(t).toPromise()}var mb=800,yb=3,_b=(()=>{class n{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}_openDb(){return y(this,null,function*(){return this.db?this.db:(this.db=yield Ql(),this.db)})}_withRetries(t){return y(this,null,function*(){let r=0;for(;;)try{let i=yield this._openDb();return yield t(i)}catch(i){if(r++>yb)throw i;this.db&&(this.db.close(),this.db=void 0)}})}initializeServiceWorkerMessaging(){return y(this,null,function*(){return p_()?this.initializeReceiver():this.initializeSender()})}initializeReceiver(){return y(this,null,function*(){this.receiver=cb._getInstance(db()),this.receiver._subscribe("keyChanged",(t,r)=>y(this,null,function*(){return{keyProcessed:(yield this._poll()).includes(r.key)}})),this.receiver._subscribe("ping",(t,r)=>y(this,null,function*(){return["keyChanged"]}))})}initializeSender(){return y(this,null,function*(){var t,r;if(this.activeServiceWorker=yield lb(),!this.activeServiceWorker)return;this.sender=new Kl(this.activeServiceWorker);let i=yield this.sender._send("ping",{},800);i&&!((t=i[0])===null||t===void 0)&&t.fulfilled&&!((r=i[0])===null||r===void 0)&&r.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)})}notifyServiceWorker(t){return y(this,null,function*(){if(!(!this.sender||!this.activeServiceWorker||hb()!==this.activeServiceWorker))try{yield this.sender._send("keyChanged",{key:t},this.serviceWorkerReceiverAvailable?800:50)}catch{}})}_isAvailable(){return y(this,null,function*(){try{if(!indexedDB)return!1;let t=yield Ql();return yield xy(t,ya,"1"),yield My(t,ya),!0}catch{}return!1})}_withPendingWrite(t){return y(this,null,function*(){this.pendingWrites++;try{yield t()}finally{this.pendingWrites--}})}_set(t,r){return y(this,null,function*(){return this._withPendingWrite(()=>y(this,null,function*(){return yield this._withRetries(i=>xy(i,t,r)),this.localCache[t]=r,this.notifyServiceWorker(t)}))})}_get(t){return y(this,null,function*(){let r=yield this._withRetries(i=>gb(i,t));return this.localCache[t]=r,r})}_remove(t){return y(this,null,function*(){return this._withPendingWrite(()=>y(this,null,function*(){return yield this._withRetries(r=>My(r,t)),delete this.localCache[t],this.notifyServiceWorker(t)}))})}_poll(){return y(this,null,function*(){let t=yield this._withRetries(s=>{let o=Ta(s,!1).getAll();return new Jn(o).toPromise()});if(!t)return[];if(this.pendingWrites!==0)return[];let r=[],i=new Set;if(t.length!==0)for(let{fbase_key:s,value:o}of t)i.add(s),JSON.stringify(this.localCache[s])!==JSON.stringify(o)&&(this.notifyListeners(s,o),r.push(s));for(let s of Object.keys(this.localCache))this.localCache[s]&&!i.has(s)&&(this.notifyListeners(s,null),r.push(s));return r})}notifyListeners(t,r){this.localCache[t]=r;let i=this.listeners[t];if(i)for(let s of Array.from(i))s(r)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>y(this,null,function*(){return this._poll()}),mb)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(t,r){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[t]||(this.listeners[t]=new Set,this._get(t)),this.listeners[t].add(r)}_removeListener(t,r){this.listeners[t]&&(this.listeners[t].delete(r),this.listeners[t].size===0&&delete this.listeners[t]),Object.keys(this.listeners).length===0&&this.stopPolling()}}return n.type="LOCAL",n})(),y_=_b;var PN=i_("rcb"),DN=new Yn(3e4,6e4);function __(n,e){return e?jt(e):(B(n._popupRedirectResolver,n,"argument-error"),n._popupRedirectResolver)}var ys=class extends Br{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return Fr(e,this._buildIdpRequest())}_linkToIdToken(e,t){return Fr(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return Fr(e,this._buildIdpRequest())}_buildIdpRequest(e){let t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}};function vb(n){return h_(n.auth,new ys(n),n.bypassAuthState)}function Ib(n){let{auth:e,user:t}=n;return B(t,e,"internal-error"),tb(t,new ys(n),n.bypassAuthState)}function wb(n){return y(this,null,function*(){let{auth:e,user:t}=n;return B(t,e,"internal-error"),eb(t,new ys(n),n.bypassAuthState)})}var Ia=class{constructor(e,t,r,i,s=!1){this.auth=e,this.resolver=r,this.user=i,this.bypassAuthState=s,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise((e,t)=>y(this,null,function*(){this.pendingPromise={resolve:e,reject:t};try{this.eventManager=yield this.resolver._initialize(this.auth),yield this.onExecution(),this.eventManager.registerConsumer(this)}catch(r){this.reject(r)}}))}onAuthEvent(e){return y(this,null,function*(){let{urlResponse:t,sessionId:r,postBody:i,tenantId:s,error:o,type:c}=e;if(o){this.reject(o);return}let u={auth:this.auth,requestUri:t,sessionId:r,tenantId:s||void 0,postBody:i||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(yield this.getIdpTask(c)(u))}catch(h){this.reject(h)}})}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return vb;case"linkViaPopup":case"linkViaRedirect":return wb;case"reauthViaPopup":case"reauthViaRedirect":return Ib;default:tt(this.auth,"internal-error")}}resolve(e){qt(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){qt(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}};var Eb=new Yn(2e3,1e4);function v_(n,e,t){return y(this,null,function*(){if(xe(n.app))return Promise.reject(dt(n,"operation-not-supported-in-this-environment"));let r=Ht(n);IS(n,e,ms);let i=__(r,t);return new Tb(r,"signInViaPopup",e,i).executeNotNull()})}var Tb=(()=>{class n extends Ia{constructor(t,r,i,s,o){super(t,r,s,o),this.provider=i,this.authWindow=null,this.pollId=null,n.currentPopupAction&&n.currentPopupAction.cancel(),n.currentPopupAction=this}executeNotNull(){return y(this,null,function*(){let t=yield this.execute();return B(t,this.auth,"internal-error"),t})}onExecution(){return y(this,null,function*(){qt(this.filter.length===1,"Popup operations only handle one event");let t=yh();this.authWindow=yield this.resolver._openPopup(this.auth,this.provider,this.filter[0],t),this.authWindow.associatedEvent=t,this.resolver._originValidation(this.auth).catch(r=>{this.reject(r)}),this.resolver._isIframeWebStorageSupported(this.auth,r=>{r||this.reject(dt(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()})}get eventId(){var t;return((t=this.authWindow)===null||t===void 0?void 0:t.associatedEvent)||null}cancel(){this.reject(dt(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,n.currentPopupAction=null}pollUserCancellation(){let t=()=>{var r,i;if(!((i=(r=this.authWindow)===null||r===void 0?void 0:r.window)===null||i===void 0)&&i.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(dt(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(t,Eb.get())};t()}}n.currentPopupAction=null;return n})(),Ab="pendingRedirect",oa=new Map,Yl=class n extends Ia{constructor(e,t,r=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,r),this.eventId=null}execute(){return y(this,null,function*(){let e=oa.get(this.auth._key());if(!e){try{let r=(yield Sb(this.resolver,this.auth))?yield rn(n.prototype,this,"execute").call(this):null;e=()=>Promise.resolve(r)}catch(t){e=()=>Promise.reject(t)}oa.set(this.auth._key(),e)}return this.bypassAuthState||oa.set(this.auth._key(),()=>Promise.resolve(null)),e()})}onAuthEvent(e){return y(this,null,function*(){if(e.type==="signInViaRedirect")return rn(n.prototype,this,"onAuthEvent").call(this,e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){let t=yield this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,rn(n.prototype,this,"onAuthEvent").call(this,e);this.resolve(null)}})}onExecution(){return y(this,null,function*(){})}cleanUp(){}};function Sb(n,e){return y(this,null,function*(){let t=Cb(e),r=Rb(n);if(!(yield r._isAvailable()))return!1;let i=(yield r._get(t))==="true";return yield r._remove(t),i})}function bb(n,e){oa.set(n._key(),e)}function Rb(n){return jt(n._redirectPersistence)}function Cb(n){return sa(Ab,n.config.apiKey,n.name)}function Pb(n,e,t=!1){return y(this,null,function*(){if(xe(n.app))return Promise.reject(Et(n));let r=Ht(n),i=__(r,e),o=yield new Yl(r,i,t).execute();return o&&!t&&(delete o.user._redirectEventId,yield r._persistUserIfCurrent(o.user),yield r._setRedirectUser(null,e)),o})}var Db=10*60*1e3,Jl=class{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(r=>{this.isEventForConsumer(e,r)&&(t=!0,this.sendToConsumer(e,r),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!kb(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){var r;if(e.error&&!I_(e)){let i=((r=e.error.code)===null||r===void 0?void 0:r.split("auth/")[1])||"internal-error";t.onError(dt(this.auth,i))}else t.onAuthEvent(e)}isEventForConsumer(e,t){let r=t.eventId===null||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&r}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=Db&&this.cachedEventUids.clear(),this.cachedEventUids.has(Ly(e))}saveEventToCache(e){this.cachedEventUids.add(Ly(e)),this.lastProcessedEventTime=Date.now()}};function Ly(n){return[n.type,n.eventId,n.sessionId,n.tenantId].filter(e=>e).join("-")}function I_({type:n,error:e}){return n==="unknown"&&e?.code==="auth/no-auth-event"}function kb(n){switch(n.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return I_(n);default:return!1}}function Nb(t){return y(this,arguments,function*(n,e={}){return zt(n,"GET","/v1/projects",e)})}var Ob=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,xb=/^https?/;function Mb(n){return y(this,null,function*(){if(n.config.emulator)return;let{authorizedDomains:e}=yield Nb(n);for(let t of e)try{if(Lb(t))return}catch{}tt(n,"unauthorized-domain")})}function Lb(n){let e=Ml(),{protocol:t,hostname:r}=new URL(e);if(n.startsWith("chrome-extension://")){let o=new URL(n);return o.hostname===""&&r===""?t==="chrome-extension:"&&n.replace("chrome-extension://","")===e.replace("chrome-extension://",""):t==="chrome-extension:"&&o.hostname===r}if(!xb.test(t))return!1;if(Ob.test(n))return r===n;let i=n.replace(/\./g,"\\.");return new RegExp("^(.+\\."+i+"|"+i+")$","i").test(r)}var Vb=new Yn(3e4,6e4);function Vy(){let n=Tt().___jsl;if(n?.H){for(let e of Object.keys(n.H))if(n.H[e].r=n.H[e].r||[],n.H[e].L=n.H[e].L||[],n.H[e].r=[...n.H[e].L],n.CP)for(let t=0;t<n.CP.length;t++)n.CP[t]=null}}function Fb(n){return new Promise((e,t)=>{var r,i,s;function o(){Vy(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{Vy(),t(dt(n,"network-request-failed"))},timeout:Vb.get()})}if(!((i=(r=Tt().gapi)===null||r===void 0?void 0:r.iframes)===null||i===void 0)&&i.Iframe)e(gapi.iframes.getContext());else if(!((s=Tt().gapi)===null||s===void 0)&&s.load)o();else{let c=i_("iframefcb");return Tt()[c]=()=>{gapi.load?o():t(dt(n,"network-request-failed"))},r_(`${$S()}?onload=${c}`).catch(u=>t(u))}}).catch(e=>{throw aa=null,e})}var aa=null;function Ub(n){return aa=aa||Fb(n),aa}var Bb=new Yn(5e3,15e3),$b="__/auth/iframe",jb="emulator/auth/iframe",qb={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},zb=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function Hb(n){let e=n.config;B(e.authDomain,n,"auth-domain-config-required");let t=e.emulator?nh(e,jb):`https://${n.config.authDomain}/${$b}`,r={apiKey:e.apiKey,appName:n.name,v:pn},i=zb.get(n.config.apiHost);i&&(r.eid=i);let s=n._getFrameworks();return s.length&&(r.fw=s.join(",")),`${t}?${Nr(r).slice(1)}`}function Wb(n){return y(this,null,function*(){let e=yield Ub(n),t=Tt().gapi;return B(t,n,"internal-error"),e.open({where:document.body,url:Hb(n),messageHandlersFilter:t.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:qb,dontclear:!0},r=>new Promise((i,s)=>y(null,null,function*(){yield r.restyle({setHideOnLeave:!1});let o=dt(n,"network-request-failed"),c=Tt().setTimeout(()=>{s(o)},Bb.get());function u(){Tt().clearTimeout(c),i(r)}r.ping(u).then(u,()=>{s(o)})})))})}var Gb={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},Kb=500,Qb=600,Yb="_blank",Jb="http://localhost",wa=class{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}};function Xb(n,e,t,r=Kb,i=Qb){let s=Math.max((window.screen.availHeight-i)/2,0).toString(),o=Math.max((window.screen.availWidth-r)/2,0).toString(),c="",u=Object.assign(Object.assign({},Gb),{width:r.toString(),height:i.toString(),top:s,left:o}),h=we().toLowerCase();t&&(c=Yy(h)?Yb:t),Ky(h)&&(e=e||Jb,u.scrollbars="yes");let f=Object.entries(u).reduce((_,[b,P])=>`${_}${b}=${P},`,"");if(MS(h)&&c!=="_self")return Zb(e||"",c),new wa(null);let g=window.open(e||"",c,f);B(g,n,"popup-blocked");try{g.focus()}catch{}return new wa(g)}function Zb(n,e){let t=document.createElement("a");t.href=n,t.target=e;let r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),t.dispatchEvent(r)}var eR="__/auth/handler",tR="emulator/auth/handler",nR=encodeURIComponent("fac");function Fy(n,e,t,r,i,s){return y(this,null,function*(){B(n.config.authDomain,n,"auth-domain-config-required"),B(n.config.apiKey,n,"invalid-api-key");let o={apiKey:n.config.apiKey,appName:n.name,authType:t,redirectUrl:r,v:pn,eventId:i};if(e instanceof ms){e.setDefaultLanguage(n.languageCode),o.providerId=e.providerId||"",uy(e.getCustomParameters())||(o.customParameters=JSON.stringify(e.getCustomParameters()));for(let[f,g]of Object.entries(s||{}))o[f]=g}if(e instanceof ma){let f=e.getScopes().filter(g=>g!=="");f.length>0&&(o.scopes=f.join(","))}n.tenantId&&(o.tid=n.tenantId);let c=o;for(let f of Object.keys(c))c[f]===void 0&&delete c[f];let u=yield n._getAppCheckToken(),h=u?`#${nR}=${encodeURIComponent(u)}`:"";return`${rR(n)}?${Nr(c).slice(1)}${h}`})}function rR({config:n}){return n.emulator?nh(n,tR):`https://${n.authDomain}/${eR}`}var xl="webStorageSupport",Xl=class{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=mh,this._completeRedirectFn=Pb,this._overrideRedirectResult=bb}_openPopup(e,t,r,i){return y(this,null,function*(){var s;qt((s=this.eventManagers[e._key()])===null||s===void 0?void 0:s.manager,"_initialize() not called before _openPopup()");let o=yield Fy(e,t,r,Ml(),i);return Xb(e,o,yh())})}_openRedirect(e,t,r,i){return y(this,null,function*(){yield this._originValidation(e);let s=yield Fy(e,t,r,Ml(),i);return ub(s),new Promise(()=>{})})}_initialize(e){let t=e._key();if(this.eventManagers[t]){let{manager:i,promise:s}=this.eventManagers[t];return i?Promise.resolve(i):(qt(s,"If manager is not set, promise should be"),s)}let r=this.initAndGetManager(e);return this.eventManagers[t]={promise:r},r.catch(()=>{delete this.eventManagers[t]}),r}initAndGetManager(e){return y(this,null,function*(){let t=yield Wb(e),r=new Jl(e);return t.register("authEvent",i=>(B(i?.authEvent,e,"invalid-auth-event"),{status:r.onEvent(i.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:r},this.iframes[e._key()]=t,r})}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(xl,{type:xl},i=>{var s;let o=(s=i?.[0])===null||s===void 0?void 0:s[xl];o!==void 0&&t(!!o),tt(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){let t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=Mb(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return t_()||Qy()||oh()}},w_=Xl;var Uy="@firebase/auth",By="1.10.6";var Zl=class{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)===null||e===void 0?void 0:e.uid)||null}getToken(e){return y(this,null,function*(){return this.assertAuthConfigured(),yield this.auth._initializationPromise,this.auth.currentUser?{accessToken:yield this.auth.currentUser.getIdToken(e)}:null})}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;let t=this.auth.onIdTokenChanged(r=>{e(r?.stsTokenManager.accessToken||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();let t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){B(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}};function iR(n){switch(n){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function sR(n){ht(new je("auth",(e,{options:t})=>{let r=e.getProvider("app").getImmediate(),i=e.getProvider("heartbeat"),s=e.getProvider("app-check-internal"),{apiKey:o,authDomain:c}=r.options;B(o&&!o.includes(":"),"invalid-api-key",{appName:r.name});let u={apiKey:o,authDomain:c,clientPlatform:n,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:n_(n)},h=new jl(r,i,s,u);return qS(h,t),h},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,r)=>{e.getProvider("auth-internal").initialize()})),ht(new je("auth-internal",e=>{let t=Ht(e.getProvider("auth").getImmediate());return(r=>new Zl(r))(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),pe(Uy,By,iR(n)),pe(Uy,By,"esm2017")}var oR=5*60,aR=ml("authIdTokenMaxAge")||oR,$y=null,cR=n=>e=>y(null,null,function*(){let t=e&&(yield e.getIdTokenResult()),r=t&&(new Date().getTime()-Date.parse(t.issuedAtTime))/1e3;if(r&&r>aR)return;let i=t?.token;$y!==i&&($y=i,yield fetch(n,{method:i?"POST":"DELETE",headers:i?{Authorization:`Bearer ${i}`}:{}}))});function _h(n=Gn()){let e=Mr(n,"auth");if(e.isInitialized())return e.getImmediate();let t=ah(n,{popupRedirectResolver:w_,persistence:[y_,f_,mh]}),r=ml("authTokenSyncURL");if(r&&typeof isSecureContext=="boolean"&&isSecureContext){let s=new URL(r,location.origin);if(location.origin===s.origin){let o=cR(s.toString());ph(t,o,()=>o(t.currentUser)),fh(t,c=>o(c))}}let i=pl("auth");return i&&ch(t,`http://${i}`),t}function uR(){var n,e;return(e=(n=document.getElementsByTagName("head"))===null||n===void 0?void 0:n[0])!==null&&e!==void 0?e:document}US({loadJS(n){return new Promise((e,t)=>{let r=document.createElement("script");r.setAttribute("src",n),r.onload=e,r.onerror=i=>{let s=dt("internal-error");s.customData=i,t(s)},r.type="text/javascript",r.charset="UTF-8",uR().appendChild(r)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});sR("Browser");var QR=new Map,YR={activated:!1,tokenObservers:[]},JR={initialized:!1,enabled:!1};function ft(n){return QR.get(n)||Object.assign({},YR)}function S_(){return JR}var XR="https://content-firebaseappcheck.googleapis.com/v1";var ZR="exchangeDebugToken",E_={OFFSET_DURATION:5*60*1e3,RETRIAL_MIN_WAIT:30*1e3,RETRIAL_MAX_WAIT:16*60*1e3},fO=24*60*60*1e3;var wh=class{constructor(e,t,r,i,s){if(this.operation=e,this.retryPolicy=t,this.getWaitDuration=r,this.lowerBound=i,this.upperBound=s,this.pending=null,this.nextErrorWaitInterval=i,i>s)throw new Error("Proactive refresh lower bound greater than upper bound!")}start(){this.nextErrorWaitInterval=this.lowerBound,this.process(!0).catch(()=>{})}stop(){this.pending&&(this.pending.reject("cancelled"),this.pending=null)}isRunning(){return!!this.pending}process(e){return y(this,null,function*(){this.stop();try{this.pending=new zn,this.pending.promise.catch(t=>{}),yield e0(this.getNextRun(e)),this.pending.resolve(),yield this.pending.promise,this.pending=new zn,this.pending.promise.catch(t=>{}),yield this.operation(),this.pending.resolve(),yield this.pending.promise,this.process(!0).catch(()=>{})}catch(t){this.retryPolicy(t)?this.process(!1).catch(()=>{}):this.stop()}})}getNextRun(e){if(e)return this.nextErrorWaitInterval=this.lowerBound,this.getWaitDuration();{let t=this.nextErrorWaitInterval;return this.nextErrorWaitInterval*=2,this.nextErrorWaitInterval>this.upperBound&&(this.nextErrorWaitInterval=this.upperBound),t}}};function e0(n){return new Promise(e=>{setTimeout(e,n)})}var t0={"already-initialized":"You have already called initializeAppCheck() for FirebaseApp {$appName} with different options. To avoid this error, call initializeAppCheck() with the same options as when it was originally called. This will return the already initialized instance.","use-before-activation":"App Check is being used before initializeAppCheck() is called for FirebaseApp {$appName}. Call initializeAppCheck() before instantiating other Firebase services.","fetch-network-error":"Fetch failed to connect to a network. Check Internet connection. Original error: {$originalErrorMessage}.","fetch-parse-error":"Fetch client could not parse response. Original error: {$originalErrorMessage}.","fetch-status-error":"Fetch server returned an HTTP error status. HTTP status: {$httpStatus}.","storage-open":"Error thrown when opening storage. Original error: {$originalErrorMessage}.","storage-get":"Error thrown when reading from storage. Original error: {$originalErrorMessage}.","storage-set":"Error thrown when writing to storage. Original error: {$originalErrorMessage}.","recaptcha-error":"ReCAPTCHA error.","initial-throttle":"{$httpStatus} error. Attempts allowed again after {$time}",throttled:"Requests throttled due to previous {$httpStatus} error. Attempts allowed again after {$time}"},wn=new ut("appCheck","AppCheck",t0);function b_(n){if(!ft(n).activated)throw wn.create("use-before-activation",{appName:n.name})}function R_(r,i){return y(this,arguments,function*({url:n,body:e},t){let s={"Content-Type":"application/json"},o=t.getImmediate({optional:!0});if(o){let b=yield o.getHeartbeatsHeader();b&&(s["X-Firebase-Client"]=b)}let c={method:"POST",body:JSON.stringify(e),headers:s},u;try{u=yield fetch(n,c)}catch(b){throw wn.create("fetch-network-error",{originalErrorMessage:b?.message})}if(u.status!==200)throw wn.create("fetch-status-error",{httpStatus:u.status});let h;try{h=yield u.json()}catch(b){throw wn.create("fetch-parse-error",{originalErrorMessage:b?.message})}let f=h.ttl.match(/^([\d.]+)(s)$/);if(!f||!f[2]||isNaN(Number(f[1])))throw wn.create("fetch-parse-error",{originalErrorMessage:`ttl field (timeToLive) is not in standard Protobuf Duration format: ${h.ttl}`});let g=Number(f[1])*1e3,_=Date.now();return{token:h.token,expireTimeMillis:_+g,issuedAtTimeMillis:_}})}function C_(n,e){let{projectId:t,appId:r,apiKey:i}=n.options;return{url:`${XR}/projects/${t}/apps/${r}:${ZR}?key=${i}`,body:{debug_token:e}}}var n0="firebase-app-check-database",r0=1,Eh="firebase-app-check-store";var Aa=null;function i0(){return Aa||(Aa=new Promise((n,e)=>{try{let t=indexedDB.open(n0,r0);t.onsuccess=r=>{n(r.target.result)},t.onerror=r=>{var i;e(wn.create("storage-open",{originalErrorMessage:(i=r.target.error)===null||i===void 0?void 0:i.message}))},t.onupgradeneeded=r=>{let i=r.target.result;switch(r.oldVersion){case 0:i.createObjectStore(Eh,{keyPath:"compositeKey"})}}}catch(t){e(wn.create("storage-open",{originalErrorMessage:t?.message}))}}),Aa)}function s0(n,e){return o0(a0(n),e)}function o0(n,e){return y(this,null,function*(){let r=(yield i0()).transaction(Eh,"readwrite"),s=r.objectStore(Eh).put({compositeKey:n,value:e});return new Promise((o,c)=>{s.onsuccess=u=>{o()},r.onerror=u=>{var h;c(wn.create("storage-set",{originalErrorMessage:(h=u.target.error)===null||h===void 0?void 0:h.message}))}})})}function a0(n){return`${n.options.appId}-${n.name}`}var vs=new It("@firebase/app-check");function vh(n,e){return as()?s0(n,e).catch(t=>{vs.warn(`Failed to write token to IndexedDB. Error: ${t}`)}):Promise.resolve()}function P_(){return S_().enabled}function D_(){return y(this,null,function*(){let n=S_();if(n.enabled&&n.token)return n.token.promise;throw Error(`
            Can't get debug token in production mode.
        `)})}var c0={error:"UNKNOWN_ERROR"};function u0(n){return Ko.encodeString(JSON.stringify(n),!1)}function Th(n,e=!1,t=!1){return y(this,null,function*(){let r=n.app;b_(r);let i=ft(r),s=i.token,o;if(s&&!Is(s)&&(i.token=void 0,s=void 0),!s){let h=yield i.cachedTokenPromise;h&&(Is(h)?s=h:yield vh(r,void 0))}if(!e&&s&&Is(s))return{token:s.token};let c=!1;if(P_())try{i.exchangeTokenPromise||(i.exchangeTokenPromise=R_(C_(r,yield D_()),n.heartbeatServiceProvider).finally(()=>{i.exchangeTokenPromise=void 0}),c=!0);let h=yield i.exchangeTokenPromise;return yield vh(r,h),i.token=h,{token:h.token}}catch(h){return h.code==="appCheck/throttled"||h.code==="appCheck/initial-throttle"?vs.warn(h.message):t&&vs.error(h),Ih(h)}try{i.exchangeTokenPromise||(i.exchangeTokenPromise=i.provider.getToken().finally(()=>{i.exchangeTokenPromise=void 0}),c=!0),s=yield ft(r).exchangeTokenPromise}catch(h){h.code==="appCheck/throttled"||h.code==="appCheck/initial-throttle"?vs.warn(h.message):t&&vs.error(h),o=h}let u;return s?o?Is(s)?u={token:s.token,internalError:o}:u=Ih(o):(u={token:s.token},i.token=s,yield vh(r,s)):u=Ih(o),c&&f0(r,u),u})}function l0(n){return y(this,null,function*(){let e=n.app;b_(e);let{provider:t}=ft(e);if(P_()){let r=yield D_(),{token:i}=yield R_(C_(e,r),n.heartbeatServiceProvider);return{token:i}}else{let{token:r}=yield t.getToken();return{token:r}}})}function h0(n,e,t,r){let{app:i}=n,s=ft(i),o={next:t,error:r,type:e};if(s.tokenObservers=[...s.tokenObservers,o],s.token&&Is(s.token)){let c=s.token;Promise.resolve().then(()=>{t({token:c.token}),T_(n)}).catch(()=>{})}s.cachedTokenPromise.then(()=>T_(n))}function k_(n,e){let t=ft(n),r=t.tokenObservers.filter(i=>i.next!==e);r.length===0&&t.tokenRefresher&&t.tokenRefresher.isRunning()&&t.tokenRefresher.stop(),t.tokenObservers=r}function T_(n){let{app:e}=n,t=ft(e),r=t.tokenRefresher;r||(r=d0(n),t.tokenRefresher=r),!r.isRunning()&&t.isTokenAutoRefreshEnabled&&r.start()}function d0(n){let{app:e}=n;return new wh(()=>y(null,null,function*(){let t=ft(e),r;if(t.token?r=yield Th(n,!0):r=yield Th(n),r.error)throw r.error;if(r.internalError)throw r.internalError}),()=>!0,()=>{let t=ft(e);if(t.token){let r=t.token.issuedAtTimeMillis+(t.token.expireTimeMillis-t.token.issuedAtTimeMillis)*.5+3e5,i=t.token.expireTimeMillis-5*60*1e3;return r=Math.min(r,i),Math.max(0,r-Date.now())}else return 0},E_.RETRIAL_MIN_WAIT,E_.RETRIAL_MAX_WAIT)}function f0(n,e){let t=ft(n).tokenObservers;for(let r of t)try{r.type==="EXTERNAL"&&e.error!=null?r.error(e.error):r.next(e)}catch{}}function Is(n){return n.expireTimeMillis-Date.now()>0}function Ih(n){return{token:u0(c0),error:n}}var Ah=class{constructor(e,t){this.app=e,this.heartbeatServiceProvider=t}_delete(){let{tokenObservers:e}=ft(this.app);for(let t of e)k_(this.app,t.next);return Promise.resolve()}};function p0(n,e){return new Ah(n,e)}function g0(n){return{getToken:e=>Th(n,e),getLimitedUseToken:()=>l0(n),addTokenListener:e=>h0(n,"INTERNAL",e),removeTokenListener:e=>k_(n.app,e)}}var m0="@firebase/app-check",y0="0.10.0";var _0="app-check",A_="app-check-internal";function v0(){ht(new je(_0,n=>{let e=n.getProvider("app").getImmediate(),t=n.getProvider("heartbeat");return p0(e,t)},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((n,e,t)=>{n.getProvider(A_).initialize()})),ht(new je(A_,n=>{let e=n.getProvider("app-check").getImmediate();return g0(e)},"PUBLIC").setInstantiationMode("EXPLICIT")),pe(m0,y0)}v0();var I0="app-check";var $r=class{constructor(){return Vr(I0)}};var w0=["localhost","0.0.0.0","127.0.0.1"],bO=typeof window<"u"&&w0.includes(window.location.hostname);var N_="auth",ws=class{constructor(e){return e}},Es=class{constructor(){return Vr(N_)}};var Sh=new ue("angularfire2.auth-instances");function E0(n,e){let t=ls(N_,n,e);return t&&new ws(t)}function T0(n){return(e,t)=>{let r=e.runOutsideAngular(()=>n(t));return new ws(r)}}var A0={provide:Es,deps:[[new Ze,Sh]]},S0={provide:ws,useFactory:E0,deps:[[new Ze,Sh],Bt]};function LO(n,...e){return pe("angularfire",gn.full,"auth"),an([S0,A0,{provide:Sh,useFactory:T0(n),multi:!0,deps:[Ie,et,mn,Qn,[new Ze,$r],...e]}])}var VO=Ee(lh,!0,2);var FO=Ee(_h,!0);var UO=Ee(gh,!0);var BO=Ee(hh,!0,2);var $O=Ee(dh,!0,2);var O_=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},x_={};var Wt,bh;(function(){var n;function e(E,m){function I(){}I.prototype=m.prototype,E.D=m.prototype,E.prototype=new I,E.prototype.constructor=E,E.C=function(w,T,S){for(var v=Array(arguments.length-2),Nt=2;Nt<arguments.length;Nt++)v[Nt-2]=arguments[Nt];return m.prototype[T].apply(w,v)}}function t(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(r,t),r.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function i(E,m,I){I||(I=0);var w=Array(16);if(typeof m=="string")for(var T=0;16>T;++T)w[T]=m.charCodeAt(I++)|m.charCodeAt(I++)<<8|m.charCodeAt(I++)<<16|m.charCodeAt(I++)<<24;else for(T=0;16>T;++T)w[T]=m[I++]|m[I++]<<8|m[I++]<<16|m[I++]<<24;m=E.g[0],I=E.g[1],T=E.g[2];var S=E.g[3],v=m+(S^I&(T^S))+w[0]+3614090360&4294967295;m=I+(v<<7&4294967295|v>>>25),v=S+(T^m&(I^T))+w[1]+3905402710&4294967295,S=m+(v<<12&4294967295|v>>>20),v=T+(I^S&(m^I))+w[2]+606105819&4294967295,T=S+(v<<17&4294967295|v>>>15),v=I+(m^T&(S^m))+w[3]+3250441966&4294967295,I=T+(v<<22&4294967295|v>>>10),v=m+(S^I&(T^S))+w[4]+4118548399&4294967295,m=I+(v<<7&4294967295|v>>>25),v=S+(T^m&(I^T))+w[5]+1200080426&4294967295,S=m+(v<<12&4294967295|v>>>20),v=T+(I^S&(m^I))+w[6]+2821735955&4294967295,T=S+(v<<17&4294967295|v>>>15),v=I+(m^T&(S^m))+w[7]+4249261313&4294967295,I=T+(v<<22&4294967295|v>>>10),v=m+(S^I&(T^S))+w[8]+1770035416&4294967295,m=I+(v<<7&4294967295|v>>>25),v=S+(T^m&(I^T))+w[9]+2336552879&4294967295,S=m+(v<<12&4294967295|v>>>20),v=T+(I^S&(m^I))+w[10]+4294925233&4294967295,T=S+(v<<17&4294967295|v>>>15),v=I+(m^T&(S^m))+w[11]+2304563134&4294967295,I=T+(v<<22&4294967295|v>>>10),v=m+(S^I&(T^S))+w[12]+1804603682&4294967295,m=I+(v<<7&4294967295|v>>>25),v=S+(T^m&(I^T))+w[13]+4254626195&4294967295,S=m+(v<<12&4294967295|v>>>20),v=T+(I^S&(m^I))+w[14]+2792965006&4294967295,T=S+(v<<17&4294967295|v>>>15),v=I+(m^T&(S^m))+w[15]+1236535329&4294967295,I=T+(v<<22&4294967295|v>>>10),v=m+(T^S&(I^T))+w[1]+4129170786&4294967295,m=I+(v<<5&4294967295|v>>>27),v=S+(I^T&(m^I))+w[6]+3225465664&4294967295,S=m+(v<<9&4294967295|v>>>23),v=T+(m^I&(S^m))+w[11]+643717713&4294967295,T=S+(v<<14&4294967295|v>>>18),v=I+(S^m&(T^S))+w[0]+3921069994&4294967295,I=T+(v<<20&4294967295|v>>>12),v=m+(T^S&(I^T))+w[5]+3593408605&4294967295,m=I+(v<<5&4294967295|v>>>27),v=S+(I^T&(m^I))+w[10]+38016083&4294967295,S=m+(v<<9&4294967295|v>>>23),v=T+(m^I&(S^m))+w[15]+3634488961&4294967295,T=S+(v<<14&4294967295|v>>>18),v=I+(S^m&(T^S))+w[4]+3889429448&4294967295,I=T+(v<<20&4294967295|v>>>12),v=m+(T^S&(I^T))+w[9]+568446438&4294967295,m=I+(v<<5&4294967295|v>>>27),v=S+(I^T&(m^I))+w[14]+3275163606&4294967295,S=m+(v<<9&4294967295|v>>>23),v=T+(m^I&(S^m))+w[3]+4107603335&4294967295,T=S+(v<<14&4294967295|v>>>18),v=I+(S^m&(T^S))+w[8]+1163531501&4294967295,I=T+(v<<20&4294967295|v>>>12),v=m+(T^S&(I^T))+w[13]+2850285829&4294967295,m=I+(v<<5&4294967295|v>>>27),v=S+(I^T&(m^I))+w[2]+4243563512&4294967295,S=m+(v<<9&4294967295|v>>>23),v=T+(m^I&(S^m))+w[7]+1735328473&4294967295,T=S+(v<<14&4294967295|v>>>18),v=I+(S^m&(T^S))+w[12]+2368359562&4294967295,I=T+(v<<20&4294967295|v>>>12),v=m+(I^T^S)+w[5]+4294588738&4294967295,m=I+(v<<4&4294967295|v>>>28),v=S+(m^I^T)+w[8]+2272392833&4294967295,S=m+(v<<11&4294967295|v>>>21),v=T+(S^m^I)+w[11]+1839030562&4294967295,T=S+(v<<16&4294967295|v>>>16),v=I+(T^S^m)+w[14]+4259657740&4294967295,I=T+(v<<23&4294967295|v>>>9),v=m+(I^T^S)+w[1]+2763975236&4294967295,m=I+(v<<4&4294967295|v>>>28),v=S+(m^I^T)+w[4]+1272893353&4294967295,S=m+(v<<11&4294967295|v>>>21),v=T+(S^m^I)+w[7]+4139469664&4294967295,T=S+(v<<16&4294967295|v>>>16),v=I+(T^S^m)+w[10]+3200236656&4294967295,I=T+(v<<23&4294967295|v>>>9),v=m+(I^T^S)+w[13]+681279174&4294967295,m=I+(v<<4&4294967295|v>>>28),v=S+(m^I^T)+w[0]+3936430074&4294967295,S=m+(v<<11&4294967295|v>>>21),v=T+(S^m^I)+w[3]+3572445317&4294967295,T=S+(v<<16&4294967295|v>>>16),v=I+(T^S^m)+w[6]+76029189&4294967295,I=T+(v<<23&4294967295|v>>>9),v=m+(I^T^S)+w[9]+3654602809&4294967295,m=I+(v<<4&4294967295|v>>>28),v=S+(m^I^T)+w[12]+3873151461&4294967295,S=m+(v<<11&4294967295|v>>>21),v=T+(S^m^I)+w[15]+530742520&4294967295,T=S+(v<<16&4294967295|v>>>16),v=I+(T^S^m)+w[2]+3299628645&4294967295,I=T+(v<<23&4294967295|v>>>9),v=m+(T^(I|~S))+w[0]+4096336452&4294967295,m=I+(v<<6&4294967295|v>>>26),v=S+(I^(m|~T))+w[7]+1126891415&4294967295,S=m+(v<<10&4294967295|v>>>22),v=T+(m^(S|~I))+w[14]+2878612391&4294967295,T=S+(v<<15&4294967295|v>>>17),v=I+(S^(T|~m))+w[5]+4237533241&4294967295,I=T+(v<<21&4294967295|v>>>11),v=m+(T^(I|~S))+w[12]+1700485571&4294967295,m=I+(v<<6&4294967295|v>>>26),v=S+(I^(m|~T))+w[3]+2399980690&4294967295,S=m+(v<<10&4294967295|v>>>22),v=T+(m^(S|~I))+w[10]+4293915773&4294967295,T=S+(v<<15&4294967295|v>>>17),v=I+(S^(T|~m))+w[1]+2240044497&4294967295,I=T+(v<<21&4294967295|v>>>11),v=m+(T^(I|~S))+w[8]+1873313359&4294967295,m=I+(v<<6&4294967295|v>>>26),v=S+(I^(m|~T))+w[15]+4264355552&4294967295,S=m+(v<<10&4294967295|v>>>22),v=T+(m^(S|~I))+w[6]+2734768916&4294967295,T=S+(v<<15&4294967295|v>>>17),v=I+(S^(T|~m))+w[13]+1309151649&4294967295,I=T+(v<<21&4294967295|v>>>11),v=m+(T^(I|~S))+w[4]+4149444226&4294967295,m=I+(v<<6&4294967295|v>>>26),v=S+(I^(m|~T))+w[11]+3174756917&4294967295,S=m+(v<<10&4294967295|v>>>22),v=T+(m^(S|~I))+w[2]+718787259&4294967295,T=S+(v<<15&4294967295|v>>>17),v=I+(S^(T|~m))+w[9]+3951481745&4294967295,E.g[0]=E.g[0]+m&4294967295,E.g[1]=E.g[1]+(T+(v<<21&4294967295|v>>>11))&4294967295,E.g[2]=E.g[2]+T&4294967295,E.g[3]=E.g[3]+S&4294967295}r.prototype.u=function(E,m){m===void 0&&(m=E.length);for(var I=m-this.blockSize,w=this.B,T=this.h,S=0;S<m;){if(T==0)for(;S<=I;)i(this,E,S),S+=this.blockSize;if(typeof E=="string"){for(;S<m;)if(w[T++]=E.charCodeAt(S++),T==this.blockSize){i(this,w),T=0;break}}else for(;S<m;)if(w[T++]=E[S++],T==this.blockSize){i(this,w),T=0;break}}this.h=T,this.o+=m},r.prototype.v=function(){var E=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);E[0]=128;for(var m=1;m<E.length-8;++m)E[m]=0;var I=8*this.o;for(m=E.length-8;m<E.length;++m)E[m]=I&255,I/=256;for(this.u(E),E=Array(16),m=I=0;4>m;++m)for(var w=0;32>w;w+=8)E[I++]=this.g[m]>>>w&255;return E};function s(E,m){var I=c;return Object.prototype.hasOwnProperty.call(I,E)?I[E]:I[E]=m(E)}function o(E,m){this.h=m;for(var I=[],w=!0,T=E.length-1;0<=T;T--){var S=E[T]|0;w&&S==m||(I[T]=S,w=!1)}this.g=I}var c={};function u(E){return-128<=E&&128>E?s(E,function(m){return new o([m|0],0>m?-1:0)}):new o([E|0],0>E?-1:0)}function h(E){if(isNaN(E)||!isFinite(E))return g;if(0>E)return k(h(-E));for(var m=[],I=1,w=0;E>=I;w++)m[w]=E/I|0,I*=4294967296;return new o(m,0)}function f(E,m){if(E.length==0)throw Error("number format error: empty string");if(m=m||10,2>m||36<m)throw Error("radix out of range: "+m);if(E.charAt(0)=="-")return k(f(E.substring(1),m));if(0<=E.indexOf("-"))throw Error('number format error: interior "-" character');for(var I=h(Math.pow(m,8)),w=g,T=0;T<E.length;T+=8){var S=Math.min(8,E.length-T),v=parseInt(E.substring(T,T+S),m);8>S?(S=h(Math.pow(m,S)),w=w.j(S).add(h(v))):(w=w.j(I),w=w.add(h(v)))}return w}var g=u(0),_=u(1),b=u(16777216);n=o.prototype,n.m=function(){if(O(this))return-k(this).m();for(var E=0,m=1,I=0;I<this.g.length;I++){var w=this.i(I);E+=(0<=w?w:4294967296+w)*m,m*=4294967296}return E},n.toString=function(E){if(E=E||10,2>E||36<E)throw Error("radix out of range: "+E);if(P(this))return"0";if(O(this))return"-"+k(this).toString(E);for(var m=h(Math.pow(E,6)),I=this,w="";;){var T=se(I,m).g;I=z(I,T.j(m));var S=((0<I.g.length?I.g[0]:I.h)>>>0).toString(E);if(I=T,P(I))return S+w;for(;6>S.length;)S="0"+S;w=S+w}},n.i=function(E){return 0>E?0:E<this.g.length?this.g[E]:this.h};function P(E){if(E.h!=0)return!1;for(var m=0;m<E.g.length;m++)if(E.g[m]!=0)return!1;return!0}function O(E){return E.h==-1}n.l=function(E){return E=z(this,E),O(E)?-1:P(E)?0:1};function k(E){for(var m=E.g.length,I=[],w=0;w<m;w++)I[w]=~E.g[w];return new o(I,~E.h).add(_)}n.abs=function(){return O(this)?k(this):this},n.add=function(E){for(var m=Math.max(this.g.length,E.g.length),I=[],w=0,T=0;T<=m;T++){var S=w+(this.i(T)&65535)+(E.i(T)&65535),v=(S>>>16)+(this.i(T)>>>16)+(E.i(T)>>>16);w=v>>>16,S&=65535,v&=65535,I[T]=v<<16|S}return new o(I,I[I.length-1]&-2147483648?-1:0)};function z(E,m){return E.add(k(m))}n.j=function(E){if(P(this)||P(E))return g;if(O(this))return O(E)?k(this).j(k(E)):k(k(this).j(E));if(O(E))return k(this.j(k(E)));if(0>this.l(b)&&0>E.l(b))return h(this.m()*E.m());for(var m=this.g.length+E.g.length,I=[],w=0;w<2*m;w++)I[w]=0;for(w=0;w<this.g.length;w++)for(var T=0;T<E.g.length;T++){var S=this.i(w)>>>16,v=this.i(w)&65535,Nt=E.i(T)>>>16,fi=E.i(T)&65535;I[2*w+2*T]+=v*fi,$(I,2*w+2*T),I[2*w+2*T+1]+=S*fi,$(I,2*w+2*T+1),I[2*w+2*T+1]+=v*Nt,$(I,2*w+2*T+1),I[2*w+2*T+2]+=S*Nt,$(I,2*w+2*T+2)}for(w=0;w<m;w++)I[w]=I[2*w+1]<<16|I[2*w];for(w=m;w<2*m;w++)I[w]=0;return new o(I,0)};function $(E,m){for(;(E[m]&65535)!=E[m];)E[m+1]+=E[m]>>>16,E[m]&=65535,m++}function q(E,m){this.g=E,this.h=m}function se(E,m){if(P(m))throw Error("division by zero");if(P(E))return new q(g,g);if(O(E))return m=se(k(E),m),new q(k(m.g),k(m.h));if(O(m))return m=se(E,k(m)),new q(k(m.g),m.h);if(30<E.g.length){if(O(E)||O(m))throw Error("slowDivide_ only works with positive integers.");for(var I=_,w=m;0>=w.l(E);)I=Fe(I),w=Fe(w);var T=re(I,1),S=re(w,1);for(w=re(w,2),I=re(I,2);!P(w);){var v=S.add(w);0>=v.l(E)&&(T=T.add(I),S=v),w=re(w,1),I=re(I,1)}return m=z(E,T.j(m)),new q(T,m)}for(T=g;0<=E.l(m);){for(I=Math.max(1,Math.floor(E.m()/m.m())),w=Math.ceil(Math.log(I)/Math.LN2),w=48>=w?1:Math.pow(2,w-48),S=h(I),v=S.j(m);O(v)||0<v.l(E);)I-=w,S=h(I),v=S.j(m);P(S)&&(S=_),T=T.add(S),E=z(E,v)}return new q(T,E)}n.A=function(E){return se(this,E).h},n.and=function(E){for(var m=Math.max(this.g.length,E.g.length),I=[],w=0;w<m;w++)I[w]=this.i(w)&E.i(w);return new o(I,this.h&E.h)},n.or=function(E){for(var m=Math.max(this.g.length,E.g.length),I=[],w=0;w<m;w++)I[w]=this.i(w)|E.i(w);return new o(I,this.h|E.h)},n.xor=function(E){for(var m=Math.max(this.g.length,E.g.length),I=[],w=0;w<m;w++)I[w]=this.i(w)^E.i(w);return new o(I,this.h^E.h)};function Fe(E){for(var m=E.g.length+1,I=[],w=0;w<m;w++)I[w]=E.i(w)<<1|E.i(w-1)>>>31;return new o(I,E.h)}function re(E,m){var I=m>>5;m%=32;for(var w=E.g.length-I,T=[],S=0;S<w;S++)T[S]=0<m?E.i(S+I)>>>m|E.i(S+I+1)<<32-m:E.i(S+I);return new o(T,E.h)}r.prototype.digest=r.prototype.v,r.prototype.reset=r.prototype.s,r.prototype.update=r.prototype.u,bh=x_.Md5=r,o.prototype.add=o.prototype.add,o.prototype.multiply=o.prototype.j,o.prototype.modulo=o.prototype.A,o.prototype.compare=o.prototype.l,o.prototype.toNumber=o.prototype.m,o.prototype.toString=o.prototype.toString,o.prototype.getBits=o.prototype.i,o.fromNumber=h,o.fromString=f,Wt=x_.Integer=o}).apply(typeof O_<"u"?O_:typeof self<"u"?self:typeof window<"u"?window:{});var Sa=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},Gt={};var Rh,b0,jr,Ch,Ts,ba,Ph,Dh,kh;(function(){var n,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(a,l,d){return a==Array.prototype||a==Object.prototype||(a[l]=d.value),a};function t(a){a=[typeof globalThis=="object"&&globalThis,a,typeof window=="object"&&window,typeof self=="object"&&self,typeof Sa=="object"&&Sa];for(var l=0;l<a.length;++l){var d=a[l];if(d&&d.Math==Math)return d}throw Error("Cannot find global object")}var r=t(this);function i(a,l){if(l)e:{var d=r;a=a.split(".");for(var p=0;p<a.length-1;p++){var A=a[p];if(!(A in d))break e;d=d[A]}a=a[a.length-1],p=d[a],l=l(p),l!=p&&l!=null&&e(d,a,{configurable:!0,writable:!0,value:l})}}function s(a,l){a instanceof String&&(a+="");var d=0,p=!1,A={next:function(){if(!p&&d<a.length){var R=d++;return{value:l(R,a[R]),done:!1}}return p=!0,{done:!0,value:void 0}}};return A[Symbol.iterator]=function(){return A},A}i("Array.prototype.values",function(a){return a||function(){return s(this,function(l,d){return d})}});var o=o||{},c=this||self;function u(a){var l=typeof a;return l=l!="object"?l:a?Array.isArray(a)?"array":l:"null",l=="array"||l=="object"&&typeof a.length=="number"}function h(a){var l=typeof a;return l=="object"&&a!=null||l=="function"}function f(a,l,d){return a.call.apply(a.bind,arguments)}function g(a,l,d){if(!a)throw Error();if(2<arguments.length){var p=Array.prototype.slice.call(arguments,2);return function(){var A=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(A,p),a.apply(l,A)}}return function(){return a.apply(l,arguments)}}function _(a,l,d){return _=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?f:g,_.apply(null,arguments)}function b(a,l){var d=Array.prototype.slice.call(arguments,1);return function(){var p=d.slice();return p.push.apply(p,arguments),a.apply(this,p)}}function P(a,l){function d(){}d.prototype=l.prototype,a.aa=l.prototype,a.prototype=new d,a.prototype.constructor=a,a.Qb=function(p,A,R){for(var N=Array(arguments.length-2),oe=2;oe<arguments.length;oe++)N[oe-2]=arguments[oe];return l.prototype[A].apply(p,N)}}function O(a){let l=a.length;if(0<l){let d=Array(l);for(let p=0;p<l;p++)d[p]=a[p];return d}return[]}function k(a,l){for(let d=1;d<arguments.length;d++){let p=arguments[d];if(u(p)){let A=a.length||0,R=p.length||0;a.length=A+R;for(let N=0;N<R;N++)a[A+N]=p[N]}else a.push(p)}}class z{constructor(l,d){this.i=l,this.j=d,this.h=0,this.g=null}get(){let l;return 0<this.h?(this.h--,l=this.g,this.g=l.next,l.next=null):l=this.i(),l}}function $(a){return/^[\s\xa0]*$/.test(a)}function q(){var a=c.navigator;return a&&(a=a.userAgent)?a:""}function se(a){return se[" "](a),a}se[" "]=function(){};var Fe=q().indexOf("Gecko")!=-1&&!(q().toLowerCase().indexOf("webkit")!=-1&&q().indexOf("Edge")==-1)&&!(q().indexOf("Trident")!=-1||q().indexOf("MSIE")!=-1)&&q().indexOf("Edge")==-1;function re(a,l,d){for(let p in a)l.call(d,a[p],p,a)}function E(a,l){for(let d in a)l.call(void 0,a[d],d,a)}function m(a){let l={};for(let d in a)l[d]=a[d];return l}let I="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function w(a,l){let d,p;for(let A=1;A<arguments.length;A++){p=arguments[A];for(d in p)a[d]=p[d];for(let R=0;R<I.length;R++)d=I[R],Object.prototype.hasOwnProperty.call(p,d)&&(a[d]=p[d])}}function T(a){var l=1;a=a.split(":");let d=[];for(;0<l&&a.length;)d.push(a.shift()),l--;return a.length&&d.push(a.join(":")),d}function S(a){c.setTimeout(()=>{throw a},0)}function v(){var a=Dc;let l=null;return a.g&&(l=a.g,a.g=a.g.next,a.g||(a.h=null),l.next=null),l}class Nt{constructor(){this.h=this.g=null}add(l,d){let p=fi.get();p.set(l,d),this.h?this.h.next=p:this.g=p,this.h=p}}var fi=new z(()=>new fw,a=>a.reset());class fw{constructor(){this.next=this.g=this.h=null}set(l,d){this.h=l,this.g=d,this.next=null}reset(){this.next=this.g=this.h=null}}let pi,gi=!1,Dc=new Nt,ep=()=>{let a=c.Promise.resolve(void 0);pi=()=>{a.then(pw)}};var pw=()=>{for(var a;a=v();){try{a.h.call(a.g)}catch(d){S(d)}var l=fi;l.j(a),100>l.h&&(l.h++,a.next=l.g,l.g=a)}gi=!1};function Zt(){this.s=this.s,this.C=this.C}Zt.prototype.s=!1,Zt.prototype.ma=function(){this.s||(this.s=!0,this.N())},Zt.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function Ce(a,l){this.type=a,this.g=this.target=l,this.defaultPrevented=!1}Ce.prototype.h=function(){this.defaultPrevented=!0};var gw=function(){if(!c.addEventListener||!Object.defineProperty)return!1;var a=!1,l=Object.defineProperty({},"passive",{get:function(){a=!0}});try{let d=()=>{};c.addEventListener("test",d,l),c.removeEventListener("test",d,l)}catch{}return a}();function mi(a,l){if(Ce.call(this,a?a.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,a){var d=this.type=a.type,p=a.changedTouches&&a.changedTouches.length?a.changedTouches[0]:null;if(this.target=a.target||a.srcElement,this.g=l,l=a.relatedTarget){if(Fe){e:{try{se(l.nodeName);var A=!0;break e}catch{}A=!1}A||(l=null)}}else d=="mouseover"?l=a.fromElement:d=="mouseout"&&(l=a.toElement);this.relatedTarget=l,p?(this.clientX=p.clientX!==void 0?p.clientX:p.pageX,this.clientY=p.clientY!==void 0?p.clientY:p.pageY,this.screenX=p.screenX||0,this.screenY=p.screenY||0):(this.clientX=a.clientX!==void 0?a.clientX:a.pageX,this.clientY=a.clientY!==void 0?a.clientY:a.pageY,this.screenX=a.screenX||0,this.screenY=a.screenY||0),this.button=a.button,this.key=a.key||"",this.ctrlKey=a.ctrlKey,this.altKey=a.altKey,this.shiftKey=a.shiftKey,this.metaKey=a.metaKey,this.pointerId=a.pointerId||0,this.pointerType=typeof a.pointerType=="string"?a.pointerType:mw[a.pointerType]||"",this.state=a.state,this.i=a,a.defaultPrevented&&mi.aa.h.call(this)}}P(mi,Ce);var mw={2:"touch",3:"pen",4:"mouse"};mi.prototype.h=function(){mi.aa.h.call(this);var a=this.i;a.preventDefault?a.preventDefault():a.returnValue=!1};var yi="closure_listenable_"+(1e6*Math.random()|0),yw=0;function _w(a,l,d,p,A){this.listener=a,this.proxy=null,this.src=l,this.type=d,this.capture=!!p,this.ha=A,this.key=++yw,this.da=this.fa=!1}function Hs(a){a.da=!0,a.listener=null,a.proxy=null,a.src=null,a.ha=null}function Ws(a){this.src=a,this.g={},this.h=0}Ws.prototype.add=function(a,l,d,p,A){var R=a.toString();a=this.g[R],a||(a=this.g[R]=[],this.h++);var N=Nc(a,l,p,A);return-1<N?(l=a[N],d||(l.fa=!1)):(l=new _w(l,this.src,R,!!p,A),l.fa=d,a.push(l)),l};function kc(a,l){var d=l.type;if(d in a.g){var p=a.g[d],A=Array.prototype.indexOf.call(p,l,void 0),R;(R=0<=A)&&Array.prototype.splice.call(p,A,1),R&&(Hs(l),a.g[d].length==0&&(delete a.g[d],a.h--))}}function Nc(a,l,d,p){for(var A=0;A<a.length;++A){var R=a[A];if(!R.da&&R.listener==l&&R.capture==!!d&&R.ha==p)return A}return-1}var Oc="closure_lm_"+(1e6*Math.random()|0),xc={};function tp(a,l,d,p,A){if(p&&p.once)return rp(a,l,d,p,A);if(Array.isArray(l)){for(var R=0;R<l.length;R++)tp(a,l[R],d,p,A);return null}return d=Fc(d),a&&a[yi]?a.K(l,d,h(p)?!!p.capture:!!p,A):np(a,l,d,!1,p,A)}function np(a,l,d,p,A,R){if(!l)throw Error("Invalid event type");var N=h(A)?!!A.capture:!!A,oe=Lc(a);if(oe||(a[Oc]=oe=new Ws(a)),d=oe.add(l,d,p,N,R),d.proxy)return d;if(p=vw(),d.proxy=p,p.src=a,p.listener=d,a.addEventListener)gw||(A=N),A===void 0&&(A=!1),a.addEventListener(l.toString(),p,A);else if(a.attachEvent)a.attachEvent(sp(l.toString()),p);else if(a.addListener&&a.removeListener)a.addListener(p);else throw Error("addEventListener and attachEvent are unavailable.");return d}function vw(){function a(d){return l.call(a.src,a.listener,d)}let l=Iw;return a}function rp(a,l,d,p,A){if(Array.isArray(l)){for(var R=0;R<l.length;R++)rp(a,l[R],d,p,A);return null}return d=Fc(d),a&&a[yi]?a.L(l,d,h(p)?!!p.capture:!!p,A):np(a,l,d,!0,p,A)}function ip(a,l,d,p,A){if(Array.isArray(l))for(var R=0;R<l.length;R++)ip(a,l[R],d,p,A);else p=h(p)?!!p.capture:!!p,d=Fc(d),a&&a[yi]?(a=a.i,l=String(l).toString(),l in a.g&&(R=a.g[l],d=Nc(R,d,p,A),-1<d&&(Hs(R[d]),Array.prototype.splice.call(R,d,1),R.length==0&&(delete a.g[l],a.h--)))):a&&(a=Lc(a))&&(l=a.g[l.toString()],a=-1,l&&(a=Nc(l,d,p,A)),(d=-1<a?l[a]:null)&&Mc(d))}function Mc(a){if(typeof a!="number"&&a&&!a.da){var l=a.src;if(l&&l[yi])kc(l.i,a);else{var d=a.type,p=a.proxy;l.removeEventListener?l.removeEventListener(d,p,a.capture):l.detachEvent?l.detachEvent(sp(d),p):l.addListener&&l.removeListener&&l.removeListener(p),(d=Lc(l))?(kc(d,a),d.h==0&&(d.src=null,l[Oc]=null)):Hs(a)}}}function sp(a){return a in xc?xc[a]:xc[a]="on"+a}function Iw(a,l){if(a.da)a=!0;else{l=new mi(l,this);var d=a.listener,p=a.ha||a.src;a.fa&&Mc(a),a=d.call(p,l)}return a}function Lc(a){return a=a[Oc],a instanceof Ws?a:null}var Vc="__closure_events_fn_"+(1e9*Math.random()>>>0);function Fc(a){return typeof a=="function"?a:(a[Vc]||(a[Vc]=function(l){return a.handleEvent(l)}),a[Vc])}function Pe(){Zt.call(this),this.i=new Ws(this),this.M=this,this.F=null}P(Pe,Zt),Pe.prototype[yi]=!0,Pe.prototype.removeEventListener=function(a,l,d,p){ip(this,a,l,d,p)};function Ue(a,l){var d,p=a.F;if(p)for(d=[];p;p=p.F)d.push(p);if(a=a.M,p=l.type||l,typeof l=="string")l=new Ce(l,a);else if(l instanceof Ce)l.target=l.target||a;else{var A=l;l=new Ce(p,a),w(l,A)}if(A=!0,d)for(var R=d.length-1;0<=R;R--){var N=l.g=d[R];A=Gs(N,p,!0,l)&&A}if(N=l.g=a,A=Gs(N,p,!0,l)&&A,A=Gs(N,p,!1,l)&&A,d)for(R=0;R<d.length;R++)N=l.g=d[R],A=Gs(N,p,!1,l)&&A}Pe.prototype.N=function(){if(Pe.aa.N.call(this),this.i){var a=this.i,l;for(l in a.g){for(var d=a.g[l],p=0;p<d.length;p++)Hs(d[p]);delete a.g[l],a.h--}}this.F=null},Pe.prototype.K=function(a,l,d,p){return this.i.add(String(a),l,!1,d,p)},Pe.prototype.L=function(a,l,d,p){return this.i.add(String(a),l,!0,d,p)};function Gs(a,l,d,p){if(l=a.i.g[String(l)],!l)return!0;l=l.concat();for(var A=!0,R=0;R<l.length;++R){var N=l[R];if(N&&!N.da&&N.capture==d){var oe=N.listener,Se=N.ha||N.src;N.fa&&kc(a.i,N),A=oe.call(Se,p)!==!1&&A}}return A&&!p.defaultPrevented}function op(a,l,d){if(typeof a=="function")d&&(a=_(a,d));else if(a&&typeof a.handleEvent=="function")a=_(a.handleEvent,a);else throw Error("Invalid listener argument");return 2147483647<Number(l)?-1:c.setTimeout(a,l||0)}function ap(a){a.g=op(()=>{a.g=null,a.i&&(a.i=!1,ap(a))},a.l);let l=a.h;a.h=null,a.m.apply(null,l)}class ww extends Zt{constructor(l,d){super(),this.m=l,this.l=d,this.h=null,this.i=!1,this.g=null}j(l){this.h=arguments,this.g?this.i=!0:ap(this)}N(){super.N(),this.g&&(c.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function _i(a){Zt.call(this),this.h=a,this.g={}}P(_i,Zt);var cp=[];function up(a){re(a.g,function(l,d){this.g.hasOwnProperty(d)&&Mc(l)},a),a.g={}}_i.prototype.N=function(){_i.aa.N.call(this),up(this)},_i.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var Uc=c.JSON.stringify,Ew=c.JSON.parse,Tw=class{stringify(a){return c.JSON.stringify(a,void 0)}parse(a){return c.JSON.parse(a,void 0)}};function Bc(){}Bc.prototype.h=null;function lp(a){return a.h||(a.h=a.i())}function hp(){}var vi={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function $c(){Ce.call(this,"d")}P($c,Ce);function jc(){Ce.call(this,"c")}P(jc,Ce);var Pn={},dp=null;function Ks(){return dp=dp||new Pe}Pn.La="serverreachability";function fp(a){Ce.call(this,Pn.La,a)}P(fp,Ce);function Ii(a){let l=Ks();Ue(l,new fp(l))}Pn.STAT_EVENT="statevent";function pp(a,l){Ce.call(this,Pn.STAT_EVENT,a),this.stat=l}P(pp,Ce);function Be(a){let l=Ks();Ue(l,new pp(l,a))}Pn.Ma="timingevent";function gp(a,l){Ce.call(this,Pn.Ma,a),this.size=l}P(gp,Ce);function wi(a,l){if(typeof a!="function")throw Error("Fn must not be null and must be a function");return c.setTimeout(function(){a()},l)}function Ei(){this.g=!0}Ei.prototype.xa=function(){this.g=!1};function Aw(a,l,d,p,A,R){a.info(function(){if(a.g)if(R)for(var N="",oe=R.split("&"),Se=0;Se<oe.length;Se++){var X=oe[Se].split("=");if(1<X.length){var De=X[0];X=X[1];var ke=De.split("_");N=2<=ke.length&&ke[1]=="type"?N+(De+"="+X+"&"):N+(De+"=redacted&")}}else N=null;else N=R;return"XMLHTTP REQ ("+p+") [attempt "+A+"]: "+l+`
`+d+`
`+N})}function Sw(a,l,d,p,A,R,N){a.info(function(){return"XMLHTTP RESP ("+p+") [ attempt "+A+"]: "+l+`
`+d+`
`+R+" "+N})}function hr(a,l,d,p){a.info(function(){return"XMLHTTP TEXT ("+l+"): "+Rw(a,d)+(p?" "+p:"")})}function bw(a,l){a.info(function(){return"TIMEOUT: "+l})}Ei.prototype.info=function(){};function Rw(a,l){if(!a.g)return l;if(!l)return null;try{var d=JSON.parse(l);if(d){for(a=0;a<d.length;a++)if(Array.isArray(d[a])){var p=d[a];if(!(2>p.length)){var A=p[1];if(Array.isArray(A)&&!(1>A.length)){var R=A[0];if(R!="noop"&&R!="stop"&&R!="close")for(var N=1;N<A.length;N++)A[N]=""}}}}return Uc(d)}catch{return l}}var Qs={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},mp={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},qc;function Ys(){}P(Ys,Bc),Ys.prototype.g=function(){return new XMLHttpRequest},Ys.prototype.i=function(){return{}},qc=new Ys;function en(a,l,d,p){this.j=a,this.i=l,this.l=d,this.R=p||1,this.U=new _i(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new yp}function yp(){this.i=null,this.g="",this.h=!1}var _p={},zc={};function Hc(a,l,d){a.L=1,a.v=eo(Ot(l)),a.m=d,a.P=!0,vp(a,null)}function vp(a,l){a.F=Date.now(),Js(a),a.A=Ot(a.v);var d=a.A,p=a.R;Array.isArray(p)||(p=[String(p)]),Op(d.i,"t",p),a.C=0,d=a.j.J,a.h=new yp,a.g=Jp(a.j,d?l:null,!a.m),0<a.O&&(a.M=new ww(_(a.Y,a,a.g),a.O)),l=a.U,d=a.g,p=a.ca;var A="readystatechange";Array.isArray(A)||(A&&(cp[0]=A.toString()),A=cp);for(var R=0;R<A.length;R++){var N=tp(d,A[R],p||l.handleEvent,!1,l.h||l);if(!N)break;l.g[N.key]=N}l=a.H?m(a.H):{},a.m?(a.u||(a.u="POST"),l["Content-Type"]="application/x-www-form-urlencoded",a.g.ea(a.A,a.u,a.m,l)):(a.u="GET",a.g.ea(a.A,a.u,null,l)),Ii(),Aw(a.i,a.u,a.A,a.l,a.R,a.m)}en.prototype.ca=function(a){a=a.target;let l=this.M;l&&xt(a)==3?l.j():this.Y(a)},en.prototype.Y=function(a){try{if(a==this.g)e:{let ke=xt(this.g);var l=this.g.Ba();let pr=this.g.Z();if(!(3>ke)&&(ke!=3||this.g&&(this.h.h||this.g.oa()||Bp(this.g)))){this.J||ke!=4||l==7||(l==8||0>=pr?Ii(3):Ii(2)),Wc(this);var d=this.g.Z();this.X=d;t:if(Ip(this)){var p=Bp(this.g);a="";var A=p.length,R=xt(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){Dn(this),Ti(this);var N="";break t}this.h.i=new c.TextDecoder}for(l=0;l<A;l++)this.h.h=!0,a+=this.h.i.decode(p[l],{stream:!(R&&l==A-1)});p.length=0,this.h.g+=a,this.C=0,N=this.h.g}else N=this.g.oa();if(this.o=d==200,Sw(this.i,this.u,this.A,this.l,this.R,ke,d),this.o){if(this.T&&!this.K){t:{if(this.g){var oe,Se=this.g;if((oe=Se.g?Se.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!$(oe)){var X=oe;break t}}X=null}if(d=X)hr(this.i,this.l,d,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,Gc(this,d);else{this.o=!1,this.s=3,Be(12),Dn(this),Ti(this);break e}}if(this.P){d=!0;let st;for(;!this.J&&this.C<N.length;)if(st=Cw(this,N),st==zc){ke==4&&(this.s=4,Be(14),d=!1),hr(this.i,this.l,null,"[Incomplete Response]");break}else if(st==_p){this.s=4,Be(15),hr(this.i,this.l,N,"[Invalid Chunk]"),d=!1;break}else hr(this.i,this.l,st,null),Gc(this,st);if(Ip(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),ke!=4||N.length!=0||this.h.h||(this.s=1,Be(16),d=!1),this.o=this.o&&d,!d)hr(this.i,this.l,N,"[Invalid Chunked Response]"),Dn(this),Ti(this);else if(0<N.length&&!this.W){this.W=!0;var De=this.j;De.g==this&&De.ba&&!De.M&&(De.j.info("Great, no buffering proxy detected. Bytes received: "+N.length),Zc(De),De.M=!0,Be(11))}}else hr(this.i,this.l,N,null),Gc(this,N);ke==4&&Dn(this),this.o&&!this.J&&(ke==4?Gp(this.j,this):(this.o=!1,Js(this)))}else Hw(this.g),d==400&&0<N.indexOf("Unknown SID")?(this.s=3,Be(12)):(this.s=0,Be(13)),Dn(this),Ti(this)}}}catch{}finally{}};function Ip(a){return a.g?a.u=="GET"&&a.L!=2&&a.j.Ca:!1}function Cw(a,l){var d=a.C,p=l.indexOf(`
`,d);return p==-1?zc:(d=Number(l.substring(d,p)),isNaN(d)?_p:(p+=1,p+d>l.length?zc:(l=l.slice(p,p+d),a.C=p+d,l)))}en.prototype.cancel=function(){this.J=!0,Dn(this)};function Js(a){a.S=Date.now()+a.I,wp(a,a.I)}function wp(a,l){if(a.B!=null)throw Error("WatchDog timer not null");a.B=wi(_(a.ba,a),l)}function Wc(a){a.B&&(c.clearTimeout(a.B),a.B=null)}en.prototype.ba=function(){this.B=null;let a=Date.now();0<=a-this.S?(bw(this.i,this.A),this.L!=2&&(Ii(),Be(17)),Dn(this),this.s=2,Ti(this)):wp(this,this.S-a)};function Ti(a){a.j.G==0||a.J||Gp(a.j,a)}function Dn(a){Wc(a);var l=a.M;l&&typeof l.ma=="function"&&l.ma(),a.M=null,up(a.U),a.g&&(l=a.g,a.g=null,l.abort(),l.ma())}function Gc(a,l){try{var d=a.j;if(d.G!=0&&(d.g==a||Kc(d.h,a))){if(!a.K&&Kc(d.h,a)&&d.G==3){try{var p=d.Da.g.parse(l)}catch{p=null}if(Array.isArray(p)&&p.length==3){var A=p;if(A[0]==0){e:if(!d.u){if(d.g)if(d.g.F+3e3<a.F)so(d),ro(d);else break e;Xc(d),Be(18)}}else d.za=A[1],0<d.za-d.T&&37500>A[2]&&d.F&&d.v==0&&!d.C&&(d.C=wi(_(d.Za,d),6e3));if(1>=Ap(d.h)&&d.ca){try{d.ca()}catch{}d.ca=void 0}}else Nn(d,11)}else if((a.K||d.g==a)&&so(d),!$(l))for(A=d.Da.g.parse(l),l=0;l<A.length;l++){let X=A[l];if(d.T=X[0],X=X[1],d.G==2)if(X[0]=="c"){d.K=X[1],d.ia=X[2];let De=X[3];De!=null&&(d.la=De,d.j.info("VER="+d.la));let ke=X[4];ke!=null&&(d.Aa=ke,d.j.info("SVER="+d.Aa));let pr=X[5];pr!=null&&typeof pr=="number"&&0<pr&&(p=1.5*pr,d.L=p,d.j.info("backChannelRequestTimeoutMs_="+p)),p=d;let st=a.g;if(st){let ao=st.g?st.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(ao){var R=p.h;R.g||ao.indexOf("spdy")==-1&&ao.indexOf("quic")==-1&&ao.indexOf("h2")==-1||(R.j=R.l,R.g=new Set,R.h&&(Qc(R,R.h),R.h=null))}if(p.D){let eu=st.g?st.g.getResponseHeader("X-HTTP-Session-Id"):null;eu&&(p.ya=eu,ae(p.I,p.D,eu))}}d.G=3,d.l&&d.l.ua(),d.ba&&(d.R=Date.now()-a.F,d.j.info("Handshake RTT: "+d.R+"ms")),p=d;var N=a;if(p.qa=Yp(p,p.J?p.ia:null,p.W),N.K){Sp(p.h,N);var oe=N,Se=p.L;Se&&(oe.I=Se),oe.B&&(Wc(oe),Js(oe)),p.g=N}else Hp(p);0<d.i.length&&io(d)}else X[0]!="stop"&&X[0]!="close"||Nn(d,7);else d.G==3&&(X[0]=="stop"||X[0]=="close"?X[0]=="stop"?Nn(d,7):Jc(d):X[0]!="noop"&&d.l&&d.l.ta(X),d.v=0)}}Ii(4)}catch{}}var Pw=class{constructor(a,l){this.g=a,this.map=l}};function Ep(a){this.l=a||10,c.PerformanceNavigationTiming?(a=c.performance.getEntriesByType("navigation"),a=0<a.length&&(a[0].nextHopProtocol=="hq"||a[0].nextHopProtocol=="h2")):a=!!(c.chrome&&c.chrome.loadTimes&&c.chrome.loadTimes()&&c.chrome.loadTimes().wasFetchedViaSpdy),this.j=a?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function Tp(a){return a.h?!0:a.g?a.g.size>=a.j:!1}function Ap(a){return a.h?1:a.g?a.g.size:0}function Kc(a,l){return a.h?a.h==l:a.g?a.g.has(l):!1}function Qc(a,l){a.g?a.g.add(l):a.h=l}function Sp(a,l){a.h&&a.h==l?a.h=null:a.g&&a.g.has(l)&&a.g.delete(l)}Ep.prototype.cancel=function(){if(this.i=bp(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(let a of this.g.values())a.cancel();this.g.clear()}};function bp(a){if(a.h!=null)return a.i.concat(a.h.D);if(a.g!=null&&a.g.size!==0){let l=a.i;for(let d of a.g.values())l=l.concat(d.D);return l}return O(a.i)}function Dw(a){if(a.V&&typeof a.V=="function")return a.V();if(typeof Map<"u"&&a instanceof Map||typeof Set<"u"&&a instanceof Set)return Array.from(a.values());if(typeof a=="string")return a.split("");if(u(a)){for(var l=[],d=a.length,p=0;p<d;p++)l.push(a[p]);return l}l=[],d=0;for(p in a)l[d++]=a[p];return l}function kw(a){if(a.na&&typeof a.na=="function")return a.na();if(!a.V||typeof a.V!="function"){if(typeof Map<"u"&&a instanceof Map)return Array.from(a.keys());if(!(typeof Set<"u"&&a instanceof Set)){if(u(a)||typeof a=="string"){var l=[];a=a.length;for(var d=0;d<a;d++)l.push(d);return l}l=[],d=0;for(let p in a)l[d++]=p;return l}}}function Rp(a,l){if(a.forEach&&typeof a.forEach=="function")a.forEach(l,void 0);else if(u(a)||typeof a=="string")Array.prototype.forEach.call(a,l,void 0);else for(var d=kw(a),p=Dw(a),A=p.length,R=0;R<A;R++)l.call(void 0,p[R],d&&d[R],a)}var Cp=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function Nw(a,l){if(a){a=a.split("&");for(var d=0;d<a.length;d++){var p=a[d].indexOf("="),A=null;if(0<=p){var R=a[d].substring(0,p);A=a[d].substring(p+1)}else R=a[d];l(R,A?decodeURIComponent(A.replace(/\+/g," ")):"")}}}function kn(a){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,a instanceof kn){this.h=a.h,Xs(this,a.j),this.o=a.o,this.g=a.g,Zs(this,a.s),this.l=a.l;var l=a.i,d=new bi;d.i=l.i,l.g&&(d.g=new Map(l.g),d.h=l.h),Pp(this,d),this.m=a.m}else a&&(l=String(a).match(Cp))?(this.h=!1,Xs(this,l[1]||"",!0),this.o=Ai(l[2]||""),this.g=Ai(l[3]||"",!0),Zs(this,l[4]),this.l=Ai(l[5]||"",!0),Pp(this,l[6]||"",!0),this.m=Ai(l[7]||"")):(this.h=!1,this.i=new bi(null,this.h))}kn.prototype.toString=function(){var a=[],l=this.j;l&&a.push(Si(l,Dp,!0),":");var d=this.g;return(d||l=="file")&&(a.push("//"),(l=this.o)&&a.push(Si(l,Dp,!0),"@"),a.push(encodeURIComponent(String(d)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),d=this.s,d!=null&&a.push(":",String(d))),(d=this.l)&&(this.g&&d.charAt(0)!="/"&&a.push("/"),a.push(Si(d,d.charAt(0)=="/"?Mw:xw,!0))),(d=this.i.toString())&&a.push("?",d),(d=this.m)&&a.push("#",Si(d,Vw)),a.join("")};function Ot(a){return new kn(a)}function Xs(a,l,d){a.j=d?Ai(l,!0):l,a.j&&(a.j=a.j.replace(/:$/,""))}function Zs(a,l){if(l){if(l=Number(l),isNaN(l)||0>l)throw Error("Bad port number "+l);a.s=l}else a.s=null}function Pp(a,l,d){l instanceof bi?(a.i=l,Fw(a.i,a.h)):(d||(l=Si(l,Lw)),a.i=new bi(l,a.h))}function ae(a,l,d){a.i.set(l,d)}function eo(a){return ae(a,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),a}function Ai(a,l){return a?l?decodeURI(a.replace(/%25/g,"%2525")):decodeURIComponent(a):""}function Si(a,l,d){return typeof a=="string"?(a=encodeURI(a).replace(l,Ow),d&&(a=a.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),a):null}function Ow(a){return a=a.charCodeAt(0),"%"+(a>>4&15).toString(16)+(a&15).toString(16)}var Dp=/[#\/\?@]/g,xw=/[#\?:]/g,Mw=/[#\?]/g,Lw=/[#\?@]/g,Vw=/#/g;function bi(a,l){this.h=this.g=null,this.i=a||null,this.j=!!l}function tn(a){a.g||(a.g=new Map,a.h=0,a.i&&Nw(a.i,function(l,d){a.add(decodeURIComponent(l.replace(/\+/g," ")),d)}))}n=bi.prototype,n.add=function(a,l){tn(this),this.i=null,a=dr(this,a);var d=this.g.get(a);return d||this.g.set(a,d=[]),d.push(l),this.h+=1,this};function kp(a,l){tn(a),l=dr(a,l),a.g.has(l)&&(a.i=null,a.h-=a.g.get(l).length,a.g.delete(l))}function Np(a,l){return tn(a),l=dr(a,l),a.g.has(l)}n.forEach=function(a,l){tn(this),this.g.forEach(function(d,p){d.forEach(function(A){a.call(l,A,p,this)},this)},this)},n.na=function(){tn(this);let a=Array.from(this.g.values()),l=Array.from(this.g.keys()),d=[];for(let p=0;p<l.length;p++){let A=a[p];for(let R=0;R<A.length;R++)d.push(l[p])}return d},n.V=function(a){tn(this);let l=[];if(typeof a=="string")Np(this,a)&&(l=l.concat(this.g.get(dr(this,a))));else{a=Array.from(this.g.values());for(let d=0;d<a.length;d++)l=l.concat(a[d])}return l},n.set=function(a,l){return tn(this),this.i=null,a=dr(this,a),Np(this,a)&&(this.h-=this.g.get(a).length),this.g.set(a,[l]),this.h+=1,this},n.get=function(a,l){return a?(a=this.V(a),0<a.length?String(a[0]):l):l};function Op(a,l,d){kp(a,l),0<d.length&&(a.i=null,a.g.set(dr(a,l),O(d)),a.h+=d.length)}n.toString=function(){if(this.i)return this.i;if(!this.g)return"";let a=[],l=Array.from(this.g.keys());for(var d=0;d<l.length;d++){var p=l[d];let R=encodeURIComponent(String(p)),N=this.V(p);for(p=0;p<N.length;p++){var A=R;N[p]!==""&&(A+="="+encodeURIComponent(String(N[p]))),a.push(A)}}return this.i=a.join("&")};function dr(a,l){return l=String(l),a.j&&(l=l.toLowerCase()),l}function Fw(a,l){l&&!a.j&&(tn(a),a.i=null,a.g.forEach(function(d,p){var A=p.toLowerCase();p!=A&&(kp(this,p),Op(this,A,d))},a)),a.j=l}function Uw(a,l){let d=new Ei;if(c.Image){let p=new Image;p.onload=b(nn,d,"TestLoadImage: loaded",!0,l,p),p.onerror=b(nn,d,"TestLoadImage: error",!1,l,p),p.onabort=b(nn,d,"TestLoadImage: abort",!1,l,p),p.ontimeout=b(nn,d,"TestLoadImage: timeout",!1,l,p),c.setTimeout(function(){p.ontimeout&&p.ontimeout()},1e4),p.src=a}else l(!1)}function Bw(a,l){let d=new Ei,p=new AbortController,A=setTimeout(()=>{p.abort(),nn(d,"TestPingServer: timeout",!1,l)},1e4);fetch(a,{signal:p.signal}).then(R=>{clearTimeout(A),R.ok?nn(d,"TestPingServer: ok",!0,l):nn(d,"TestPingServer: server error",!1,l)}).catch(()=>{clearTimeout(A),nn(d,"TestPingServer: error",!1,l)})}function nn(a,l,d,p,A){try{A&&(A.onload=null,A.onerror=null,A.onabort=null,A.ontimeout=null),p(d)}catch{}}function $w(){this.g=new Tw}function jw(a,l,d){let p=d||"";try{Rp(a,function(A,R){let N=A;h(A)&&(N=Uc(A)),l.push(p+R+"="+encodeURIComponent(N))})}catch(A){throw l.push(p+"type="+encodeURIComponent("_badmap")),A}}function Ri(a){this.l=a.Ub||null,this.j=a.eb||!1}P(Ri,Bc),Ri.prototype.g=function(){return new to(this.l,this.j)},Ri.prototype.i=function(a){return function(){return a}}({});function to(a,l){Pe.call(this),this.D=a,this.o=l,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}P(to,Pe),n=to.prototype,n.open=function(a,l){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=a,this.A=l,this.readyState=1,Pi(this)},n.send=function(a){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;let l={headers:this.u,method:this.B,credentials:this.m,cache:void 0};a&&(l.body=a),(this.D||c).fetch(new Request(this.A,l)).then(this.Sa.bind(this),this.ga.bind(this))},n.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,Ci(this)),this.readyState=0},n.Sa=function(a){if(this.g&&(this.l=a,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=a.headers,this.readyState=2,Pi(this)),this.g&&(this.readyState=3,Pi(this),this.g)))if(this.responseType==="arraybuffer")a.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof c.ReadableStream<"u"&&"body"in a){if(this.j=a.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;xp(this)}else a.text().then(this.Ra.bind(this),this.ga.bind(this))};function xp(a){a.j.read().then(a.Pa.bind(a)).catch(a.ga.bind(a))}n.Pa=function(a){if(this.g){if(this.o&&a.value)this.response.push(a.value);else if(!this.o){var l=a.value?a.value:new Uint8Array(0);(l=this.v.decode(l,{stream:!a.done}))&&(this.response=this.responseText+=l)}a.done?Ci(this):Pi(this),this.readyState==3&&xp(this)}},n.Ra=function(a){this.g&&(this.response=this.responseText=a,Ci(this))},n.Qa=function(a){this.g&&(this.response=a,Ci(this))},n.ga=function(){this.g&&Ci(this)};function Ci(a){a.readyState=4,a.l=null,a.j=null,a.v=null,Pi(a)}n.setRequestHeader=function(a,l){this.u.append(a,l)},n.getResponseHeader=function(a){return this.h&&this.h.get(a.toLowerCase())||""},n.getAllResponseHeaders=function(){if(!this.h)return"";let a=[],l=this.h.entries();for(var d=l.next();!d.done;)d=d.value,a.push(d[0]+": "+d[1]),d=l.next();return a.join(`\r
`)};function Pi(a){a.onreadystatechange&&a.onreadystatechange.call(a)}Object.defineProperty(to.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(a){this.m=a?"include":"same-origin"}});function Mp(a){let l="";return re(a,function(d,p){l+=p,l+=":",l+=d,l+=`\r
`}),l}function Yc(a,l,d){e:{for(p in d){var p=!1;break e}p=!0}p||(d=Mp(d),typeof a=="string"?d!=null&&encodeURIComponent(String(d)):ae(a,l,d))}function de(a){Pe.call(this),this.headers=new Map,this.o=a||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}P(de,Pe);var qw=/^https?$/i,zw=["POST","PUT"];n=de.prototype,n.Ha=function(a){this.J=a},n.ea=function(a,l,d,p){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+a);l=l?l.toUpperCase():"GET",this.D=a,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():qc.g(),this.v=this.o?lp(this.o):lp(qc),this.g.onreadystatechange=_(this.Ea,this);try{this.B=!0,this.g.open(l,String(a),!0),this.B=!1}catch(R){Lp(this,R);return}if(a=d||"",d=new Map(this.headers),p)if(Object.getPrototypeOf(p)===Object.prototype)for(var A in p)d.set(A,p[A]);else if(typeof p.keys=="function"&&typeof p.get=="function")for(let R of p.keys())d.set(R,p.get(R));else throw Error("Unknown input type for opt_headers: "+String(p));p=Array.from(d.keys()).find(R=>R.toLowerCase()=="content-type"),A=c.FormData&&a instanceof c.FormData,!(0<=Array.prototype.indexOf.call(zw,l,void 0))||p||A||d.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(let[R,N]of d)this.g.setRequestHeader(R,N);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{Up(this),this.u=!0,this.g.send(a),this.u=!1}catch(R){Lp(this,R)}};function Lp(a,l){a.h=!1,a.g&&(a.j=!0,a.g.abort(),a.j=!1),a.l=l,a.m=5,Vp(a),no(a)}function Vp(a){a.A||(a.A=!0,Ue(a,"complete"),Ue(a,"error"))}n.abort=function(a){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=a||7,Ue(this,"complete"),Ue(this,"abort"),no(this))},n.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),no(this,!0)),de.aa.N.call(this)},n.Ea=function(){this.s||(this.B||this.u||this.j?Fp(this):this.bb())},n.bb=function(){Fp(this)};function Fp(a){if(a.h&&typeof o<"u"&&(!a.v[1]||xt(a)!=4||a.Z()!=2)){if(a.u&&xt(a)==4)op(a.Ea,0,a);else if(Ue(a,"readystatechange"),xt(a)==4){a.h=!1;try{let N=a.Z();e:switch(N){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var l=!0;break e;default:l=!1}var d;if(!(d=l)){var p;if(p=N===0){var A=String(a.D).match(Cp)[1]||null;!A&&c.self&&c.self.location&&(A=c.self.location.protocol.slice(0,-1)),p=!qw.test(A?A.toLowerCase():"")}d=p}if(d)Ue(a,"complete"),Ue(a,"success");else{a.m=6;try{var R=2<xt(a)?a.g.statusText:""}catch{R=""}a.l=R+" ["+a.Z()+"]",Vp(a)}}finally{no(a)}}}}function no(a,l){if(a.g){Up(a);let d=a.g,p=a.v[0]?()=>{}:null;a.g=null,a.v=null,l||Ue(a,"ready");try{d.onreadystatechange=p}catch{}}}function Up(a){a.I&&(c.clearTimeout(a.I),a.I=null)}n.isActive=function(){return!!this.g};function xt(a){return a.g?a.g.readyState:0}n.Z=function(){try{return 2<xt(this)?this.g.status:-1}catch{return-1}},n.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},n.Oa=function(a){if(this.g){var l=this.g.responseText;return a&&l.indexOf(a)==0&&(l=l.substring(a.length)),Ew(l)}};function Bp(a){try{if(!a.g)return null;if("response"in a.g)return a.g.response;switch(a.H){case"":case"text":return a.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in a.g)return a.g.mozResponseArrayBuffer}return null}catch{return null}}function Hw(a){let l={};a=(a.g&&2<=xt(a)&&a.g.getAllResponseHeaders()||"").split(`\r
`);for(let p=0;p<a.length;p++){if($(a[p]))continue;var d=T(a[p]);let A=d[0];if(d=d[1],typeof d!="string")continue;d=d.trim();let R=l[A]||[];l[A]=R,R.push(d)}E(l,function(p){return p.join(", ")})}n.Ba=function(){return this.m},n.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function Di(a,l,d){return d&&d.internalChannelParams&&d.internalChannelParams[a]||l}function $p(a){this.Aa=0,this.i=[],this.j=new Ei,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=Di("failFast",!1,a),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=Di("baseRetryDelayMs",5e3,a),this.cb=Di("retryDelaySeedMs",1e4,a),this.Wa=Di("forwardChannelMaxRetries",2,a),this.wa=Di("forwardChannelRequestTimeoutMs",2e4,a),this.pa=a&&a.xmlHttpFactory||void 0,this.Xa=a&&a.Tb||void 0,this.Ca=a&&a.useFetchStreams||!1,this.L=void 0,this.J=a&&a.supportsCrossDomainXhr||!1,this.K="",this.h=new Ep(a&&a.concurrentRequestLimit),this.Da=new $w,this.P=a&&a.fastHandshake||!1,this.O=a&&a.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=a&&a.Rb||!1,a&&a.xa&&this.j.xa(),a&&a.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&a&&a.detectBufferingProxy||!1,this.ja=void 0,a&&a.longPollingTimeout&&0<a.longPollingTimeout&&(this.ja=a.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}n=$p.prototype,n.la=8,n.G=1,n.connect=function(a,l,d,p){Be(0),this.W=a,this.H=l||{},d&&p!==void 0&&(this.H.OSID=d,this.H.OAID=p),this.F=this.X,this.I=Yp(this,null,this.W),io(this)};function Jc(a){if(jp(a),a.G==3){var l=a.U++,d=Ot(a.I);if(ae(d,"SID",a.K),ae(d,"RID",l),ae(d,"TYPE","terminate"),ki(a,d),l=new en(a,a.j,l),l.L=2,l.v=eo(Ot(d)),d=!1,c.navigator&&c.navigator.sendBeacon)try{d=c.navigator.sendBeacon(l.v.toString(),"")}catch{}!d&&c.Image&&(new Image().src=l.v,d=!0),d||(l.g=Jp(l.j,null),l.g.ea(l.v)),l.F=Date.now(),Js(l)}Qp(a)}function ro(a){a.g&&(Zc(a),a.g.cancel(),a.g=null)}function jp(a){ro(a),a.u&&(c.clearTimeout(a.u),a.u=null),so(a),a.h.cancel(),a.s&&(typeof a.s=="number"&&c.clearTimeout(a.s),a.s=null)}function io(a){if(!Tp(a.h)&&!a.s){a.s=!0;var l=a.Ga;pi||ep(),gi||(pi(),gi=!0),Dc.add(l,a),a.B=0}}function Ww(a,l){return Ap(a.h)>=a.h.j-(a.s?1:0)?!1:a.s?(a.i=l.D.concat(a.i),!0):a.G==1||a.G==2||a.B>=(a.Va?0:a.Wa)?!1:(a.s=wi(_(a.Ga,a,l),Kp(a,a.B)),a.B++,!0)}n.Ga=function(a){if(this.s)if(this.s=null,this.G==1){if(!a){this.U=Math.floor(1e5*Math.random()),a=this.U++;let A=new en(this,this.j,a),R=this.o;if(this.S&&(R?(R=m(R),w(R,this.S)):R=this.S),this.m!==null||this.O||(A.H=R,R=null),this.P)e:{for(var l=0,d=0;d<this.i.length;d++){t:{var p=this.i[d];if("__data__"in p.map&&(p=p.map.__data__,typeof p=="string")){p=p.length;break t}p=void 0}if(p===void 0)break;if(l+=p,4096<l){l=d;break e}if(l===4096||d===this.i.length-1){l=d+1;break e}}l=1e3}else l=1e3;l=zp(this,A,l),d=Ot(this.I),ae(d,"RID",a),ae(d,"CVER",22),this.D&&ae(d,"X-HTTP-Session-Id",this.D),ki(this,d),R&&(this.O?l="headers="+encodeURIComponent(String(Mp(R)))+"&"+l:this.m&&Yc(d,this.m,R)),Qc(this.h,A),this.Ua&&ae(d,"TYPE","init"),this.P?(ae(d,"$req",l),ae(d,"SID","null"),A.T=!0,Hc(A,d,null)):Hc(A,d,l),this.G=2}}else this.G==3&&(a?qp(this,a):this.i.length==0||Tp(this.h)||qp(this))};function qp(a,l){var d;l?d=l.l:d=a.U++;let p=Ot(a.I);ae(p,"SID",a.K),ae(p,"RID",d),ae(p,"AID",a.T),ki(a,p),a.m&&a.o&&Yc(p,a.m,a.o),d=new en(a,a.j,d,a.B+1),a.m===null&&(d.H=a.o),l&&(a.i=l.D.concat(a.i)),l=zp(a,d,1e3),d.I=Math.round(.5*a.wa)+Math.round(.5*a.wa*Math.random()),Qc(a.h,d),Hc(d,p,l)}function ki(a,l){a.H&&re(a.H,function(d,p){ae(l,p,d)}),a.l&&Rp({},function(d,p){ae(l,p,d)})}function zp(a,l,d){d=Math.min(a.i.length,d);var p=a.l?_(a.l.Na,a.l,a):null;e:{var A=a.i;let R=-1;for(;;){let N=["count="+d];R==-1?0<d?(R=A[0].g,N.push("ofs="+R)):R=0:N.push("ofs="+R);let oe=!0;for(let Se=0;Se<d;Se++){let X=A[Se].g,De=A[Se].map;if(X-=R,0>X)R=Math.max(0,A[Se].g-100),oe=!1;else try{jw(De,N,"req"+X+"_")}catch{p&&p(De)}}if(oe){p=N.join("&");break e}}}return a=a.i.splice(0,d),l.D=a,p}function Hp(a){if(!a.g&&!a.u){a.Y=1;var l=a.Fa;pi||ep(),gi||(pi(),gi=!0),Dc.add(l,a),a.v=0}}function Xc(a){return a.g||a.u||3<=a.v?!1:(a.Y++,a.u=wi(_(a.Fa,a),Kp(a,a.v)),a.v++,!0)}n.Fa=function(){if(this.u=null,Wp(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var a=2*this.R;this.j.info("BP detection timer enabled: "+a),this.A=wi(_(this.ab,this),a)}},n.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,Be(10),ro(this),Wp(this))};function Zc(a){a.A!=null&&(c.clearTimeout(a.A),a.A=null)}function Wp(a){a.g=new en(a,a.j,"rpc",a.Y),a.m===null&&(a.g.H=a.o),a.g.O=0;var l=Ot(a.qa);ae(l,"RID","rpc"),ae(l,"SID",a.K),ae(l,"AID",a.T),ae(l,"CI",a.F?"0":"1"),!a.F&&a.ja&&ae(l,"TO",a.ja),ae(l,"TYPE","xmlhttp"),ki(a,l),a.m&&a.o&&Yc(l,a.m,a.o),a.L&&(a.g.I=a.L);var d=a.g;a=a.ia,d.L=1,d.v=eo(Ot(l)),d.m=null,d.P=!0,vp(d,a)}n.Za=function(){this.C!=null&&(this.C=null,ro(this),Xc(this),Be(19))};function so(a){a.C!=null&&(c.clearTimeout(a.C),a.C=null)}function Gp(a,l){var d=null;if(a.g==l){so(a),Zc(a),a.g=null;var p=2}else if(Kc(a.h,l))d=l.D,Sp(a.h,l),p=1;else return;if(a.G!=0){if(l.o)if(p==1){d=l.m?l.m.length:0,l=Date.now()-l.F;var A=a.B;p=Ks(),Ue(p,new gp(p,d)),io(a)}else Hp(a);else if(A=l.s,A==3||A==0&&0<l.X||!(p==1&&Ww(a,l)||p==2&&Xc(a)))switch(d&&0<d.length&&(l=a.h,l.i=l.i.concat(d)),A){case 1:Nn(a,5);break;case 4:Nn(a,10);break;case 3:Nn(a,6);break;default:Nn(a,2)}}}function Kp(a,l){let d=a.Ta+Math.floor(Math.random()*a.cb);return a.isActive()||(d*=2),d*l}function Nn(a,l){if(a.j.info("Error code "+l),l==2){var d=_(a.fb,a),p=a.Xa;let A=!p;p=new kn(p||"//www.google.com/images/cleardot.gif"),c.location&&c.location.protocol=="http"||Xs(p,"https"),eo(p),A?Uw(p.toString(),d):Bw(p.toString(),d)}else Be(2);a.G=0,a.l&&a.l.sa(l),Qp(a),jp(a)}n.fb=function(a){a?(this.j.info("Successfully pinged google.com"),Be(2)):(this.j.info("Failed to ping google.com"),Be(1))};function Qp(a){if(a.G=0,a.ka=[],a.l){let l=bp(a.h);(l.length!=0||a.i.length!=0)&&(k(a.ka,l),k(a.ka,a.i),a.h.i.length=0,O(a.i),a.i.length=0),a.l.ra()}}function Yp(a,l,d){var p=d instanceof kn?Ot(d):new kn(d);if(p.g!="")l&&(p.g=l+"."+p.g),Zs(p,p.s);else{var A=c.location;p=A.protocol,l=l?l+"."+A.hostname:A.hostname,A=+A.port;var R=new kn(null);p&&Xs(R,p),l&&(R.g=l),A&&Zs(R,A),d&&(R.l=d),p=R}return d=a.D,l=a.ya,d&&l&&ae(p,d,l),ae(p,"VER",a.la),ki(a,p),p}function Jp(a,l,d){if(l&&!a.J)throw Error("Can't create secondary domain capable XhrIo object.");return l=a.Ca&&!a.pa?new de(new Ri({eb:d})):new de(a.pa),l.Ha(a.J),l}n.isActive=function(){return!!this.l&&this.l.isActive(this)};function Xp(){}n=Xp.prototype,n.ua=function(){},n.ta=function(){},n.sa=function(){},n.ra=function(){},n.isActive=function(){return!0},n.Na=function(){};function oo(){}oo.prototype.g=function(a,l){return new We(a,l)};function We(a,l){Pe.call(this),this.g=new $p(l),this.l=a,this.h=l&&l.messageUrlParams||null,a=l&&l.messageHeaders||null,l&&l.clientProtocolHeaderRequired&&(a?a["X-Client-Protocol"]="webchannel":a={"X-Client-Protocol":"webchannel"}),this.g.o=a,a=l&&l.initMessageHeaders||null,l&&l.messageContentType&&(a?a["X-WebChannel-Content-Type"]=l.messageContentType:a={"X-WebChannel-Content-Type":l.messageContentType}),l&&l.va&&(a?a["X-WebChannel-Client-Profile"]=l.va:a={"X-WebChannel-Client-Profile":l.va}),this.g.S=a,(a=l&&l.Sb)&&!$(a)&&(this.g.m=a),this.v=l&&l.supportsCrossDomainXhr||!1,this.u=l&&l.sendRawJson||!1,(l=l&&l.httpSessionIdParam)&&!$(l)&&(this.g.D=l,a=this.h,a!==null&&l in a&&(a=this.h,l in a&&delete a[l])),this.j=new fr(this)}P(We,Pe),We.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},We.prototype.close=function(){Jc(this.g)},We.prototype.o=function(a){var l=this.g;if(typeof a=="string"){var d={};d.__data__=a,a=d}else this.u&&(d={},d.__data__=Uc(a),a=d);l.i.push(new Pw(l.Ya++,a)),l.G==3&&io(l)},We.prototype.N=function(){this.g.l=null,delete this.j,Jc(this.g),delete this.g,We.aa.N.call(this)};function Zp(a){$c.call(this),a.__headers__&&(this.headers=a.__headers__,this.statusCode=a.__status__,delete a.__headers__,delete a.__status__);var l=a.__sm__;if(l){e:{for(let d in l){a=d;break e}a=void 0}(this.i=a)&&(a=this.i,l=l!==null&&a in l?l[a]:void 0),this.data=l}else this.data=a}P(Zp,$c);function eg(){jc.call(this),this.status=1}P(eg,jc);function fr(a){this.g=a}P(fr,Xp),fr.prototype.ua=function(){Ue(this.g,"a")},fr.prototype.ta=function(a){Ue(this.g,new Zp(a))},fr.prototype.sa=function(a){Ue(this.g,new eg)},fr.prototype.ra=function(){Ue(this.g,"b")},oo.prototype.createWebChannel=oo.prototype.g,We.prototype.send=We.prototype.o,We.prototype.open=We.prototype.m,We.prototype.close=We.prototype.close,kh=Gt.createWebChannelTransport=function(){return new oo},Dh=Gt.getStatEventTarget=function(){return Ks()},Ph=Gt.Event=Pn,ba=Gt.Stat={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},Qs.NO_ERROR=0,Qs.TIMEOUT=8,Qs.HTTP_ERROR=6,Ts=Gt.ErrorCode=Qs,mp.COMPLETE="complete",Ch=Gt.EventType=mp,hp.EventType=vi,vi.OPEN="a",vi.CLOSE="b",vi.ERROR="c",vi.MESSAGE="d",Pe.prototype.listen=Pe.prototype.K,jr=Gt.WebChannel=hp,b0=Gt.FetchXmlHttpFactory=Ri,de.prototype.listenOnce=de.prototype.L,de.prototype.getLastError=de.prototype.Ka,de.prototype.getLastErrorCode=de.prototype.Ba,de.prototype.getStatus=de.prototype.Z,de.prototype.getResponseJson=de.prototype.Oa,de.prototype.getResponseText=de.prototype.oa,de.prototype.send=de.prototype.ea,de.prototype.setWithCredentials=de.prototype.Ha,Rh=Gt.XhrIo=de}).apply(typeof Sa<"u"?Sa:typeof self<"u"?self:typeof window<"u"?window:{});var M_="@firebase/firestore",L_="4.7.16";var Te=class{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}};Te.UNAUTHENTICATED=new Te(null),Te.GOOGLE_CREDENTIALS=new Te("google-credentials-uid"),Te.FIRST_PARTY=new Te("first-party-uid"),Te.MOCK_USER=new Te("mock-user");var ci="11.8.1";var tr=new It("@firebase/firestore");function qr(){return tr.logLevel}function M(n,...e){if(tr.logLevel<=Q.DEBUG){let t=e.map(Af);tr.debug(`Firestore (${ci}): ${n}`,...t)}}function Kt(n,...e){if(tr.logLevel<=Q.ERROR){let t=e.map(Af);tr.error(`Firestore (${ci}): ${n}`,...t)}}function Yr(n,...e){if(tr.logLevel<=Q.WARN){let t=e.map(Af);tr.warn(`Firestore (${ci}): ${n}`,...t)}}function Af(n){if(typeof n=="string")return n;try{return function(t){return JSON.stringify(t)}(n)}catch{return n}}function U(n,e,t){let r="Unexpected state";typeof e=="string"?r=e:t=e,Cv(n,r,t)}function Cv(n,e,t){let r=`FIRESTORE (${ci}) INTERNAL ASSERTION FAILED: ${e} (ID: ${n.toString(16)})`;if(t!==void 0)try{r+=" CONTEXT: "+JSON.stringify(t)}catch{r+=" CONTEXT: "+t}throw Kt(r),new Error(r)}function ne(n,e,t,r){let i="Unexpected state";typeof t=="string"?i=t:r=t,n||Cv(e,i,r)}function H(n,e){return n}var C={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},x=class extends Ye{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}};var At=class{constructor(){this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}};var Oa=class{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}},Lh=class{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable(()=>t(Te.UNAUTHENTICATED))}shutdown(){}},Vh=class{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable(()=>t(this.token.user))}shutdown(){this.changeListener=null}},Fh=class{constructor(e){this.t=e,this.currentUser=Te.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){ne(this.o===void 0,42304);let r=this.i,i=u=>this.i!==r?(r=this.i,t(u)):Promise.resolve(),s=new At;this.o=()=>{this.i++,this.currentUser=this.u(),s.resolve(),s=new At,e.enqueueRetryable(()=>i(this.currentUser))};let o=()=>{let u=s;e.enqueueRetryable(()=>y(this,null,function*(){yield u.promise,yield i(this.currentUser)}))},c=u=>{M("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=u,this.o&&(this.auth.addAuthTokenListener(this.o),o())};this.t.onInit(u=>c(u)),setTimeout(()=>{if(!this.auth){let u=this.t.getImmediate({optional:!0});u?c(u):(M("FirebaseAuthCredentialsProvider","Auth not yet detected"),s.resolve(),s=new At)}},0),o()}getToken(){let e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(r=>this.i!==e?(M("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(ne(typeof r.accessToken=="string",31837,{l:r}),new Oa(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){let e=this.auth&&this.auth.getUid();return ne(e===null||typeof e=="string",2055,{h:e}),new Te(e)}},Uh=class{constructor(e,t,r){this.P=e,this.T=t,this.I=r,this.type="FirstParty",this.user=Te.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);let e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}},Bh=class{constructor(e,t,r){this.P=e,this.T=t,this.I=r}getToken(){return Promise.resolve(new Uh(this.P,this.T,this.I))}start(e,t){e.enqueueRetryable(()=>t(Te.FIRST_PARTY))}shutdown(){}invalidateToken(){}},xa=class{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}},$h=class{constructor(e,t){this.V=t,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,xe(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,t){ne(this.o===void 0,3512);let r=s=>{s.error!=null&&M("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${s.error.message}`);let o=s.token!==this.m;return this.m=s.token,M("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?t(s.token):Promise.resolve()};this.o=s=>{e.enqueueRetryable(()=>r(s))};let i=s=>{M("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=s,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit(s=>i(s)),setTimeout(()=>{if(!this.appCheck){let s=this.V.getImmediate({optional:!0});s?i(s):M("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){if(this.p)return Promise.resolve(new xa(this.p));let e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(t=>t?(ne(typeof t.token=="string",44558,{tokenResult:t}),this.m=t.token,new xa(t.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}};function R0(n){let e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(n);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let r=0;r<n;r++)t[r]=Math.floor(256*Math.random());return t}function Pv(){return new TextEncoder}var Ma=class{static newId(){let e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=62*Math.floor(4.129032258064516),r="";for(;r.length<20;){let i=R0(40);for(let s=0;s<i.length;++s)r.length<20&&i[s]<t&&(r+=e.charAt(i[s]%62))}return r}};function K(n,e){return n<e?-1:n>e?1:0}function jh(n,e){let t=0;for(;t<n.length&&t<e.length;){let r=n.codePointAt(t),i=e.codePointAt(t);if(r!==i){if(r<128&&i<128)return K(r,i);{let s=Pv(),o=C0(s.encode(V_(n,t)),s.encode(V_(e,t)));return o!==0?o:K(r,i)}}t+=r>65535?2:1}return K(n.length,e.length)}function V_(n,e){return n.codePointAt(e)>65535?n.substring(e,e+2):n.substring(e,e+1)}function C0(n,e){for(let t=0;t<n.length&&t<e.length;++t)if(n[t]!==e[t])return K(n[t],e[t]);return K(n.length,e.length)}function Jr(n,e,t){return n.length===e.length&&n.every((r,i)=>t(r,e[i]))}var F_=-62135596800,U_=1e6,Re=class n{static now(){return n.fromMillis(Date.now())}static fromDate(e){return n.fromMillis(e.getTime())}static fromMillis(e){let t=Math.floor(e/1e3),r=Math.floor((e-1e3*t)*U_);return new n(t,r)}constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new x(C.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new x(C.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<F_)throw new x(C.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new x(C.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/U_}_compareTo(e){return this.seconds===e.seconds?K(this.nanoseconds,e.nanoseconds):K(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){let e=this.seconds-F_;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}};var W=class n{static fromTimestamp(e){return new n(e)}static min(){return new n(new Re(0,0))}static max(){return new n(new Re(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}};var B_="__name__",La=class n{constructor(e,t,r){t===void 0?t=0:t>e.length&&U(637,{offset:t,range:e.length}),r===void 0?r=e.length-t:r>e.length-t&&U(1746,{length:r,range:e.length-t}),this.segments=e,this.offset=t,this.len=r}get length(){return this.len}isEqual(e){return n.comparator(this,e)===0}child(e){let t=this.segments.slice(this.offset,this.limit());return e instanceof n?e.forEach(r=>{t.push(r)}):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,r=this.limit();t<r;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){let r=Math.min(e.length,t.length);for(let i=0;i<r;i++){let s=n.compareSegments(e.get(i),t.get(i));if(s!==0)return s}return K(e.length,t.length)}static compareSegments(e,t){let r=n.isNumericId(e),i=n.isNumericId(t);return r&&!i?-1:!r&&i?1:r&&i?n.extractNumericId(e).compare(n.extractNumericId(t)):jh(e,t)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return Wt.fromString(e.substring(4,e.length-2))}},he=class n extends La{construct(e,t,r){return new n(e,t,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){let t=[];for(let r of e){if(r.indexOf("//")>=0)throw new x(C.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);t.push(...r.split("/").filter(i=>i.length>0))}return new n(t)}static emptyPath(){return new n([])}},P0=/^[_a-zA-Z][_a-zA-Z0-9]*$/,Xe=class n extends La{construct(e,t,r){return new n(e,t,r)}static isValidIdentifier(e){return P0.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),n.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===B_}static keyField(){return new n([B_])}static fromServerFormat(e){let t=[],r="",i=0,s=()=>{if(r.length===0)throw new x(C.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(r),r=""},o=!1;for(;i<e.length;){let c=e[i];if(c==="\\"){if(i+1===e.length)throw new x(C.INVALID_ARGUMENT,"Path has trailing escape character: "+e);let u=e[i+1];if(u!=="\\"&&u!=="."&&u!=="`")throw new x(C.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=u,i+=2}else c==="`"?(o=!o,i++):c!=="."||o?(r+=c,i++):(s(),i++)}if(s(),o)throw new x(C.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new n(t)}static emptyPath(){return new n([])}};var F=class n{constructor(e){this.path=e}static fromPath(e){return new n(he.fromString(e))}static fromName(e){return new n(he.fromString(e).popFirst(5))}static empty(){return new n(he.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&he.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return he.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new n(new he(e.slice()))}};var Ps=-1,qh=class{constructor(e,t,r,i){this.indexId=e,this.collectionGroup=t,this.fields=r,this.indexState=i}};qh.UNKNOWN_ID=-1;function D0(n,e){let t=n.toTimestamp().seconds,r=n.toTimestamp().nanoseconds+1,i=W.fromTimestamp(r===1e9?new Re(t+1,0):new Re(t,r));return new nr(i,F.empty(),e)}function k0(n){return new nr(n.readTime,n.key,Ps)}var nr=class n{constructor(e,t,r){this.readTime=e,this.documentKey=t,this.largestBatchId=r}static min(){return new n(W.min(),F.empty(),Ps)}static max(){return new n(W.max(),F.empty(),Ps)}};function N0(n,e){let t=n.readTime.compareTo(e.readTime);return t!==0?t:(t=F.comparator(n.documentKey,e.documentKey),t!==0?t:K(n.largestBatchId,e.largestBatchId))}var O0="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.",zh=class{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}};function ui(n){return y(this,null,function*(){if(n.code!==C.FAILED_PRECONDITION||n.message!==O0)throw n;M("LocalStore","Unexpectedly lost primary lease")})}var D=class n{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)},t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)})}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&U(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new n((r,i)=>{this.nextCallback=s=>{this.wrapSuccess(e,s).next(r,i)},this.catchCallback=s=>{this.wrapFailure(t,s).next(r,i)}})}toPromise(){return new Promise((e,t)=>{this.next(e,t)})}wrapUserFunction(e){try{let t=e();return t instanceof n?t:n.resolve(t)}catch(t){return n.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction(()=>e(t)):n.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction(()=>e(t)):n.reject(t)}static resolve(e){return new n((t,r)=>{t(e)})}static reject(e){return new n((t,r)=>{r(e)})}static waitFor(e){return new n((t,r)=>{let i=0,s=0,o=!1;e.forEach(c=>{++i,c.next(()=>{++s,o&&s===i&&t()},u=>r(u))}),o=!0,s===i&&t()})}static or(e){let t=n.resolve(!1);for(let r of e)t=t.next(i=>i?n.resolve(i):r());return t}static forEach(e,t){let r=[];return e.forEach((i,s)=>{r.push(t.call(this,i,s))}),this.waitFor(r)}static mapArray(e,t){return new n((r,i)=>{let s=e.length,o=new Array(s),c=0;for(let u=0;u<s;u++){let h=u;t(e[h]).next(f=>{o[h]=f,++c,c===s&&r(o)},f=>i(f))}})}static doWhile(e,t){return new n((r,i)=>{let s=()=>{e()===!0?t().next(()=>{s()},i):r()};s()})}};function x0(n){let e=n.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}function li(n){return n.name==="IndexedDbTransactionError"}var Sf=(()=>{class n{constructor(t,r){this.previousValue=t,r&&(r.sequenceNumberHandler=i=>this.ue(i),this.ce=i=>r.writeSequenceNumber(i))}ue(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue}next(){let t=++this.previousValue;return this.ce&&this.ce(t),t}}n.le=-1;return n})(),bf=-1;function _c(n){return n==null}function Ds(n){return n===0&&1/n==-1/0}function M0(n){return typeof n=="number"&&Number.isInteger(n)&&!Ds(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}var Dv="";function L0(n){let e="";for(let t=0;t<n.length;t++)e.length>0&&(e=$_(e)),e=V0(n.get(t),e);return $_(e)}function V0(n,e){let t=e,r=n.length;for(let i=0;i<r;i++){let s=n.charAt(i);switch(s){case"\0":t+="";break;case Dv:t+="";break;default:t+=s}}return t}function $_(n){return n+Dv+""}var F0="remoteDocuments",kv="owner";var Nv="mutationQueues";var Ov="mutations";var xv="documentMutations",U0="remoteDocumentsV14";var Mv="remoteDocumentGlobal";var Lv="targets";var Vv="targetDocuments";var Fv="targetGlobal",Uv="collectionParents";var Bv="clientMetadata";var $v="bundles";var jv="namedQueries";var B0="indexConfiguration";var $0="indexState";var j0="indexEntries";var qv="documentOverlays";var q0="globals";var z0=[Nv,Ov,xv,F0,Lv,kv,Fv,Vv,Bv,Mv,Uv,$v,jv],n1=[...z0,qv],H0=[Nv,Ov,xv,U0,Lv,kv,Fv,Vv,Bv,Mv,Uv,$v,jv,qv],W0=H0,G0=[...W0,B0,$0,j0];var r1=[...G0,q0];function j_(n){let e=0;for(let t in n)Object.prototype.hasOwnProperty.call(n,t)&&e++;return e}function Cn(n,e){for(let t in n)Object.prototype.hasOwnProperty.call(n,t)&&e(t,n[t])}function zv(n){for(let e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}var ge=class n{constructor(e,t){this.comparator=e,this.root=t||St.EMPTY}insert(e,t){return new n(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,St.BLACK,null,null))}remove(e){return new n(this.comparator,this.root.remove(e,this.comparator).copy(null,null,St.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){let r=this.comparator(e,t.key);if(r===0)return t.value;r<0?t=t.left:r>0&&(t=t.right)}return null}indexOf(e){let t=0,r=this.root;for(;!r.isEmpty();){let i=this.comparator(e,r.key);if(i===0)return t+r.left.size;i<0?r=r.left:(t+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((t,r)=>(e(t,r),!1))}toString(){let e=[];return this.inorderTraversal((t,r)=>(e.push(`${t}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Gr(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Gr(this.root,e,this.comparator,!1)}getReverseIterator(){return new Gr(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Gr(this.root,e,this.comparator,!0)}},Gr=class{constructor(e,t,r,i){this.isReverse=i,this.nodeStack=[];let s=1;for(;!e.isEmpty();)if(s=t?r(e.key,t):1,t&&i&&(s*=-1),s<0)e=this.isReverse?e.left:e.right;else{if(s===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop(),t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;let e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}},St=class n{constructor(e,t,r,i,s){this.key=e,this.value=t,this.color=r??n.RED,this.left=i??n.EMPTY,this.right=s??n.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,r,i,s){return new n(e??this.key,t??this.value,r??this.color,i??this.left,s??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,r){let i=this,s=r(e,i.key);return i=s<0?i.copy(null,null,null,i.left.insert(e,t,r),null):s===0?i.copy(null,t,null,null,null):i.copy(null,null,null,null,i.right.insert(e,t,r)),i.fixUp()}removeMin(){if(this.left.isEmpty())return n.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let r,i=this;if(t(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,t),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),t(e,i.key)===0){if(i.right.isEmpty())return n.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,t))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){let e=this.copy(null,null,n.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){let e=this.copy(null,null,n.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){let e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){let e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw U(43730,{key:this.key,value:this.value});if(this.right.isRed())throw U(14113,{key:this.key,value:this.value});let e=this.left.check();if(e!==this.right.check())throw U(27949);return e+(this.isRed()?0:1)}};St.EMPTY=null,St.RED=!0,St.BLACK=!1;St.EMPTY=new class{constructor(){this.size=0}get key(){throw U(57766)}get value(){throw U(16141)}get color(){throw U(16727)}get left(){throw U(29726)}get right(){throw U(36894)}copy(e,t,r,i,s){return this}insert(e,t,r){return new St(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};var Ae=class n{constructor(e){this.comparator=e,this.data=new ge(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((t,r)=>(e(t),!1))}forEachInRange(e,t){let r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){let i=r.getNext();if(this.comparator(i.key,e[1])>=0)return;t(i.key)}}forEachWhile(e,t){let r;for(r=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){let t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new Va(this.data.getIterator())}getIteratorFrom(e){return new Va(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach(r=>{t=t.add(r)}),t}isEqual(e){if(!(e instanceof n)||this.size!==e.size)return!1;let t=this.data.getIterator(),r=e.data.getIterator();for(;t.hasNext();){let i=t.getNext().key,s=r.getNext().key;if(this.comparator(i,s)!==0)return!1}return!0}toArray(){let e=[];return this.forEach(t=>{e.push(t)}),e}toString(){let e=[];return this.forEach(t=>e.push(t)),"SortedSet("+e.toString()+")"}copy(e){let t=new n(this.comparator);return t.data=e,t}},Va=class{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}};var rt=class n{constructor(e){this.fields=e,e.sort(Xe.comparator)}static empty(){return new n([])}unionWith(e){let t=new Ae(Xe.comparator);for(let r of this.fields)t=t.add(r);for(let r of e)t=t.add(r);return new n(t.toArray())}covers(e){for(let t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return Jr(this.fields,e.fields,(t,r)=>t.isEqual(r))}};var Fa=class extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}};var Ve=class n{constructor(e){this.binaryString=e}static fromBase64String(e){let t=function(i){try{return atob(i)}catch(s){throw typeof DOMException<"u"&&s instanceof DOMException?new Fa("Invalid base64 string: "+s):s}}(e);return new n(t)}static fromUint8Array(e){let t=function(i){let s="";for(let o=0;o<i.length;++o)s+=String.fromCharCode(i[o]);return s}(e);return new n(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(t){return btoa(t)}(this.binaryString)}toUint8Array(){return function(t){let r=new Uint8Array(t.length);for(let i=0;i<t.length;i++)r[i]=t.charCodeAt(i);return r}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return K(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}};Ve.EMPTY_BYTE_STRING=new Ve("");var K0=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Qt(n){if(ne(!!n,39018),typeof n=="string"){let e=0,t=K0.exec(n);if(ne(!!t,46558,{timestamp:n}),t[1]){let i=t[1];i=(i+"000000000").substr(0,9),e=Number(i)}let r=new Date(n);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:le(n.seconds),nanos:le(n.nanos)}}function le(n){return typeof n=="number"?n:typeof n=="string"?Number(n):0}function Yt(n){return typeof n=="string"?Ve.fromBase64String(n):Ve.fromUint8Array(n)}var Hv="server_timestamp",Wv="__type__",Gv="__previous_value__",Kv="__local_write_time__";function Rf(n){var e,t;return((t=(((e=n?.mapValue)===null||e===void 0?void 0:e.fields)||{})[Wv])===null||t===void 0?void 0:t.stringValue)===Hv}function vc(n){let e=n.mapValue.fields[Gv];return Rf(e)?vc(e):e}function ks(n){let e=Qt(n.mapValue.fields[Kv].timestampValue);return new Re(e.seconds,e.nanos)}var Hh=class{constructor(e,t,r,i,s,o,c,u,h,f){this.databaseId=e,this.appId=t,this.persistenceKey=r,this.host=i,this.ssl=s,this.forceLongPolling=o,this.autoDetectLongPolling=c,this.longPollingOptions=u,this.useFetchStreams=h,this.isUsingEmulator=f}},Ua="(default)",Ba=class n{constructor(e,t){this.projectId=e,this.database=t||Ua}static empty(){return new n("","")}get isDefaultDatabase(){return this.database===Ua}isEqual(e){return e instanceof n&&e.projectId===this.projectId&&e.database===this.database}};var Cf="__type__",Qv="__max__",Ra={mapValue:{fields:{__type__:{stringValue:Qv}}}},Pf="__vector__",Xr="value";function Tn(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?Rf(n)?4:Jv(n)?9007199254740991:Yv(n)?10:11:U(28295,{value:n})}function Pt(n,e){if(n===e)return!0;let t=Tn(n);if(t!==Tn(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return ks(n).isEqual(ks(e));case 3:return function(i,s){if(typeof i.timestampValue=="string"&&typeof s.timestampValue=="string"&&i.timestampValue.length===s.timestampValue.length)return i.timestampValue===s.timestampValue;let o=Qt(i.timestampValue),c=Qt(s.timestampValue);return o.seconds===c.seconds&&o.nanos===c.nanos}(n,e);case 5:return n.stringValue===e.stringValue;case 6:return function(i,s){return Yt(i.bytesValue).isEqual(Yt(s.bytesValue))}(n,e);case 7:return n.referenceValue===e.referenceValue;case 8:return function(i,s){return le(i.geoPointValue.latitude)===le(s.geoPointValue.latitude)&&le(i.geoPointValue.longitude)===le(s.geoPointValue.longitude)}(n,e);case 2:return function(i,s){if("integerValue"in i&&"integerValue"in s)return le(i.integerValue)===le(s.integerValue);if("doubleValue"in i&&"doubleValue"in s){let o=le(i.doubleValue),c=le(s.doubleValue);return o===c?Ds(o)===Ds(c):isNaN(o)&&isNaN(c)}return!1}(n,e);case 9:return Jr(n.arrayValue.values||[],e.arrayValue.values||[],Pt);case 10:case 11:return function(i,s){let o=i.mapValue.fields||{},c=s.mapValue.fields||{};if(j_(o)!==j_(c))return!1;for(let u in o)if(o.hasOwnProperty(u)&&(c[u]===void 0||!Pt(o[u],c[u])))return!1;return!0}(n,e);default:return U(52216,{left:n})}}function Ns(n,e){return(n.values||[]).find(t=>Pt(t,e))!==void 0}function Zr(n,e){if(n===e)return 0;let t=Tn(n),r=Tn(e);if(t!==r)return K(t,r);switch(t){case 0:case 9007199254740991:return 0;case 1:return K(n.booleanValue,e.booleanValue);case 2:return function(s,o){let c=le(s.integerValue||s.doubleValue),u=le(o.integerValue||o.doubleValue);return c<u?-1:c>u?1:c===u?0:isNaN(c)?isNaN(u)?0:-1:1}(n,e);case 3:return q_(n.timestampValue,e.timestampValue);case 4:return q_(ks(n),ks(e));case 5:return jh(n.stringValue,e.stringValue);case 6:return function(s,o){let c=Yt(s),u=Yt(o);return c.compareTo(u)}(n.bytesValue,e.bytesValue);case 7:return function(s,o){let c=s.split("/"),u=o.split("/");for(let h=0;h<c.length&&h<u.length;h++){let f=K(c[h],u[h]);if(f!==0)return f}return K(c.length,u.length)}(n.referenceValue,e.referenceValue);case 8:return function(s,o){let c=K(le(s.latitude),le(o.latitude));return c!==0?c:K(le(s.longitude),le(o.longitude))}(n.geoPointValue,e.geoPointValue);case 9:return z_(n.arrayValue,e.arrayValue);case 10:return function(s,o){var c,u,h,f;let g=s.fields||{},_=o.fields||{},b=(c=g[Xr])===null||c===void 0?void 0:c.arrayValue,P=(u=_[Xr])===null||u===void 0?void 0:u.arrayValue,O=K(((h=b?.values)===null||h===void 0?void 0:h.length)||0,((f=P?.values)===null||f===void 0?void 0:f.length)||0);return O!==0?O:z_(b,P)}(n.mapValue,e.mapValue);case 11:return function(s,o){if(s===Ra.mapValue&&o===Ra.mapValue)return 0;if(s===Ra.mapValue)return 1;if(o===Ra.mapValue)return-1;let c=s.fields||{},u=Object.keys(c),h=o.fields||{},f=Object.keys(h);u.sort(),f.sort();for(let g=0;g<u.length&&g<f.length;++g){let _=jh(u[g],f[g]);if(_!==0)return _;let b=Zr(c[u[g]],h[f[g]]);if(b!==0)return b}return K(u.length,f.length)}(n.mapValue,e.mapValue);default:throw U(23264,{Pe:t})}}function q_(n,e){if(typeof n=="string"&&typeof e=="string"&&n.length===e.length)return K(n,e);let t=Qt(n),r=Qt(e),i=K(t.seconds,r.seconds);return i!==0?i:K(t.nanos,r.nanos)}function z_(n,e){let t=n.values||[],r=e.values||[];for(let i=0;i<t.length&&i<r.length;++i){let s=Zr(t[i],r[i]);if(s)return s}return K(t.length,r.length)}function ei(n){return Wh(n)}function Wh(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?function(t){let r=Qt(t);return`time(${r.seconds},${r.nanos})`}(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?function(t){return Yt(t).toBase64()}(n.bytesValue):"referenceValue"in n?function(t){return F.fromName(t).toString()}(n.referenceValue):"geoPointValue"in n?function(t){return`geo(${t.latitude},${t.longitude})`}(n.geoPointValue):"arrayValue"in n?function(t){let r="[",i=!0;for(let s of t.values||[])i?i=!1:r+=",",r+=Wh(s);return r+"]"}(n.arrayValue):"mapValue"in n?function(t){let r=Object.keys(t.fields||{}).sort(),i="{",s=!0;for(let o of r)s?s=!1:i+=",",i+=`${o}:${Wh(t.fields[o])}`;return i+"}"}(n.mapValue):U(61005,{value:n})}function Da(n){switch(Tn(n)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:let e=vc(n);return e?16+Da(e):16;case 5:return 2*n.stringValue.length;case 6:return Yt(n.bytesValue).approximateByteSize();case 7:return n.referenceValue.length;case 9:return function(r){return(r.values||[]).reduce((i,s)=>i+Da(s),0)}(n.arrayValue);case 10:case 11:return function(r){let i=0;return Cn(r.fields,(s,o)=>{i+=s.length+Da(o)}),i}(n.mapValue);default:throw U(13486,{value:n})}}function H_(n,e){return{referenceValue:`projects/${n.projectId}/databases/${n.database}/documents/${e.path.canonicalString()}`}}function Gh(n){return!!n&&"integerValue"in n}function Df(n){return!!n&&"arrayValue"in n}function W_(n){return!!n&&"nullValue"in n}function G_(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function ka(n){return!!n&&"mapValue"in n}function Yv(n){var e,t;return((t=(((e=n?.mapValue)===null||e===void 0?void 0:e.fields)||{})[Cf])===null||t===void 0?void 0:t.stringValue)===Pf}function Ss(n){if(n.geoPointValue)return{geoPointValue:Object.assign({},n.geoPointValue)};if(n.timestampValue&&typeof n.timestampValue=="object")return{timestampValue:Object.assign({},n.timestampValue)};if(n.mapValue){let e={mapValue:{fields:{}}};return Cn(n.mapValue.fields,(t,r)=>e.mapValue.fields[t]=Ss(r)),e}if(n.arrayValue){let e={arrayValue:{values:[]}};for(let t=0;t<(n.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=Ss(n.arrayValue.values[t]);return e}return Object.assign({},n)}function Jv(n){return(((n.mapValue||{}).fields||{}).__type__||{}).stringValue===Qv}var s1={mapValue:{fields:{[Cf]:{stringValue:Pf},[Xr]:{arrayValue:{}}}}};var Je=class n{constructor(e){this.value=e}static empty(){return new n({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let r=0;r<e.length-1;++r)if(t=(t.mapValue.fields||{})[e.get(r)],!ka(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=Ss(t)}setAll(e){let t=Xe.emptyPath(),r={},i=[];e.forEach((o,c)=>{if(!t.isImmediateParentOf(c)){let u=this.getFieldsMap(t);this.applyChanges(u,r,i),r={},i=[],t=c.popLast()}o?r[c.lastSegment()]=Ss(o):i.push(c.lastSegment())});let s=this.getFieldsMap(t);this.applyChanges(s,r,i)}delete(e){let t=this.field(e.popLast());ka(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return Pt(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let r=0;r<e.length;++r){let i=t.mapValue.fields[e.get(r)];ka(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},t.mapValue.fields[e.get(r)]=i),t=i}return t.mapValue.fields}applyChanges(e,t,r){Cn(t,(i,s)=>e[i]=s);for(let i of r)delete e[i]}clone(){return new n(Ss(this.value))}};function Xv(n){let e=[];return Cn(n.fields,(t,r)=>{let i=new Xe([t]);if(ka(r)){let s=Xv(r.mapValue).fields;if(s.length===0)e.push(i);else for(let o of s)e.push(i.child(o))}else e.push(i)}),new rt(e)}var pt=class n{constructor(e,t,r,i,s,o,c){this.key=e,this.documentType=t,this.version=r,this.readTime=i,this.createTime=s,this.data=o,this.documentState=c}static newInvalidDocument(e){return new n(e,0,W.min(),W.min(),W.min(),Je.empty(),0)}static newFoundDocument(e,t,r,i){return new n(e,1,t,W.min(),r,i,0)}static newNoDocument(e,t){return new n(e,2,t,W.min(),W.min(),Je.empty(),0)}static newUnknownDocument(e,t){return new n(e,3,t,W.min(),W.min(),Je.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(W.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Je.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Je.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=W.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof n&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new n(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}};var ti=class{constructor(e,t){this.position=e,this.inclusive=t}};function K_(n,e,t){let r=0;for(let i=0;i<n.position.length;i++){let s=e[i],o=n.position[i];if(s.field.isKeyField()?r=F.comparator(F.fromName(o.referenceValue),t.key):r=Zr(o,t.data.field(s.field)),s.dir==="desc"&&(r*=-1),r!==0)break}return r}function Q_(n,e){if(n===null)return e===null;if(e===null||n.inclusive!==e.inclusive||n.position.length!==e.position.length)return!1;for(let t=0;t<n.position.length;t++)if(!Pt(n.position[t],e.position[t]))return!1;return!0}var rr=class{constructor(e,t="asc"){this.field=e,this.dir=t}};function Q0(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}var $a=class{},_e=class n extends $a{constructor(e,t,r){super(),this.field=e,this.op=t,this.value=r}static create(e,t,r){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,r):new Qh(e,t,r):t==="array-contains"?new Xh(e,r):t==="in"?new Zh(e,r):t==="not-in"?new ed(e,r):t==="array-contains-any"?new td(e,r):new n(e,t,r)}static createKeyFieldInFilter(e,t,r){return t==="in"?new Yh(e,r):new Jh(e,r)}matches(e){let t=e.data.field(this.field);return this.op==="!="?t!==null&&t.nullValue===void 0&&this.matchesComparison(Zr(t,this.value)):t!==null&&Tn(this.value)===Tn(t)&&this.matchesComparison(Zr(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return U(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}},gt=class n extends $a{constructor(e,t){super(),this.filters=e,this.op=t,this.Te=null}static create(e,t){return new n(e,t)}matches(e){return Zv(this)?this.filters.find(t=>!t.matches(e))===void 0:this.filters.find(t=>t.matches(e))!==void 0}getFlattenedFilters(){return this.Te!==null||(this.Te=this.filters.reduce((e,t)=>e.concat(t.getFlattenedFilters()),[])),this.Te}getFilters(){return Object.assign([],this.filters)}};function Zv(n){return n.op==="and"}function eI(n){return Y0(n)&&Zv(n)}function Y0(n){for(let e of n.filters)if(e instanceof gt)return!1;return!0}function Kh(n){if(n instanceof _e)return n.field.canonicalString()+n.op.toString()+ei(n.value);if(eI(n))return n.filters.map(e=>Kh(e)).join(",");{let e=n.filters.map(t=>Kh(t)).join(",");return`${n.op}(${e})`}}function tI(n,e){return n instanceof _e?function(r,i){return i instanceof _e&&r.op===i.op&&r.field.isEqual(i.field)&&Pt(r.value,i.value)}(n,e):n instanceof gt?function(r,i){return i instanceof gt&&r.op===i.op&&r.filters.length===i.filters.length?r.filters.reduce((s,o,c)=>s&&tI(o,i.filters[c]),!0):!1}(n,e):void U(19439)}function nI(n){return n instanceof _e?function(t){return`${t.field.canonicalString()} ${t.op} ${ei(t.value)}`}(n):n instanceof gt?function(t){return t.op.toString()+" {"+t.getFilters().map(nI).join(" ,")+"}"}(n):"Filter"}var Qh=class extends _e{constructor(e,t,r){super(e,t,r),this.key=F.fromName(r.referenceValue)}matches(e){let t=F.comparator(e.key,this.key);return this.matchesComparison(t)}},Yh=class extends _e{constructor(e,t){super(e,"in",t),this.keys=rI("in",t)}matches(e){return this.keys.some(t=>t.isEqual(e.key))}},Jh=class extends _e{constructor(e,t){super(e,"not-in",t),this.keys=rI("not-in",t)}matches(e){return!this.keys.some(t=>t.isEqual(e.key))}};function rI(n,e){var t;return(((t=e.arrayValue)===null||t===void 0?void 0:t.values)||[]).map(r=>F.fromName(r.referenceValue))}var Xh=class extends _e{constructor(e,t){super(e,"array-contains",t)}matches(e){let t=e.data.field(this.field);return Df(t)&&Ns(t.arrayValue,this.value)}},Zh=class extends _e{constructor(e,t){super(e,"in",t)}matches(e){let t=e.data.field(this.field);return t!==null&&Ns(this.value.arrayValue,t)}},ed=class extends _e{constructor(e,t){super(e,"not-in",t)}matches(e){if(Ns(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;let t=e.data.field(this.field);return t!==null&&t.nullValue===void 0&&!Ns(this.value.arrayValue,t)}},td=class extends _e{constructor(e,t){super(e,"array-contains-any",t)}matches(e){let t=e.data.field(this.field);return!(!Df(t)||!t.arrayValue.values)&&t.arrayValue.values.some(r=>Ns(this.value.arrayValue,r))}};var nd=class{constructor(e,t=null,r=[],i=[],s=null,o=null,c=null){this.path=e,this.collectionGroup=t,this.orderBy=r,this.filters=i,this.limit=s,this.startAt=o,this.endAt=c,this.Ie=null}};function Y_(n,e=null,t=[],r=[],i=null,s=null,o=null){return new nd(n,e,t,r,i,s,o)}function kf(n){let e=H(n);if(e.Ie===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map(r=>Kh(r)).join(","),t+="|ob:",t+=e.orderBy.map(r=>function(s){return s.field.canonicalString()+s.dir}(r)).join(","),_c(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map(r=>ei(r)).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map(r=>ei(r)).join(",")),e.Ie=t}return e.Ie}function Nf(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<n.orderBy.length;t++)if(!Q0(n.orderBy[t],e.orderBy[t]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let t=0;t<n.filters.length;t++)if(!tI(n.filters[t],e.filters[t]))return!1;return n.collectionGroup===e.collectionGroup&&!!n.path.isEqual(e.path)&&!!Q_(n.startAt,e.startAt)&&Q_(n.endAt,e.endAt)}function rd(n){return F.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}var An=class{constructor(e,t=null,r=[],i=[],s=null,o="F",c=null,u=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=r,this.filters=i,this.limit=s,this.limitType=o,this.startAt=c,this.endAt=u,this.Ee=null,this.de=null,this.Ae=null,this.startAt,this.endAt}};function J0(n,e,t,r,i,s,o,c){return new An(n,e,t,r,i,s,o,c)}function Ic(n){return new An(n)}function J_(n){return n.filters.length===0&&n.limit===null&&n.startAt==null&&n.endAt==null&&(n.explicitOrderBy.length===0||n.explicitOrderBy.length===1&&n.explicitOrderBy[0].field.isKeyField())}function iI(n){return n.collectionGroup!==null}function bs(n){let e=H(n);if(e.Ee===null){e.Ee=[];let t=new Set;for(let s of e.explicitOrderBy)e.Ee.push(s),t.add(s.field.canonicalString());let r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(o){let c=new Ae(Xe.comparator);return o.filters.forEach(u=>{u.getFlattenedFilters().forEach(h=>{h.isInequality()&&(c=c.add(h.field))})}),c})(e).forEach(s=>{t.has(s.canonicalString())||s.isKeyField()||e.Ee.push(new rr(s,r))}),t.has(Xe.keyField().canonicalString())||e.Ee.push(new rr(Xe.keyField(),r))}return e.Ee}function bt(n){let e=H(n);return e.de||(e.de=X0(e,bs(n))),e.de}function X0(n,e){if(n.limitType==="F")return Y_(n.path,n.collectionGroup,e,n.filters,n.limit,n.startAt,n.endAt);{e=e.map(i=>{let s=i.dir==="desc"?"asc":"desc";return new rr(i.field,s)});let t=n.endAt?new ti(n.endAt.position,n.endAt.inclusive):null,r=n.startAt?new ti(n.startAt.position,n.startAt.inclusive):null;return Y_(n.path,n.collectionGroup,e,n.filters,n.limit,t,r)}}function id(n,e){let t=n.filters.concat([e]);return new An(n.path,n.collectionGroup,n.explicitOrderBy.slice(),t,n.limit,n.limitType,n.startAt,n.endAt)}function sd(n,e,t){return new An(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,t,n.startAt,n.endAt)}function wc(n,e){return Nf(bt(n),bt(e))&&n.limitType===e.limitType}function sI(n){return`${kf(bt(n))}|lt:${n.limitType}`}function zr(n){return`Query(target=${function(t){let r=t.path.canonicalString();return t.collectionGroup!==null&&(r+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(r+=`, filters: [${t.filters.map(i=>nI(i)).join(", ")}]`),_c(t.limit)||(r+=", limit: "+t.limit),t.orderBy.length>0&&(r+=`, orderBy: [${t.orderBy.map(i=>function(o){return`${o.field.canonicalString()} (${o.dir})`}(i)).join(", ")}]`),t.startAt&&(r+=", startAt: ",r+=t.startAt.inclusive?"b:":"a:",r+=t.startAt.position.map(i=>ei(i)).join(",")),t.endAt&&(r+=", endAt: ",r+=t.endAt.inclusive?"a:":"b:",r+=t.endAt.position.map(i=>ei(i)).join(",")),`Target(${r})`}(bt(n))}; limitType=${n.limitType})`}function Ec(n,e){return e.isFoundDocument()&&function(r,i){let s=i.key.path;return r.collectionGroup!==null?i.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(s):F.isDocumentKey(r.path)?r.path.isEqual(s):r.path.isImmediateParentOf(s)}(n,e)&&function(r,i){for(let s of bs(r))if(!s.field.isKeyField()&&i.data.field(s.field)===null)return!1;return!0}(n,e)&&function(r,i){for(let s of r.filters)if(!s.matches(i))return!1;return!0}(n,e)&&function(r,i){return!(r.startAt&&!function(o,c,u){let h=K_(o,c,u);return o.inclusive?h<=0:h<0}(r.startAt,bs(r),i)||r.endAt&&!function(o,c,u){let h=K_(o,c,u);return o.inclusive?h>=0:h>0}(r.endAt,bs(r),i))}(n,e)}function Z0(n){return n.collectionGroup||(n.path.length%2==1?n.path.lastSegment():n.path.get(n.path.length-2))}function oI(n){return(e,t)=>{let r=!1;for(let i of bs(n)){let s=eC(i,e,t);if(s!==0)return s;r=r||i.field.isKeyField()}return 0}}function eC(n,e,t){let r=n.field.isKeyField()?F.comparator(e.key,t.key):function(s,o,c){let u=o.data.field(s),h=c.data.field(s);return u!==null&&h!==null?Zr(u,h):U(42886)}(n.field,e,t);switch(n.dir){case"asc":return r;case"desc":return-1*r;default:return U(19790,{direction:n.dir})}}var Jt=class{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){let t=this.mapKeyFn(e),r=this.inner[t];if(r!==void 0){for(let[i,s]of r)if(this.equalsFn(i,e))return s}}has(e){return this.get(e)!==void 0}set(e,t){let r=this.mapKeyFn(e),i=this.inner[r];if(i===void 0)return this.inner[r]=[[e,t]],void this.innerSize++;for(let s=0;s<i.length;s++)if(this.equalsFn(i[s][0],e))return void(i[s]=[e,t]);i.push([e,t]),this.innerSize++}delete(e){let t=this.mapKeyFn(e),r=this.inner[t];if(r===void 0)return!1;for(let i=0;i<r.length;i++)if(this.equalsFn(r[i][0],e))return r.length===1?delete this.inner[t]:r.splice(i,1),this.innerSize--,!0;return!1}forEach(e){Cn(this.inner,(t,r)=>{for(let[i,s]of r)e(i,s)})}isEmpty(){return zv(this.inner)}size(){return this.innerSize}};var tC=new ge(F.comparator);function Xt(){return tC}var aI=new ge(F.comparator);function As(...n){let e=aI;for(let t of n)e=e.insert(t.key,t);return e}function cI(n){let e=aI;return n.forEach((t,r)=>e=e.insert(t,r.overlayedDocument)),e}function Xn(){return Rs()}function uI(){return Rs()}function Rs(){return new Jt(n=>n.toString(),(n,e)=>n.isEqual(e))}var nC=new ge(F.comparator),rC=new Ae(F.comparator);function Y(...n){let e=rC;for(let t of n)e=e.add(t);return e}var iC=new Ae(K);function sC(){return iC}function Of(n,e){if(n.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Ds(e)?"-0":e}}function lI(n){return{integerValue:""+n}}function oC(n,e){return M0(e)?lI(e):Of(n,e)}var ni=class{constructor(){this._=void 0}};function aC(n,e,t){return n instanceof ir?function(i,s){let o={fields:{[Wv]:{stringValue:Hv},[Kv]:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return s&&Rf(s)&&(s=vc(s)),s&&(o.fields[Gv]=s),{mapValue:o}}(t,e):n instanceof Sn?dI(n,e):n instanceof sr?fI(n,e):function(i,s){let o=hI(i,s),c=X_(o)+X_(i.Re);return Gh(o)&&Gh(i.Re)?lI(c):Of(i.serializer,c)}(n,e)}function cC(n,e,t){return n instanceof Sn?dI(n,e):n instanceof sr?fI(n,e):t}function hI(n,e){return n instanceof ri?function(r){return Gh(r)||function(s){return!!s&&"doubleValue"in s}(r)}(e)?e:{integerValue:0}:null}var ir=class extends ni{},Sn=class extends ni{constructor(e){super(),this.elements=e}};function dI(n,e){let t=pI(e);for(let r of n.elements)t.some(i=>Pt(i,r))||t.push(r);return{arrayValue:{values:t}}}var sr=class extends ni{constructor(e){super(),this.elements=e}};function fI(n,e){let t=pI(e);for(let r of n.elements)t=t.filter(i=>!Pt(i,r));return{arrayValue:{values:t}}}var ri=class extends ni{constructor(e,t){super(),this.serializer=e,this.Re=t}};function X_(n){return le(n.integerValue||n.doubleValue)}function pI(n){return Df(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}var ja=class{constructor(e,t){this.field=e,this.transform=t}};function uC(n,e){return n.field.isEqual(e.field)&&function(r,i){return r instanceof Sn&&i instanceof Sn||r instanceof sr&&i instanceof sr?Jr(r.elements,i.elements,Pt):r instanceof ri&&i instanceof ri?Pt(r.Re,i.Re):r instanceof ir&&i instanceof ir}(n.transform,e.transform)}var od=class{constructor(e,t){this.version=e,this.transformResults=t}},Rt=class n{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new n}static exists(e){return new n(void 0,e)}static updateTime(e){return new n(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}};function Na(n,e){return n.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(n.updateTime):n.exists===void 0||n.exists===e.isFoundDocument()}var ii=class{};function gI(n,e){if(!n.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return n.isNoDocument()?new Os(n.key,Rt.none()):new or(n.key,n.data,Rt.none());{let t=n.data,r=Je.empty(),i=new Ae(Xe.comparator);for(let s of e.fields)if(!i.has(s)){let o=t.field(s);o===null&&s.length>1&&(s=s.popLast(),o=t.field(s)),o===null?r.delete(s):r.set(s,o),i=i.add(s)}return new Dt(n.key,r,new rt(i.toArray()),Rt.none())}}function lC(n,e,t){n instanceof or?function(i,s,o){let c=i.value.clone(),u=ev(i.fieldTransforms,s,o.transformResults);c.setAll(u),s.convertToFoundDocument(o.version,c).setHasCommittedMutations()}(n,e,t):n instanceof Dt?function(i,s,o){if(!Na(i.precondition,s))return void s.convertToUnknownDocument(o.version);let c=ev(i.fieldTransforms,s,o.transformResults),u=s.data;u.setAll(mI(i)),u.setAll(c),s.convertToFoundDocument(o.version,u).setHasCommittedMutations()}(n,e,t):function(i,s,o){s.convertToNoDocument(o.version).setHasCommittedMutations()}(0,e,t)}function Cs(n,e,t,r){return n instanceof or?function(s,o,c,u){if(!Na(s.precondition,o))return c;let h=s.value.clone(),f=tv(s.fieldTransforms,u,o);return h.setAll(f),o.convertToFoundDocument(o.version,h).setHasLocalMutations(),null}(n,e,t,r):n instanceof Dt?function(s,o,c,u){if(!Na(s.precondition,o))return c;let h=tv(s.fieldTransforms,u,o),f=o.data;return f.setAll(mI(s)),f.setAll(h),o.convertToFoundDocument(o.version,f).setHasLocalMutations(),c===null?null:c.unionWith(s.fieldMask.fields).unionWith(s.fieldTransforms.map(g=>g.field))}(n,e,t,r):function(s,o,c){return Na(s.precondition,o)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):c}(n,e,t)}function hC(n,e){let t=null;for(let r of n.fieldTransforms){let i=e.data.field(r.field),s=hI(r.transform,i||null);s!=null&&(t===null&&(t=Je.empty()),t.set(r.field,s))}return t||null}function Z_(n,e){return n.type===e.type&&!!n.key.isEqual(e.key)&&!!n.precondition.isEqual(e.precondition)&&!!function(r,i){return r===void 0&&i===void 0||!(!r||!i)&&Jr(r,i,(s,o)=>uC(s,o))}(n.fieldTransforms,e.fieldTransforms)&&(n.type===0?n.value.isEqual(e.value):n.type!==1||n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask))}var or=class extends ii{constructor(e,t,r,i=[]){super(),this.key=e,this.value=t,this.precondition=r,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}},Dt=class extends ii{constructor(e,t,r,i,s=[]){super(),this.key=e,this.data=t,this.fieldMask=r,this.precondition=i,this.fieldTransforms=s,this.type=1}getFieldMask(){return this.fieldMask}};function mI(n){let e=new Map;return n.fieldMask.fields.forEach(t=>{if(!t.isEmpty()){let r=n.data.field(t);e.set(t,r)}}),e}function ev(n,e,t){let r=new Map;ne(n.length===t.length,32656,{Ve:t.length,me:n.length});for(let i=0;i<t.length;i++){let s=n[i],o=s.transform,c=e.data.field(s.field);r.set(s.field,cC(o,c,t[i]))}return r}function tv(n,e,t){let r=new Map;for(let i of n){let s=i.transform,o=t.data.field(i.field);r.set(i.field,aC(s,o,e))}return r}var Os=class extends ii{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}},ad=class extends ii{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}};var cd=class{constructor(e,t,r,i){this.batchId=e,this.localWriteTime=t,this.baseMutations=r,this.mutations=i}applyToRemoteDocument(e,t){let r=t.mutationResults;for(let i=0;i<this.mutations.length;i++){let s=this.mutations[i];s.key.isEqual(e.key)&&lC(s,e,r[i])}}applyToLocalView(e,t){for(let r of this.baseMutations)r.key.isEqual(e.key)&&(t=Cs(r,e,t,this.localWriteTime));for(let r of this.mutations)r.key.isEqual(e.key)&&(t=Cs(r,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){let r=uI();return this.mutations.forEach(i=>{let s=e.get(i.key),o=s.overlayedDocument,c=this.applyToLocalView(o,s.mutatedFields);c=t.has(i.key)?null:c;let u=gI(o,c);u!==null&&r.set(i.key,u),o.isValidDocument()||o.convertToNoDocument(W.min())}),r}keys(){return this.mutations.reduce((e,t)=>e.add(t.key),Y())}isEqual(e){return this.batchId===e.batchId&&Jr(this.mutations,e.mutations,(t,r)=>Z_(t,r))&&Jr(this.baseMutations,e.baseMutations,(t,r)=>Z_(t,r))}},ud=class n{constructor(e,t,r,i){this.batch=e,this.commitVersion=t,this.mutationResults=r,this.docVersions=i}static from(e,t,r){ne(e.mutations.length===r.length,58842,{fe:e.mutations.length,ge:r.length});let i=function(){return nC}(),s=e.mutations;for(let o=0;o<s.length;o++)i=i.insert(s[o].key,r[o].version);return new n(e,t,r,i)}};var ld=class{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}};var hd=class{constructor(e,t){this.count=e,this.unchangedNames=t}};var me,J;function dC(n){switch(n){case C.OK:return U(64938);case C.CANCELLED:case C.UNKNOWN:case C.DEADLINE_EXCEEDED:case C.RESOURCE_EXHAUSTED:case C.INTERNAL:case C.UNAVAILABLE:case C.UNAUTHENTICATED:return!1;case C.INVALID_ARGUMENT:case C.NOT_FOUND:case C.ALREADY_EXISTS:case C.PERMISSION_DENIED:case C.FAILED_PRECONDITION:case C.ABORTED:case C.OUT_OF_RANGE:case C.UNIMPLEMENTED:case C.DATA_LOSS:return!0;default:return U(15467,{code:n})}}function yI(n){if(n===void 0)return Kt("GRPC error has no .code"),C.UNKNOWN;switch(n){case me.OK:return C.OK;case me.CANCELLED:return C.CANCELLED;case me.UNKNOWN:return C.UNKNOWN;case me.DEADLINE_EXCEEDED:return C.DEADLINE_EXCEEDED;case me.RESOURCE_EXHAUSTED:return C.RESOURCE_EXHAUSTED;case me.INTERNAL:return C.INTERNAL;case me.UNAVAILABLE:return C.UNAVAILABLE;case me.UNAUTHENTICATED:return C.UNAUTHENTICATED;case me.INVALID_ARGUMENT:return C.INVALID_ARGUMENT;case me.NOT_FOUND:return C.NOT_FOUND;case me.ALREADY_EXISTS:return C.ALREADY_EXISTS;case me.PERMISSION_DENIED:return C.PERMISSION_DENIED;case me.FAILED_PRECONDITION:return C.FAILED_PRECONDITION;case me.ABORTED:return C.ABORTED;case me.OUT_OF_RANGE:return C.OUT_OF_RANGE;case me.UNIMPLEMENTED:return C.UNIMPLEMENTED;case me.DATA_LOSS:return C.DATA_LOSS;default:return U(39323,{code:n})}}(J=me||(me={}))[J.OK=0]="OK",J[J.CANCELLED=1]="CANCELLED",J[J.UNKNOWN=2]="UNKNOWN",J[J.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",J[J.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",J[J.NOT_FOUND=5]="NOT_FOUND",J[J.ALREADY_EXISTS=6]="ALREADY_EXISTS",J[J.PERMISSION_DENIED=7]="PERMISSION_DENIED",J[J.UNAUTHENTICATED=16]="UNAUTHENTICATED",J[J.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",J[J.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",J[J.ABORTED=10]="ABORTED",J[J.OUT_OF_RANGE=11]="OUT_OF_RANGE",J[J.UNIMPLEMENTED=12]="UNIMPLEMENTED",J[J.INTERNAL=13]="INTERNAL",J[J.UNAVAILABLE=14]="UNAVAILABLE",J[J.DATA_LOSS=15]="DATA_LOSS";var nv=null;var fC=new Wt([4294967295,4294967295],0);function rv(n){let e=Pv().encode(n),t=new bh;return t.update(e),new Uint8Array(t.digest())}function iv(n){let e=new DataView(n.buffer),t=e.getUint32(0,!0),r=e.getUint32(4,!0),i=e.getUint32(8,!0),s=e.getUint32(12,!0);return[new Wt([t,r],0),new Wt([i,s],0)]}var dd=class n{constructor(e,t,r){if(this.bitmap=e,this.padding=t,this.hashCount=r,t<0||t>=8)throw new Zn(`Invalid padding: ${t}`);if(r<0)throw new Zn(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new Zn(`Invalid hash count: ${r}`);if(e.length===0&&t!==0)throw new Zn(`Invalid padding when bitmap length is 0: ${t}`);this.pe=8*e.length-t,this.ye=Wt.fromNumber(this.pe)}we(e,t,r){let i=e.add(t.multiply(Wt.fromNumber(r)));return i.compare(fC)===1&&(i=new Wt([i.getBits(0),i.getBits(1)],0)),i.modulo(this.ye).toNumber()}Se(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.pe===0)return!1;let t=rv(e),[r,i]=iv(t);for(let s=0;s<this.hashCount;s++){let o=this.we(r,i,s);if(!this.Se(o))return!1}return!0}static create(e,t,r){let i=e%8==0?0:8-e%8,s=new Uint8Array(Math.ceil(e/8)),o=new n(s,i,t);return r.forEach(c=>o.insert(c)),o}insert(e){if(this.pe===0)return;let t=rv(e),[r,i]=iv(t);for(let s=0;s<this.hashCount;s++){let o=this.we(r,i,s);this.be(o)}}be(e){let t=Math.floor(e/8),r=e%8;this.bitmap[t]|=1<<r}},Zn=class extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}};var qa=class n{constructor(e,t,r,i,s){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=r,this.documentUpdates=i,this.resolvedLimboDocuments=s}static createSynthesizedRemoteEventForCurrentChange(e,t,r){let i=new Map;return i.set(e,xs.createSynthesizedTargetChangeForCurrentChange(e,t,r)),new n(W.min(),i,new ge(K),Xt(),Y())}},xs=class n{constructor(e,t,r,i,s){this.resumeToken=e,this.current=t,this.addedDocuments=r,this.modifiedDocuments=i,this.removedDocuments=s}static createSynthesizedTargetChangeForCurrentChange(e,t,r){return new n(r,t,Y(),Y(),Y())}};var Kr=class{constructor(e,t,r,i){this.De=e,this.removedTargetIds=t,this.key=r,this.ve=i}},za=class{constructor(e,t){this.targetId=e,this.Ce=t}},Ha=class{constructor(e,t,r=Ve.EMPTY_BYTE_STRING,i=null){this.state=e,this.targetIds=t,this.resumeToken=r,this.cause=i}},Wa=class{constructor(){this.Fe=0,this.Me=sv(),this.xe=Ve.EMPTY_BYTE_STRING,this.Oe=!1,this.Ne=!0}get current(){return this.Oe}get resumeToken(){return this.xe}get Be(){return this.Fe!==0}get Le(){return this.Ne}ke(e){e.approximateByteSize()>0&&(this.Ne=!0,this.xe=e)}qe(){let e=Y(),t=Y(),r=Y();return this.Me.forEach((i,s)=>{switch(s){case 0:e=e.add(i);break;case 2:t=t.add(i);break;case 1:r=r.add(i);break;default:U(38017,{changeType:s})}}),new xs(this.xe,this.Oe,e,t,r)}Qe(){this.Ne=!1,this.Me=sv()}$e(e,t){this.Ne=!0,this.Me=this.Me.insert(e,t)}Ue(e){this.Ne=!0,this.Me=this.Me.remove(e)}Ke(){this.Fe+=1}We(){this.Fe-=1,ne(this.Fe>=0,3241,{Fe:this.Fe})}Ge(){this.Ne=!0,this.Oe=!0}},fd=class{constructor(e){this.ze=e,this.je=new Map,this.He=Xt(),this.Je=Ca(),this.Ye=Ca(),this.Ze=new ge(K)}Xe(e){for(let t of e.De)e.ve&&e.ve.isFoundDocument()?this.et(t,e.ve):this.tt(t,e.key,e.ve);for(let t of e.removedTargetIds)this.tt(t,e.key,e.ve)}nt(e){this.forEachTarget(e,t=>{let r=this.rt(t);switch(e.state){case 0:this.it(t)&&r.ke(e.resumeToken);break;case 1:r.We(),r.Be||r.Qe(),r.ke(e.resumeToken);break;case 2:r.We(),r.Be||this.removeTarget(t);break;case 3:this.it(t)&&(r.Ge(),r.ke(e.resumeToken));break;case 4:this.it(t)&&(this.st(t),r.ke(e.resumeToken));break;default:U(56790,{state:e.state})}})}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.je.forEach((r,i)=>{this.it(i)&&t(i)})}ot(e){let t=e.targetId,r=e.Ce.count,i=this._t(t);if(i){let s=i.target;if(rd(s))if(r===0){let o=new F(s.path);this.tt(t,o,pt.newNoDocument(o,W.min()))}else ne(r===1,20013,{expectedCount:r});else{let o=this.ut(t);if(o!==r){let c=this.ct(e),u=c?this.lt(c,e,o):1;if(u!==0){this.st(t);let h=u===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ze=this.Ze.insert(t,h)}nv?.ht(function(f,g,_,b,P){var O,k,z,$,q,se;let Fe={localCacheCount:f,existenceFilterCount:g.count,databaseId:_.database,projectId:_.projectId},re=g.unchangedNames;return re&&(Fe.bloomFilter={applied:P===0,hashCount:(O=re?.hashCount)!==null&&O!==void 0?O:0,bitmapLength:($=(z=(k=re?.bits)===null||k===void 0?void 0:k.bitmap)===null||z===void 0?void 0:z.length)!==null&&$!==void 0?$:0,padding:(se=(q=re?.bits)===null||q===void 0?void 0:q.padding)!==null&&se!==void 0?se:0,mightContain:E=>{var m;return(m=b?.mightContain(E))!==null&&m!==void 0&&m}}),Fe}(o,e.Ce,this.ze.Pt(),c,u))}}}}ct(e){let t=e.Ce.unchangedNames;if(!t||!t.bits)return null;let{bits:{bitmap:r="",padding:i=0},hashCount:s=0}=t,o,c;try{o=Yt(r).toUint8Array()}catch(u){if(u instanceof Fa)return Yr("Decoding the base64 bloom filter in existence filter failed ("+u.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw u}try{c=new dd(o,i,s)}catch(u){return Yr(u instanceof Zn?"BloomFilter error: ":"Applying bloom filter failed: ",u),null}return c.pe===0?null:c}lt(e,t,r){return t.Ce.count===r-this.Tt(e,t.targetId)?0:2}Tt(e,t){let r=this.ze.getRemoteKeysForTarget(t),i=0;return r.forEach(s=>{let o=this.ze.Pt(),c=`projects/${o.projectId}/databases/${o.database}/documents/${s.path.canonicalString()}`;e.mightContain(c)||(this.tt(t,s,null),i++)}),i}It(e){let t=new Map;this.je.forEach((s,o)=>{let c=this._t(o);if(c){if(s.current&&rd(c.target)){let u=new F(c.target.path);this.Et(u).has(o)||this.dt(o,u)||this.tt(o,u,pt.newNoDocument(u,e))}s.Le&&(t.set(o,s.qe()),s.Qe())}});let r=Y();this.Ye.forEach((s,o)=>{let c=!0;o.forEachWhile(u=>{let h=this._t(u);return!h||h.purpose==="TargetPurposeLimboResolution"||(c=!1,!1)}),c&&(r=r.add(s))}),this.He.forEach((s,o)=>o.setReadTime(e));let i=new qa(e,t,this.Ze,this.He,r);return this.He=Xt(),this.Je=Ca(),this.Ye=Ca(),this.Ze=new ge(K),i}et(e,t){if(!this.it(e))return;let r=this.dt(e,t.key)?2:0;this.rt(e).$e(t.key,r),this.He=this.He.insert(t.key,t),this.Je=this.Je.insert(t.key,this.Et(t.key).add(e)),this.Ye=this.Ye.insert(t.key,this.At(t.key).add(e))}tt(e,t,r){if(!this.it(e))return;let i=this.rt(e);this.dt(e,t)?i.$e(t,1):i.Ue(t),this.Ye=this.Ye.insert(t,this.At(t).delete(e)),this.Ye=this.Ye.insert(t,this.At(t).add(e)),r&&(this.He=this.He.insert(t,r))}removeTarget(e){this.je.delete(e)}ut(e){let t=this.rt(e).qe();return this.ze.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}Ke(e){this.rt(e).Ke()}rt(e){let t=this.je.get(e);return t||(t=new Wa,this.je.set(e,t)),t}At(e){let t=this.Ye.get(e);return t||(t=new Ae(K),this.Ye=this.Ye.insert(e,t)),t}Et(e){let t=this.Je.get(e);return t||(t=new Ae(K),this.Je=this.Je.insert(e,t)),t}it(e){let t=this._t(e)!==null;return t||M("WatchChangeAggregator","Detected inactive target",e),t}_t(e){let t=this.je.get(e);return t&&t.Be?null:this.ze.Rt(e)}st(e){this.je.set(e,new Wa),this.ze.getRemoteKeysForTarget(e).forEach(t=>{this.tt(e,t,null)})}dt(e,t){return this.ze.getRemoteKeysForTarget(e).has(t)}};function Ca(){return new ge(F.comparator)}function sv(){return new ge(F.comparator)}var pC={asc:"ASCENDING",desc:"DESCENDING"},gC={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},mC={and:"AND",or:"OR"},pd=class{constructor(e,t){this.databaseId=e,this.useProto3Json=t}};function gd(n,e){return n.useProto3Json||_c(e)?e:{value:e}}function Ga(n,e){return n.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function _I(n,e){return n.useProto3Json?e.toBase64():e.toUint8Array()}function yC(n,e){return Ga(n,e.toTimestamp())}function Ct(n){return ne(!!n,49232),W.fromTimestamp(function(t){let r=Qt(t);return new Re(r.seconds,r.nanos)}(n))}function xf(n,e){return md(n,e).canonicalString()}function md(n,e){let t=function(i){return new he(["projects",i.projectId,"databases",i.database])}(n).child("documents");return e===void 0?t:t.child(e)}function vI(n){let e=he.fromString(n);return ne(AI(e),10190,{key:e.toString()}),e}function yd(n,e){return xf(n.databaseId,e.path)}function Nh(n,e){let t=vI(e);if(t.get(1)!==n.databaseId.projectId)throw new x(C.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+n.databaseId.projectId);if(t.get(3)!==n.databaseId.database)throw new x(C.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+n.databaseId.database);return new F(wI(t))}function II(n,e){return xf(n.databaseId,e)}function _C(n){let e=vI(n);return e.length===4?he.emptyPath():wI(e)}function _d(n){return new he(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function wI(n){return ne(n.length>4&&n.get(4)==="documents",29091,{key:n.toString()}),n.popFirst(5)}function ov(n,e,t){return{name:yd(n,e),fields:t.value.mapValue.fields}}function vC(n,e){let t;if("targetChange"in e){e.targetChange;let r=function(h){return h==="NO_CHANGE"?0:h==="ADD"?1:h==="REMOVE"?2:h==="CURRENT"?3:h==="RESET"?4:U(39313,{state:h})}(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],s=function(h,f){return h.useProto3Json?(ne(f===void 0||typeof f=="string",58123),Ve.fromBase64String(f||"")):(ne(f===void 0||f instanceof Buffer||f instanceof Uint8Array,16193),Ve.fromUint8Array(f||new Uint8Array))}(n,e.targetChange.resumeToken),o=e.targetChange.cause,c=o&&function(h){let f=h.code===void 0?C.UNKNOWN:yI(h.code);return new x(f,h.message||"")}(o);t=new Ha(r,i,s,c||null)}else if("documentChange"in e){e.documentChange;let r=e.documentChange;r.document,r.document.name,r.document.updateTime;let i=Nh(n,r.document.name),s=Ct(r.document.updateTime),o=r.document.createTime?Ct(r.document.createTime):W.min(),c=new Je({mapValue:{fields:r.document.fields}}),u=pt.newFoundDocument(i,s,o,c),h=r.targetIds||[],f=r.removedTargetIds||[];t=new Kr(h,f,u.key,u)}else if("documentDelete"in e){e.documentDelete;let r=e.documentDelete;r.document;let i=Nh(n,r.document),s=r.readTime?Ct(r.readTime):W.min(),o=pt.newNoDocument(i,s),c=r.removedTargetIds||[];t=new Kr([],c,o.key,o)}else if("documentRemove"in e){e.documentRemove;let r=e.documentRemove;r.document;let i=Nh(n,r.document),s=r.removedTargetIds||[];t=new Kr([],s,i,null)}else{if(!("filter"in e))return U(11601,{Vt:e});{e.filter;let r=e.filter;r.targetId;let{count:i=0,unchangedNames:s}=r,o=new hd(i,s),c=r.targetId;t=new za(c,o)}}return t}function IC(n,e){let t;if(e instanceof or)t={update:ov(n,e.key,e.value)};else if(e instanceof Os)t={delete:yd(n,e.key)};else if(e instanceof Dt)t={update:ov(n,e.key,e.data),updateMask:PC(e.fieldMask)};else{if(!(e instanceof ad))return U(16599,{ft:e.type});t={verify:yd(n,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map(r=>function(s,o){let c=o.transform;if(c instanceof ir)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(c instanceof Sn)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:c.elements}};if(c instanceof sr)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:c.elements}};if(c instanceof ri)return{fieldPath:o.field.canonicalString(),increment:c.Re};throw U(20930,{transform:o.transform})}(0,r))),e.precondition.isNone||(t.currentDocument=function(i,s){return s.updateTime!==void 0?{updateTime:yC(i,s.updateTime)}:s.exists!==void 0?{exists:s.exists}:U(27497)}(n,e.precondition)),t}function wC(n,e){return n&&n.length>0?(ne(e!==void 0,14353),n.map(t=>function(i,s){let o=i.updateTime?Ct(i.updateTime):Ct(s);return o.isEqual(W.min())&&(o=Ct(s)),new od(o,i.transformResults||[])}(t,e))):[]}function EC(n,e){return{documents:[II(n,e.path)]}}function TC(n,e){let t={structuredQuery:{}},r=e.path,i;e.collectionGroup!==null?(i=r,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(i=r.popLast(),t.structuredQuery.from=[{collectionId:r.lastSegment()}]),t.parent=II(n,i);let s=function(h){if(h.length!==0)return TI(gt.create(h,"and"))}(e.filters);s&&(t.structuredQuery.where=s);let o=function(h){if(h.length!==0)return h.map(f=>function(_){return{field:Hr(_.field),direction:bC(_.dir)}}(f))}(e.orderBy);o&&(t.structuredQuery.orderBy=o);let c=gd(n,e.limit);return c!==null&&(t.structuredQuery.limit=c),e.startAt&&(t.structuredQuery.startAt=function(h){return{before:h.inclusive,values:h.position}}(e.startAt)),e.endAt&&(t.structuredQuery.endAt=function(h){return{before:!h.inclusive,values:h.position}}(e.endAt)),{gt:t,parent:i}}function AC(n){let e=_C(n.parent),t=n.structuredQuery,r=t.from?t.from.length:0,i=null;if(r>0){ne(r===1,65062);let f=t.from[0];f.allDescendants?i=f.collectionId:e=e.child(f.collectionId)}let s=[];t.where&&(s=function(g){let _=EI(g);return _ instanceof gt&&eI(_)?_.getFilters():[_]}(t.where));let o=[];t.orderBy&&(o=function(g){return g.map(_=>function(P){return new rr(Wr(P.field),function(k){switch(k){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(P.direction))}(_))}(t.orderBy));let c=null;t.limit&&(c=function(g){let _;return _=typeof g=="object"?g.value:g,_c(_)?null:_}(t.limit));let u=null;t.startAt&&(u=function(g){let _=!!g.before,b=g.values||[];return new ti(b,_)}(t.startAt));let h=null;return t.endAt&&(h=function(g){let _=!g.before,b=g.values||[];return new ti(b,_)}(t.endAt)),J0(e,i,o,s,c,"F",u,h)}function SC(n,e){let t=function(i){switch(i){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return U(28987,{purpose:i})}}(e.purpose);return t==null?null:{"goog-listen-tags":t}}function EI(n){return n.unaryFilter!==void 0?function(t){switch(t.unaryFilter.op){case"IS_NAN":let r=Wr(t.unaryFilter.field);return _e.create(r,"==",{doubleValue:NaN});case"IS_NULL":let i=Wr(t.unaryFilter.field);return _e.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":let s=Wr(t.unaryFilter.field);return _e.create(s,"!=",{doubleValue:NaN});case"IS_NOT_NULL":let o=Wr(t.unaryFilter.field);return _e.create(o,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return U(61313);default:return U(60726)}}(n):n.fieldFilter!==void 0?function(t){return _e.create(Wr(t.fieldFilter.field),function(i){switch(i){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return U(58110);default:return U(50506)}}(t.fieldFilter.op),t.fieldFilter.value)}(n):n.compositeFilter!==void 0?function(t){return gt.create(t.compositeFilter.filters.map(r=>EI(r)),function(i){switch(i){case"AND":return"and";case"OR":return"or";default:return U(1026)}}(t.compositeFilter.op))}(n):U(30097,{filter:n})}function bC(n){return pC[n]}function RC(n){return gC[n]}function CC(n){return mC[n]}function Hr(n){return{fieldPath:n.canonicalString()}}function Wr(n){return Xe.fromServerFormat(n.fieldPath)}function TI(n){return n instanceof _e?function(t){if(t.op==="=="){if(G_(t.value))return{unaryFilter:{field:Hr(t.field),op:"IS_NAN"}};if(W_(t.value))return{unaryFilter:{field:Hr(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(G_(t.value))return{unaryFilter:{field:Hr(t.field),op:"IS_NOT_NAN"}};if(W_(t.value))return{unaryFilter:{field:Hr(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Hr(t.field),op:RC(t.op),value:t.value}}}(n):n instanceof gt?function(t){let r=t.getFilters().map(i=>TI(i));return r.length===1?r[0]:{compositeFilter:{op:CC(t.op),filters:r}}}(n):U(54877,{filter:n})}function PC(n){let e=[];return n.fields.forEach(t=>e.push(t.canonicalString())),{fieldPaths:e}}function AI(n){return n.length>=4&&n.get(0)==="projects"&&n.get(2)==="databases"}var Ms=class n{constructor(e,t,r,i,s=W.min(),o=W.min(),c=Ve.EMPTY_BYTE_STRING,u=null){this.target=e,this.targetId=t,this.purpose=r,this.sequenceNumber=i,this.snapshotVersion=s,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=c,this.expectedCount=u}withSequenceNumber(e){return new n(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new n(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new n(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new n(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}};var vd=class{constructor(e){this.wt=e}};function DC(n){let e=AC({parent:n.parent,structuredQuery:n.structuredQuery});return n.limitType==="LAST"?sd(e,e.limit,"L"):e}var Ka=class{constructor(){}vt(e,t){this.Ct(e,t),t.Ft()}Ct(e,t){if("nullValue"in e)this.Mt(t,5);else if("booleanValue"in e)this.Mt(t,10),t.xt(e.booleanValue?1:0);else if("integerValue"in e)this.Mt(t,15),t.xt(le(e.integerValue));else if("doubleValue"in e){let r=le(e.doubleValue);isNaN(r)?this.Mt(t,13):(this.Mt(t,15),Ds(r)?t.xt(0):t.xt(r))}else if("timestampValue"in e){let r=e.timestampValue;this.Mt(t,20),typeof r=="string"&&(r=Qt(r)),t.Ot(`${r.seconds||""}`),t.xt(r.nanos||0)}else if("stringValue"in e)this.Nt(e.stringValue,t),this.Bt(t);else if("bytesValue"in e)this.Mt(t,30),t.Lt(Yt(e.bytesValue)),this.Bt(t);else if("referenceValue"in e)this.kt(e.referenceValue,t);else if("geoPointValue"in e){let r=e.geoPointValue;this.Mt(t,45),t.xt(r.latitude||0),t.xt(r.longitude||0)}else"mapValue"in e?Jv(e)?this.Mt(t,Number.MAX_SAFE_INTEGER):Yv(e)?this.qt(e.mapValue,t):(this.Qt(e.mapValue,t),this.Bt(t)):"arrayValue"in e?(this.$t(e.arrayValue,t),this.Bt(t)):U(19022,{Ut:e})}Nt(e,t){this.Mt(t,25),this.Kt(e,t)}Kt(e,t){t.Ot(e)}Qt(e,t){let r=e.fields||{};this.Mt(t,55);for(let i of Object.keys(r))this.Nt(i,t),this.Ct(r[i],t)}qt(e,t){var r,i;let s=e.fields||{};this.Mt(t,53);let o=Xr,c=((i=(r=s[o].arrayValue)===null||r===void 0?void 0:r.values)===null||i===void 0?void 0:i.length)||0;this.Mt(t,15),t.xt(le(c)),this.Nt(o,t),this.Ct(s[o],t)}$t(e,t){let r=e.values||[];this.Mt(t,50);for(let i of r)this.Ct(i,t)}kt(e,t){this.Mt(t,37),F.fromName(e).path.forEach(r=>{this.Mt(t,60),this.Kt(r,t)})}Mt(e,t){e.xt(t)}Bt(e){e.xt(2)}};Ka.Wt=new Ka;var Id=class{constructor(){this.Cn=new wd}addToCollectionParentIndex(e,t){return this.Cn.add(t),D.resolve()}getCollectionParents(e,t){return D.resolve(this.Cn.getEntries(t))}addFieldIndex(e,t){return D.resolve()}deleteFieldIndex(e,t){return D.resolve()}deleteAllFieldIndexes(e){return D.resolve()}createTargetIndexes(e,t){return D.resolve()}getDocumentsMatchingTarget(e,t){return D.resolve(null)}getIndexType(e,t){return D.resolve(0)}getFieldIndexes(e,t){return D.resolve([])}getNextCollectionGroupToUpdate(e){return D.resolve(null)}getMinOffset(e,t){return D.resolve(nr.min())}getMinOffsetFromCollectionGroup(e,t){return D.resolve(nr.min())}updateCollectionGroup(e,t,r){return D.resolve()}updateIndexEntries(e,t){return D.resolve()}},wd=class{constructor(){this.index={}}add(e){let t=e.lastSegment(),r=e.popLast(),i=this.index[t]||new Ae(he.comparator),s=!i.has(r);return this.index[t]=i.add(r),s}has(e){let t=e.lastSegment(),r=e.popLast(),i=this.index[t];return i&&i.has(r)}getEntries(e){return(this.index[e]||new Ae(he.comparator)).toArray()}};var o1=new Uint8Array(0);var av={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},SI=41943040,nt=class n{static withCacheSize(e){return new n(e,n.DEFAULT_COLLECTION_PERCENTILE,n.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,t,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=r}};nt.DEFAULT_COLLECTION_PERCENTILE=10,nt.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,nt.DEFAULT=new nt(SI,nt.DEFAULT_COLLECTION_PERCENTILE,nt.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),nt.DISABLED=new nt(-1,0,0);var Ls=class n{constructor(e){this.ur=e}next(){return this.ur+=2,this.ur}static cr(){return new n(0)}static lr(){return new n(-1)}};var cv="LruGarbageCollector",kC=1048576;function uv([n,e],[t,r]){let i=K(n,t);return i===0?K(e,r):i}var Ed=class{constructor(e){this.Er=e,this.buffer=new Ae(uv),this.dr=0}Ar(){return++this.dr}Rr(e){let t=[e,this.Ar()];if(this.buffer.size<this.Er)this.buffer=this.buffer.add(t);else{let r=this.buffer.last();uv(t,r)<0&&(this.buffer=this.buffer.delete(r).add(t))}}get maxValue(){return this.buffer.last()[0]}},Td=class{constructor(e,t,r){this.garbageCollector=e,this.asyncQueue=t,this.localStore=r,this.Vr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.mr(6e4)}stop(){this.Vr&&(this.Vr.cancel(),this.Vr=null)}get started(){return this.Vr!==null}mr(e){M(cv,`Garbage collection scheduled in ${e}ms`),this.Vr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,()=>y(this,null,function*(){this.Vr=null;try{yield this.localStore.collectGarbage(this.garbageCollector)}catch(t){li(t)?M(cv,"Ignoring IndexedDB error during garbage collection: ",t):yield ui(t)}yield this.mr(3e5)}))}},Ad=class{constructor(e,t){this.gr=e,this.params=t}calculateTargetCount(e,t){return this.gr.pr(e).next(r=>Math.floor(t/100*r))}nthSequenceNumber(e,t){if(t===0)return D.resolve(Sf.le);let r=new Ed(t);return this.gr.forEachTarget(e,i=>r.Rr(i.sequenceNumber)).next(()=>this.gr.yr(e,i=>r.Rr(i))).next(()=>r.maxValue)}removeTargets(e,t,r){return this.gr.removeTargets(e,t,r)}removeOrphanedDocuments(e,t){return this.gr.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===-1?(M("LruGarbageCollector","Garbage collection skipped; disabled"),D.resolve(av)):this.getCacheSize(e).next(r=>r<this.params.cacheSizeCollectionThreshold?(M("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),av):this.wr(e,t))}getCacheSize(e){return this.gr.getCacheSize(e)}wr(e,t){let r,i,s,o,c,u,h,f=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(g=>(g>this.params.maximumSequenceNumbersToCollect?(M("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${g}`),i=this.params.maximumSequenceNumbersToCollect):i=g,o=Date.now(),this.nthSequenceNumber(e,i))).next(g=>(r=g,c=Date.now(),this.removeTargets(e,r,t))).next(g=>(s=g,u=Date.now(),this.removeOrphanedDocuments(e,r))).next(g=>(h=Date.now(),qr()<=Q.DEBUG&&M("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${o-f}ms
	Determined least recently used ${i} in `+(c-o)+`ms
	Removed ${s} targets in `+(u-c)+`ms
	Removed ${g} documents in `+(h-u)+`ms
Total Duration: ${h-f}ms`),D.resolve({didRun:!0,sequenceNumbersCollected:i,targetsRemoved:s,documentsRemoved:g})))}};function NC(n,e){return new Ad(n,e)}var Sd=class{constructor(){this.changes=new Jt(e=>e.toString(),(e,t)=>e.isEqual(t)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,pt.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();let r=this.changes.get(t);return r!==void 0?D.resolve(r):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}};var bd=class{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}};var Rd=class{constructor(e,t,r,i){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=r,this.indexManager=i}getDocument(e,t){let r=null;return this.documentOverlayCache.getOverlay(e,t).next(i=>(r=i,this.remoteDocumentCache.getEntry(e,t))).next(i=>(r!==null&&Cs(r.mutation,i,rt.empty(),Re.now()),i))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next(r=>this.getLocalViewOfDocuments(e,r,Y()).next(()=>r))}getLocalViewOfDocuments(e,t,r=Y()){let i=Xn();return this.populateOverlays(e,i,t).next(()=>this.computeViews(e,t,i,r).next(s=>{let o=As();return s.forEach((c,u)=>{o=o.insert(c,u.overlayedDocument)}),o}))}getOverlayedDocuments(e,t){let r=Xn();return this.populateOverlays(e,r,t).next(()=>this.computeViews(e,t,r,Y()))}populateOverlays(e,t,r){let i=[];return r.forEach(s=>{t.has(s)||i.push(s)}),this.documentOverlayCache.getOverlays(e,i).next(s=>{s.forEach((o,c)=>{t.set(o,c)})})}computeViews(e,t,r,i){let s=Xt(),o=Rs(),c=function(){return Rs()}();return t.forEach((u,h)=>{let f=r.get(h.key);i.has(h.key)&&(f===void 0||f.mutation instanceof Dt)?s=s.insert(h.key,h):f!==void 0?(o.set(h.key,f.mutation.getFieldMask()),Cs(f.mutation,h,f.mutation.getFieldMask(),Re.now())):o.set(h.key,rt.empty())}),this.recalculateAndSaveOverlays(e,s).next(u=>(u.forEach((h,f)=>o.set(h,f)),t.forEach((h,f)=>{var g;return c.set(h,new bd(f,(g=o.get(h))!==null&&g!==void 0?g:null))}),c))}recalculateAndSaveOverlays(e,t){let r=Rs(),i=new ge((o,c)=>o-c),s=Y();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next(o=>{for(let c of o)c.keys().forEach(u=>{let h=t.get(u);if(h===null)return;let f=r.get(u)||rt.empty();f=c.applyToLocalView(h,f),r.set(u,f);let g=(i.get(c.batchId)||Y()).add(u);i=i.insert(c.batchId,g)})}).next(()=>{let o=[],c=i.getReverseIterator();for(;c.hasNext();){let u=c.getNext(),h=u.key,f=u.value,g=uI();f.forEach(_=>{if(!s.has(_)){let b=gI(t.get(_),r.get(_));b!==null&&g.set(_,b),s=s.add(_)}}),o.push(this.documentOverlayCache.saveOverlays(e,h,g))}return D.waitFor(o)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,t,r,i){return function(o){return F.isDocumentKey(o.path)&&o.collectionGroup===null&&o.filters.length===0}(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):iI(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,r,i):this.getDocumentsMatchingCollectionQuery(e,t,r,i)}getNextDocuments(e,t,r,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,r,i).next(s=>{let o=i-s.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,r.largestBatchId,i-s.size):D.resolve(Xn()),c=Ps,u=s;return o.next(h=>D.forEach(h,(f,g)=>(c<g.largestBatchId&&(c=g.largestBatchId),s.get(f)?D.resolve():this.remoteDocumentCache.getEntry(e,f).next(_=>{u=u.insert(f,_)}))).next(()=>this.populateOverlays(e,h,s)).next(()=>this.computeViews(e,u,h,Y())).next(f=>({batchId:c,changes:cI(f)})))})}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new F(t)).next(r=>{let i=As();return r.isFoundDocument()&&(i=i.insert(r.key,r)),i})}getDocumentsMatchingCollectionGroupQuery(e,t,r,i){let s=t.collectionGroup,o=As();return this.indexManager.getCollectionParents(e,s).next(c=>D.forEach(c,u=>{let h=function(g,_){return new An(_,null,g.explicitOrderBy.slice(),g.filters.slice(),g.limit,g.limitType,g.startAt,g.endAt)}(t,u.child(s));return this.getDocumentsMatchingCollectionQuery(e,h,r,i).next(f=>{f.forEach((g,_)=>{o=o.insert(g,_)})})}).next(()=>o))}getDocumentsMatchingCollectionQuery(e,t,r,i){let s;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,r.largestBatchId).next(o=>(s=o,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,r,s,i))).next(o=>{s.forEach((u,h)=>{let f=h.getKey();o.get(f)===null&&(o=o.insert(f,pt.newInvalidDocument(f)))});let c=As();return o.forEach((u,h)=>{let f=s.get(u);f!==void 0&&Cs(f.mutation,h,rt.empty(),Re.now()),Ec(t,h)&&(c=c.insert(u,h))}),c})}};var Cd=class{constructor(e){this.serializer=e,this.kr=new Map,this.qr=new Map}getBundleMetadata(e,t){return D.resolve(this.kr.get(t))}saveBundleMetadata(e,t){return this.kr.set(t.id,function(i){return{id:i.id,version:i.version,createTime:Ct(i.createTime)}}(t)),D.resolve()}getNamedQuery(e,t){return D.resolve(this.qr.get(t))}saveNamedQuery(e,t){return this.qr.set(t.name,function(i){return{name:i.name,query:DC(i.bundledQuery),readTime:Ct(i.readTime)}}(t)),D.resolve()}};var Pd=class{constructor(){this.overlays=new ge(F.comparator),this.Qr=new Map}getOverlay(e,t){return D.resolve(this.overlays.get(t))}getOverlays(e,t){let r=Xn();return D.forEach(t,i=>this.getOverlay(e,i).next(s=>{s!==null&&r.set(i,s)})).next(()=>r)}saveOverlays(e,t,r){return r.forEach((i,s)=>{this.bt(e,t,s)}),D.resolve()}removeOverlaysForBatchId(e,t,r){let i=this.Qr.get(r);return i!==void 0&&(i.forEach(s=>this.overlays=this.overlays.remove(s)),this.Qr.delete(r)),D.resolve()}getOverlaysForCollection(e,t,r){let i=Xn(),s=t.length+1,o=new F(t.child("")),c=this.overlays.getIteratorFrom(o);for(;c.hasNext();){let u=c.getNext().value,h=u.getKey();if(!t.isPrefixOf(h.path))break;h.path.length===s&&u.largestBatchId>r&&i.set(u.getKey(),u)}return D.resolve(i)}getOverlaysForCollectionGroup(e,t,r,i){let s=new ge((h,f)=>h-f),o=this.overlays.getIterator();for(;o.hasNext();){let h=o.getNext().value;if(h.getKey().getCollectionGroup()===t&&h.largestBatchId>r){let f=s.get(h.largestBatchId);f===null&&(f=Xn(),s=s.insert(h.largestBatchId,f)),f.set(h.getKey(),h)}}let c=Xn(),u=s.getIterator();for(;u.hasNext()&&(u.getNext().value.forEach((h,f)=>c.set(h,f)),!(c.size()>=i)););return D.resolve(c)}bt(e,t,r){let i=this.overlays.get(r.key);if(i!==null){let o=this.Qr.get(i.largestBatchId).delete(r.key);this.Qr.set(i.largestBatchId,o)}this.overlays=this.overlays.insert(r.key,new ld(t,r));let s=this.Qr.get(t);s===void 0&&(s=Y(),this.Qr.set(t,s)),this.Qr.set(t,s.add(r.key))}};var Dd=class{constructor(){this.sessionToken=Ve.EMPTY_BYTE_STRING}getSessionToken(e){return D.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,D.resolve()}};var Vs=class{constructor(){this.$r=new Ae(ye.Ur),this.Kr=new Ae(ye.Wr)}isEmpty(){return this.$r.isEmpty()}addReference(e,t){let r=new ye(e,t);this.$r=this.$r.add(r),this.Kr=this.Kr.add(r)}Gr(e,t){e.forEach(r=>this.addReference(r,t))}removeReference(e,t){this.zr(new ye(e,t))}jr(e,t){e.forEach(r=>this.removeReference(r,t))}Hr(e){let t=new F(new he([])),r=new ye(t,e),i=new ye(t,e+1),s=[];return this.Kr.forEachInRange([r,i],o=>{this.zr(o),s.push(o.key)}),s}Jr(){this.$r.forEach(e=>this.zr(e))}zr(e){this.$r=this.$r.delete(e),this.Kr=this.Kr.delete(e)}Yr(e){let t=new F(new he([])),r=new ye(t,e),i=new ye(t,e+1),s=Y();return this.Kr.forEachInRange([r,i],o=>{s=s.add(o.key)}),s}containsKey(e){let t=new ye(e,0),r=this.$r.firstAfterOrEqual(t);return r!==null&&e.isEqual(r.key)}},ye=class{constructor(e,t){this.key=e,this.Zr=t}static Ur(e,t){return F.comparator(e.key,t.key)||K(e.Zr,t.Zr)}static Wr(e,t){return K(e.Zr,t.Zr)||F.comparator(e.key,t.key)}};var kd=class{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.nr=1,this.Xr=new Ae(ye.Ur)}checkEmpty(e){return D.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,r,i){let s=this.nr;this.nr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];let o=new cd(s,t,r,i);this.mutationQueue.push(o);for(let c of i)this.Xr=this.Xr.add(new ye(c.key,s)),this.indexManager.addToCollectionParentIndex(e,c.key.path.popLast());return D.resolve(o)}lookupMutationBatch(e,t){return D.resolve(this.ei(t))}getNextMutationBatchAfterBatchId(e,t){let r=t+1,i=this.ti(r),s=i<0?0:i;return D.resolve(this.mutationQueue.length>s?this.mutationQueue[s]:null)}getHighestUnacknowledgedBatchId(){return D.resolve(this.mutationQueue.length===0?bf:this.nr-1)}getAllMutationBatches(e){return D.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){let r=new ye(t,0),i=new ye(t,Number.POSITIVE_INFINITY),s=[];return this.Xr.forEachInRange([r,i],o=>{let c=this.ei(o.Zr);s.push(c)}),D.resolve(s)}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new Ae(K);return t.forEach(i=>{let s=new ye(i,0),o=new ye(i,Number.POSITIVE_INFINITY);this.Xr.forEachInRange([s,o],c=>{r=r.add(c.Zr)})}),D.resolve(this.ni(r))}getAllMutationBatchesAffectingQuery(e,t){let r=t.path,i=r.length+1,s=r;F.isDocumentKey(s)||(s=s.child(""));let o=new ye(new F(s),0),c=new Ae(K);return this.Xr.forEachWhile(u=>{let h=u.key.path;return!!r.isPrefixOf(h)&&(h.length===i&&(c=c.add(u.Zr)),!0)},o),D.resolve(this.ni(c))}ni(e){let t=[];return e.forEach(r=>{let i=this.ei(r);i!==null&&t.push(i)}),t}removeMutationBatch(e,t){ne(this.ri(t.batchId,"removed")===0,55003),this.mutationQueue.shift();let r=this.Xr;return D.forEach(t.mutations,i=>{let s=new ye(i.key,t.batchId);return r=r.delete(s),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)}).next(()=>{this.Xr=r})}sr(e){}containsKey(e,t){let r=new ye(t,0),i=this.Xr.firstAfterOrEqual(r);return D.resolve(t.isEqual(i&&i.key))}performConsistencyCheck(e){return this.mutationQueue.length,D.resolve()}ri(e,t){return this.ti(e)}ti(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}ei(e){let t=this.ti(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}};var Nd=class{constructor(e){this.ii=e,this.docs=function(){return new ge(F.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){let r=t.key,i=this.docs.get(r),s=i?i.size:0,o=this.ii(t);return this.docs=this.docs.insert(r,{document:t.mutableCopy(),size:o}),this.size+=o-s,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){let t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){let r=this.docs.get(t);return D.resolve(r?r.document.mutableCopy():pt.newInvalidDocument(t))}getEntries(e,t){let r=Xt();return t.forEach(i=>{let s=this.docs.get(i);r=r.insert(i,s?s.document.mutableCopy():pt.newInvalidDocument(i))}),D.resolve(r)}getDocumentsMatchingQuery(e,t,r,i){let s=Xt(),o=t.path,c=new F(o.child("__id-9223372036854775808__")),u=this.docs.getIteratorFrom(c);for(;u.hasNext();){let{key:h,value:{document:f}}=u.getNext();if(!o.isPrefixOf(h.path))break;h.path.length>o.length+1||N0(k0(f),r)<=0||(i.has(f.key)||Ec(t,f))&&(s=s.insert(f.key,f.mutableCopy()))}return D.resolve(s)}getAllFromCollectionGroup(e,t,r,i){U(9500)}si(e,t){return D.forEach(this.docs,r=>t(r))}newChangeBuffer(e){return new Od(this)}getSize(e){return D.resolve(this.size)}},Od=class extends Sd{constructor(e){super(),this.Br=e}applyChanges(e){let t=[];return this.changes.forEach((r,i)=>{i.isValidDocument()?t.push(this.Br.addEntry(e,i)):this.Br.removeEntry(r)}),D.waitFor(t)}getFromCache(e,t){return this.Br.getEntry(e,t)}getAllFromCache(e,t){return this.Br.getEntries(e,t)}};var xd=class{constructor(e){this.persistence=e,this.oi=new Jt(t=>kf(t),Nf),this.lastRemoteSnapshotVersion=W.min(),this.highestTargetId=0,this._i=0,this.ai=new Vs,this.targetCount=0,this.ui=Ls.cr()}forEachTarget(e,t){return this.oi.forEach((r,i)=>t(i)),D.resolve()}getLastRemoteSnapshotVersion(e){return D.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return D.resolve(this._i)}allocateTargetId(e){return this.highestTargetId=this.ui.next(),D.resolve(this.highestTargetId)}setTargetsMetadata(e,t,r){return r&&(this.lastRemoteSnapshotVersion=r),t>this._i&&(this._i=t),D.resolve()}Tr(e){this.oi.set(e.target,e);let t=e.targetId;t>this.highestTargetId&&(this.ui=new Ls(t),this.highestTargetId=t),e.sequenceNumber>this._i&&(this._i=e.sequenceNumber)}addTargetData(e,t){return this.Tr(t),this.targetCount+=1,D.resolve()}updateTargetData(e,t){return this.Tr(t),D.resolve()}removeTargetData(e,t){return this.oi.delete(t.target),this.ai.Hr(t.targetId),this.targetCount-=1,D.resolve()}removeTargets(e,t,r){let i=0,s=[];return this.oi.forEach((o,c)=>{c.sequenceNumber<=t&&r.get(c.targetId)===null&&(this.oi.delete(o),s.push(this.removeMatchingKeysForTargetId(e,c.targetId)),i++)}),D.waitFor(s).next(()=>i)}getTargetCount(e){return D.resolve(this.targetCount)}getTargetData(e,t){let r=this.oi.get(t)||null;return D.resolve(r)}addMatchingKeys(e,t,r){return this.ai.Gr(t,r),D.resolve()}removeMatchingKeys(e,t,r){this.ai.jr(t,r);let i=this.persistence.referenceDelegate,s=[];return i&&t.forEach(o=>{s.push(i.markPotentiallyOrphaned(e,o))}),D.waitFor(s)}removeMatchingKeysForTargetId(e,t){return this.ai.Hr(t),D.resolve()}getMatchingKeysForTargetId(e,t){let r=this.ai.Yr(t);return D.resolve(r)}containsKey(e,t){return D.resolve(this.ai.containsKey(t))}};var Qa=class{constructor(e,t){this.ci={},this.overlays={},this.li=new Sf(0),this.hi=!1,this.hi=!0,this.Pi=new Dd,this.referenceDelegate=e(this),this.Ti=new xd(this),this.indexManager=new Id,this.remoteDocumentCache=function(i){return new Nd(i)}(r=>this.referenceDelegate.Ii(r)),this.serializer=new vd(t),this.Ei=new Cd(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.hi=!1,Promise.resolve()}get started(){return this.hi}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new Pd,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let r=this.ci[e.toKey()];return r||(r=new kd(t,this.referenceDelegate),this.ci[e.toKey()]=r),r}getGlobalsCache(){return this.Pi}getTargetCache(){return this.Ti}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ei}runTransaction(e,t,r){M("MemoryPersistence","Starting transaction:",e);let i=new Md(this.li.next());return this.referenceDelegate.di(),r(i).next(s=>this.referenceDelegate.Ai(i).next(()=>s)).toPromise().then(s=>(i.raiseOnCommittedEvent(),s))}Ri(e,t){return D.or(Object.values(this.ci).map(r=>()=>r.containsKey(e,t)))}},Md=class extends zh{constructor(e){super(),this.currentSequenceNumber=e}},Ld=class n{constructor(e){this.persistence=e,this.Vi=new Vs,this.mi=null}static fi(e){return new n(e)}get gi(){if(this.mi)return this.mi;throw U(60996)}addReference(e,t,r){return this.Vi.addReference(r,t),this.gi.delete(r.toString()),D.resolve()}removeReference(e,t,r){return this.Vi.removeReference(r,t),this.gi.add(r.toString()),D.resolve()}markPotentiallyOrphaned(e,t){return this.gi.add(t.toString()),D.resolve()}removeTarget(e,t){this.Vi.Hr(t.targetId).forEach(i=>this.gi.add(i.toString()));let r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,t.targetId).next(i=>{i.forEach(s=>this.gi.add(s.toString()))}).next(()=>r.removeTargetData(e,t))}di(){this.mi=new Set}Ai(e){let t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return D.forEach(this.gi,r=>{let i=F.fromPath(r);return this.pi(e,i).next(s=>{s||t.removeEntry(i,W.min())})}).next(()=>(this.mi=null,t.apply(e)))}updateLimboDocument(e,t){return this.pi(e,t).next(r=>{r?this.gi.delete(t.toString()):this.gi.add(t.toString())})}Ii(e){return 0}pi(e,t){return D.or([()=>D.resolve(this.Vi.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Ri(e,t)])}},Ya=class n{constructor(e,t){this.persistence=e,this.yi=new Jt(r=>L0(r.path),(r,i)=>r.isEqual(i)),this.garbageCollector=NC(this,t)}static fi(e,t){return new n(e,t)}di(){}Ai(e){return D.resolve()}forEachTarget(e,t){return this.persistence.getTargetCache().forEachTarget(e,t)}pr(e){let t=this.Sr(e);return this.persistence.getTargetCache().getTargetCount(e).next(r=>t.next(i=>r+i))}Sr(e){let t=0;return this.yr(e,r=>{t++}).next(()=>t)}yr(e,t){return D.forEach(this.yi,(r,i)=>this.Dr(e,r,i).next(s=>s?D.resolve():t(i)))}removeTargets(e,t,r){return this.persistence.getTargetCache().removeTargets(e,t,r)}removeOrphanedDocuments(e,t){let r=0,i=this.persistence.getRemoteDocumentCache(),s=i.newChangeBuffer();return i.si(e,o=>this.Dr(e,o,t).next(c=>{c||(r++,s.removeEntry(o,W.min()))})).next(()=>s.apply(e)).next(()=>r)}markPotentiallyOrphaned(e,t){return this.yi.set(t,e.currentSequenceNumber),D.resolve()}removeTarget(e,t){let r=t.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,r)}addReference(e,t,r){return this.yi.set(r,e.currentSequenceNumber),D.resolve()}removeReference(e,t,r){return this.yi.set(r,e.currentSequenceNumber),D.resolve()}updateLimboDocument(e,t){return this.yi.set(t,e.currentSequenceNumber),D.resolve()}Ii(e){let t=e.key.toString().length;return e.isFoundDocument()&&(t+=Da(e.data.value)),t}Dr(e,t,r){return D.or([()=>this.persistence.Ri(e,t),()=>this.persistence.getTargetCache().containsKey(e,t),()=>{let i=this.yi.get(t);return D.resolve(i!==void 0&&i>r)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}};var Vd=class n{constructor(e,t,r,i){this.targetId=e,this.fromCache=t,this.ds=r,this.As=i}static Rs(e,t){let r=Y(),i=Y();for(let s of t.docChanges)switch(s.type){case 0:r=r.add(s.doc.key);break;case 1:i=i.add(s.doc.key)}return new n(e,t.fromCache,r,i)}};var Fd=class{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}};var Ud=class{constructor(){this.Vs=!1,this.fs=!1,this.gs=100,this.ps=function(){return ay()?8:x0(we())>0?6:4}()}initialize(e,t){this.ys=e,this.indexManager=t,this.Vs=!0}getDocumentsMatchingQuery(e,t,r,i){let s={result:null};return this.ws(e,t).next(o=>{s.result=o}).next(()=>{if(!s.result)return this.Ss(e,t,i,r).next(o=>{s.result=o})}).next(()=>{if(s.result)return;let o=new Fd;return this.bs(e,t,o).next(c=>{if(s.result=c,this.fs)return this.Ds(e,t,o,c.size)})}).next(()=>s.result)}Ds(e,t,r,i){return r.documentReadCount<this.gs?(qr()<=Q.DEBUG&&M("QueryEngine","SDK will not create cache indexes for query:",zr(t),"since it only creates cache indexes for collection contains","more than or equal to",this.gs,"documents"),D.resolve()):(qr()<=Q.DEBUG&&M("QueryEngine","Query:",zr(t),"scans",r.documentReadCount,"local documents and returns",i,"documents as results."),r.documentReadCount>this.ps*i?(qr()<=Q.DEBUG&&M("QueryEngine","The SDK decides to create cache indexes for query:",zr(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,bt(t))):D.resolve())}ws(e,t){if(J_(t))return D.resolve(null);let r=bt(t);return this.indexManager.getIndexType(e,r).next(i=>i===0?null:(t.limit!==null&&i===1&&(t=sd(t,null,"F"),r=bt(t)),this.indexManager.getDocumentsMatchingTarget(e,r).next(s=>{let o=Y(...s);return this.ys.getDocuments(e,o).next(c=>this.indexManager.getMinOffset(e,r).next(u=>{let h=this.vs(t,c);return this.Cs(t,h,o,u.readTime)?this.ws(e,sd(t,null,"F")):this.Fs(e,h,t,u)}))})))}Ss(e,t,r,i){return J_(t)||i.isEqual(W.min())?D.resolve(null):this.ys.getDocuments(e,r).next(s=>{let o=this.vs(t,s);return this.Cs(t,o,r,i)?D.resolve(null):(qr()<=Q.DEBUG&&M("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),zr(t)),this.Fs(e,o,t,D0(i,Ps)).next(c=>c))})}vs(e,t){let r=new Ae(oI(e));return t.forEach((i,s)=>{Ec(e,s)&&(r=r.add(s))}),r}Cs(e,t,r,i){if(e.limit===null)return!1;if(r.size!==t.size)return!0;let s=e.limitType==="F"?t.last():t.first();return!!s&&(s.hasPendingWrites||s.version.compareTo(i)>0)}bs(e,t,r){return qr()<=Q.DEBUG&&M("QueryEngine","Using full collection scan to execute query:",zr(t)),this.ys.getDocumentsMatchingQuery(e,t,nr.min(),r)}Fs(e,t,r,i){return this.ys.getDocumentsMatchingQuery(e,r,i).next(s=>(t.forEach(o=>{s=s.insert(o.key,o)}),s))}};var Mf="LocalStore",OC=3e8,Bd=class{constructor(e,t,r,i){this.persistence=e,this.Ms=t,this.serializer=i,this.xs=new ge(K),this.Os=new Jt(s=>kf(s),Nf),this.Ns=new Map,this.Bs=e.getRemoteDocumentCache(),this.Ti=e.getTargetCache(),this.Ei=e.getBundleCache(),this.Ls(r)}Ls(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new Rd(this.Bs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Bs.setIndexManager(this.indexManager),this.Ms.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",t=>e.collect(t,this.xs))}};function xC(n,e,t,r){return new Bd(n,e,t,r)}function bI(n,e){return y(this,null,function*(){let t=H(n);return yield t.persistence.runTransaction("Handle user change","readonly",r=>{let i;return t.mutationQueue.getAllMutationBatches(r).next(s=>(i=s,t.Ls(e),t.mutationQueue.getAllMutationBatches(r))).next(s=>{let o=[],c=[],u=Y();for(let h of i){o.push(h.batchId);for(let f of h.mutations)u=u.add(f.key)}for(let h of s){c.push(h.batchId);for(let f of h.mutations)u=u.add(f.key)}return t.localDocuments.getDocuments(r,u).next(h=>({ks:h,removedBatchIds:o,addedBatchIds:c}))})})})}function MC(n,e){let t=H(n);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{let i=e.batch.keys(),s=t.Bs.newChangeBuffer({trackRemovals:!0});return function(c,u,h,f){let g=h.batch,_=g.keys(),b=D.resolve();return _.forEach(P=>{b=b.next(()=>f.getEntry(u,P)).next(O=>{let k=h.docVersions.get(P);ne(k!==null,48541),O.version.compareTo(k)<0&&(g.applyToRemoteDocument(O,h),O.isValidDocument()&&(O.setReadTime(h.commitVersion),f.addEntry(O)))})}),b.next(()=>c.mutationQueue.removeMutationBatch(u,g))}(t,r,e,s).next(()=>s.apply(r)).next(()=>t.mutationQueue.performConsistencyCheck(r)).next(()=>t.documentOverlayCache.removeOverlaysForBatchId(r,i,e.batch.batchId)).next(()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,function(c){let u=Y();for(let h=0;h<c.mutationResults.length;++h)c.mutationResults[h].transformResults.length>0&&(u=u.add(c.batch.mutations[h].key));return u}(e))).next(()=>t.localDocuments.getDocuments(r,i))})}function RI(n){let e=H(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",t=>e.Ti.getLastRemoteSnapshotVersion(t))}function LC(n,e){let t=H(n),r=e.snapshotVersion,i=t.xs;return t.persistence.runTransaction("Apply remote event","readwrite-primary",s=>{let o=t.Bs.newChangeBuffer({trackRemovals:!0});i=t.xs;let c=[];e.targetChanges.forEach((f,g)=>{let _=i.get(g);if(!_)return;c.push(t.Ti.removeMatchingKeys(s,f.removedDocuments,g).next(()=>t.Ti.addMatchingKeys(s,f.addedDocuments,g)));let b=_.withSequenceNumber(s.currentSequenceNumber);e.targetMismatches.get(g)!==null?b=b.withResumeToken(Ve.EMPTY_BYTE_STRING,W.min()).withLastLimboFreeSnapshotVersion(W.min()):f.resumeToken.approximateByteSize()>0&&(b=b.withResumeToken(f.resumeToken,r)),i=i.insert(g,b),function(O,k,z){return O.resumeToken.approximateByteSize()===0||k.snapshotVersion.toMicroseconds()-O.snapshotVersion.toMicroseconds()>=OC?!0:z.addedDocuments.size+z.modifiedDocuments.size+z.removedDocuments.size>0}(_,b,f)&&c.push(t.Ti.updateTargetData(s,b))});let u=Xt(),h=Y();if(e.documentUpdates.forEach(f=>{e.resolvedLimboDocuments.has(f)&&c.push(t.persistence.referenceDelegate.updateLimboDocument(s,f))}),c.push(VC(s,o,e.documentUpdates).next(f=>{u=f.qs,h=f.Qs})),!r.isEqual(W.min())){let f=t.Ti.getLastRemoteSnapshotVersion(s).next(g=>t.Ti.setTargetsMetadata(s,s.currentSequenceNumber,r));c.push(f)}return D.waitFor(c).next(()=>o.apply(s)).next(()=>t.localDocuments.getLocalViewOfDocuments(s,u,h)).next(()=>u)}).then(s=>(t.xs=i,s))}function VC(n,e,t){let r=Y(),i=Y();return t.forEach(s=>r=r.add(s)),e.getEntries(n,r).next(s=>{let o=Xt();return t.forEach((c,u)=>{let h=s.get(c);u.isFoundDocument()!==h.isFoundDocument()&&(i=i.add(c)),u.isNoDocument()&&u.version.isEqual(W.min())?(e.removeEntry(c,u.readTime),o=o.insert(c,u)):!h.isValidDocument()||u.version.compareTo(h.version)>0||u.version.compareTo(h.version)===0&&h.hasPendingWrites?(e.addEntry(u),o=o.insert(c,u)):M(Mf,"Ignoring outdated watch update for ",c,". Current version:",h.version," Watch version:",u.version)}),{qs:o,Qs:i}})}function FC(n,e){let t=H(n);return t.persistence.runTransaction("Get next mutation batch","readonly",r=>(e===void 0&&(e=bf),t.mutationQueue.getNextMutationBatchAfterBatchId(r,e)))}function UC(n,e){let t=H(n);return t.persistence.runTransaction("Allocate target","readwrite",r=>{let i;return t.Ti.getTargetData(r,e).next(s=>s?(i=s,D.resolve(i)):t.Ti.allocateTargetId(r).next(o=>(i=new Ms(e,o,"TargetPurposeListen",r.currentSequenceNumber),t.Ti.addTargetData(r,i).next(()=>i))))}).then(r=>{let i=t.xs.get(r.targetId);return(i===null||r.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(t.xs=t.xs.insert(r.targetId,r),t.Os.set(e,r.targetId)),r})}function $d(n,e,t){return y(this,null,function*(){let r=H(n),i=r.xs.get(e),s=t?"readwrite":"readwrite-primary";try{t||(yield r.persistence.runTransaction("Release target",s,o=>r.persistence.referenceDelegate.removeTarget(o,i)))}catch(o){if(!li(o))throw o;M(Mf,`Failed to update sequence numbers for target ${e}: ${o}`)}r.xs=r.xs.remove(e),r.Os.delete(i.target)})}function lv(n,e,t){let r=H(n),i=W.min(),s=Y();return r.persistence.runTransaction("Execute query","readwrite",o=>function(u,h,f){let g=H(u),_=g.Os.get(f);return _!==void 0?D.resolve(g.xs.get(_)):g.Ti.getTargetData(h,f)}(r,o,bt(e)).next(c=>{if(c)return i=c.lastLimboFreeSnapshotVersion,r.Ti.getMatchingKeysForTargetId(o,c.targetId).next(u=>{s=u})}).next(()=>r.Ms.getDocumentsMatchingQuery(o,e,t?i:W.min(),t?s:Y())).next(c=>(BC(r,Z0(e),c),{documents:c,$s:s})))}function BC(n,e,t){let r=n.Ns.get(e)||W.min();t.forEach((i,s)=>{s.readTime.compareTo(r)>0&&(r=s.readTime)}),n.Ns.set(e,r)}var Ja=class{constructor(){this.activeTargetIds=sC()}js(e){this.activeTargetIds=this.activeTargetIds.add(e)}Hs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}zs(){let e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}};var jd=class{constructor(){this.xo=new Ja,this.Oo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,r){}addLocalQueryTarget(e,t=!0){return t&&this.xo.js(e),this.Oo[e]||"not-current"}updateQueryState(e,t,r){this.Oo[e]=t}removeLocalQueryTarget(e){this.xo.Hs(e)}isLocalQueryTarget(e){return this.xo.activeTargetIds.has(e)}clearQueryState(e){delete this.Oo[e]}getAllActiveQueryTargets(){return this.xo.activeTargetIds}isActiveQueryTarget(e){return this.xo.activeTargetIds.has(e)}start(){return this.xo=new Ja,Promise.resolve()}handleUserChange(e,t,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}};var qd=class{No(e){}shutdown(){}};var hv="ConnectivityMonitor",Xa=class{constructor(){this.Bo=()=>this.Lo(),this.ko=()=>this.qo(),this.Qo=[],this.$o()}No(e){this.Qo.push(e)}shutdown(){window.removeEventListener("online",this.Bo),window.removeEventListener("offline",this.ko)}$o(){window.addEventListener("online",this.Bo),window.addEventListener("offline",this.ko)}Lo(){M(hv,"Network connectivity changed: AVAILABLE");for(let e of this.Qo)e(0)}qo(){M(hv,"Network connectivity changed: UNAVAILABLE");for(let e of this.Qo)e(1)}static C(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}};var Pa=null;function zd(){return Pa===null?Pa=function(){return 268435456+Math.round(2147483648*Math.random())}():Pa++,"0x"+Pa.toString(16)}var Oh="RestConnection",$C={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"},Hd=class{get Uo(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;let t=e.ssl?"https":"http",r=encodeURIComponent(this.databaseId.projectId),i=encodeURIComponent(this.databaseId.database);this.Ko=t+"://"+e.host,this.Wo=`projects/${r}/databases/${i}`,this.Go=this.databaseId.database===Ua?`project_id=${r}`:`project_id=${r}&database_id=${i}`}zo(e,t,r,i,s){let o=zd(),c=this.jo(e,t.toUriEncodedString());M(Oh,`Sending RPC '${e}' ${o}:`,c,r);let u={"google-cloud-resource-prefix":this.Wo,"x-goog-request-params":this.Go};this.Ho(u,i,s);let{host:h}=new URL(c),f=Hn(h);return this.Jo(e,c,u,r,f).then(g=>(M(Oh,`Received RPC '${e}' ${o}: `,g),g),g=>{throw Yr(Oh,`RPC '${e}' ${o} failed with error: `,g,"url: ",c,"request:",r),g})}Yo(e,t,r,i,s,o){return this.zo(e,t,r,i,s)}Ho(e,t,r){e["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+ci}(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach((i,s)=>e[s]=i),r&&r.headers.forEach((i,s)=>e[s]=i)}jo(e,t){let r=$C[e];return`${this.Ko}/v1/${t}:${r}`}terminate(){}};var Wd=class{constructor(e){this.Zo=e.Zo,this.Xo=e.Xo}e_(e){this.t_=e}n_(e){this.r_=e}i_(e){this.s_=e}onMessage(e){this.o_=e}close(){this.Xo()}send(e){this.Zo(e)}__(){this.t_()}a_(){this.r_()}u_(e){this.s_(e)}c_(e){this.o_(e)}};var Me="WebChannelConnection",Gd=class extends Hd{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Jo(e,t,r,i,s){let o=zd();return new Promise((c,u)=>{let h=new Rh;h.setWithCredentials(!0),h.listenOnce(Ch.COMPLETE,()=>{try{switch(h.getLastErrorCode()){case Ts.NO_ERROR:let g=h.getResponseJson();M(Me,`XHR for RPC '${e}' ${o} received:`,JSON.stringify(g)),c(g);break;case Ts.TIMEOUT:M(Me,`RPC '${e}' ${o} timed out`),u(new x(C.DEADLINE_EXCEEDED,"Request time out"));break;case Ts.HTTP_ERROR:let _=h.getStatus();if(M(Me,`RPC '${e}' ${o} failed with status:`,_,"response text:",h.getResponseText()),_>0){let b=h.getResponseJson();Array.isArray(b)&&(b=b[0]);let P=b?.error;if(P&&P.status&&P.message){let O=function(z){let $=z.toLowerCase().replace(/_/g,"-");return Object.values(C).indexOf($)>=0?$:C.UNKNOWN}(P.status);u(new x(O,P.message))}else u(new x(C.UNKNOWN,"Server responded with status "+h.getStatus()))}else u(new x(C.UNAVAILABLE,"Connection failed."));break;default:U(9055,{l_:e,streamId:o,h_:h.getLastErrorCode(),P_:h.getLastError()})}}finally{M(Me,`RPC '${e}' ${o} completed.`)}});let f=JSON.stringify(i);M(Me,`RPC '${e}' ${o} sending request:`,i),h.send(t,"POST",f,r,15)})}T_(e,t,r){let i=zd(),s=[this.Ko,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=kh(),c=Dh(),u={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},h=this.longPollingOptions.timeoutSeconds;h!==void 0&&(u.longPollingTimeout=Math.round(1e3*h)),this.useFetchStreams&&(u.useFetchStreams=!0),this.Ho(u.initMessageHeaders,t,r),u.encodeInitMessageHeaders=!0;let f=s.join("");M(Me,`Creating RPC '${e}' stream ${i}: ${f}`,u);let g=o.createWebChannel(f,u),_=!1,b=!1,P=new Wd({Zo:k=>{b?M(Me,`Not sending because RPC '${e}' stream ${i} is closed:`,k):(_||(M(Me,`Opening RPC '${e}' stream ${i} transport.`),g.open(),_=!0),M(Me,`RPC '${e}' stream ${i} sending:`,k),g.send(k))},Xo:()=>g.close()}),O=(k,z,$)=>{k.listen(z,q=>{try{$(q)}catch(se){setTimeout(()=>{throw se},0)}})};return O(g,jr.EventType.OPEN,()=>{b||(M(Me,`RPC '${e}' stream ${i} transport opened.`),P.__())}),O(g,jr.EventType.CLOSE,()=>{b||(b=!0,M(Me,`RPC '${e}' stream ${i} transport closed`),P.u_())}),O(g,jr.EventType.ERROR,k=>{b||(b=!0,Yr(Me,`RPC '${e}' stream ${i} transport errored. Name:`,k.name,"Message:",k.message),P.u_(new x(C.UNAVAILABLE,"The operation could not be completed")))}),O(g,jr.EventType.MESSAGE,k=>{var z;if(!b){let $=k.data[0];ne(!!$,16349);let q=$,se=q?.error||((z=q[0])===null||z===void 0?void 0:z.error);if(se){M(Me,`RPC '${e}' stream ${i} received error:`,se);let Fe=se.status,re=function(I){let w=me[I];if(w!==void 0)return yI(w)}(Fe),E=se.message;re===void 0&&(re=C.INTERNAL,E="Unknown error status: "+Fe+" with message "+se.message),b=!0,P.u_(new x(re,E)),g.close()}else M(Me,`RPC '${e}' stream ${i} received:`,$),P.c_($)}}),O(c,Ph.STAT_EVENT,k=>{k.stat===ba.PROXY?M(Me,`RPC '${e}' stream ${i} detected buffering proxy`):k.stat===ba.NOPROXY&&M(Me,`RPC '${e}' stream ${i} detected no buffering proxy`)}),setTimeout(()=>{P.a_()},0),P}};function xh(){return typeof document<"u"?document:null}function Tc(n){return new pd(n,!0)}var Za=class{constructor(e,t,r=1e3,i=1.5,s=6e4){this.xi=e,this.timerId=t,this.I_=r,this.E_=i,this.d_=s,this.A_=0,this.R_=null,this.V_=Date.now(),this.reset()}reset(){this.A_=0}m_(){this.A_=this.d_}f_(e){this.cancel();let t=Math.floor(this.A_+this.g_()),r=Math.max(0,Date.now()-this.V_),i=Math.max(0,t-r);i>0&&M("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.A_} ms, delay with jitter: ${t} ms, last attempt: ${r} ms ago)`),this.R_=this.xi.enqueueAfterDelay(this.timerId,i,()=>(this.V_=Date.now(),e())),this.A_*=this.E_,this.A_<this.I_&&(this.A_=this.I_),this.A_>this.d_&&(this.A_=this.d_)}p_(){this.R_!==null&&(this.R_.skipDelay(),this.R_=null)}cancel(){this.R_!==null&&(this.R_.cancel(),this.R_=null)}g_(){return(Math.random()-.5)*this.A_}};var dv="PersistentStream",ec=class{constructor(e,t,r,i,s,o,c,u){this.xi=e,this.y_=r,this.w_=i,this.connection=s,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=c,this.listener=u,this.state=0,this.S_=0,this.b_=null,this.D_=null,this.stream=null,this.v_=0,this.C_=new Za(e,t)}F_(){return this.state===1||this.state===5||this.M_()}M_(){return this.state===2||this.state===3}start(){this.v_=0,this.state!==4?this.auth():this.x_()}stop(){return y(this,null,function*(){this.F_()&&(yield this.close(0))})}O_(){this.state=0,this.C_.reset()}N_(){this.M_()&&this.b_===null&&(this.b_=this.xi.enqueueAfterDelay(this.y_,6e4,()=>this.B_()))}L_(e){this.k_(),this.stream.send(e)}B_(){return y(this,null,function*(){if(this.M_())return this.close(0)})}k_(){this.b_&&(this.b_.cancel(),this.b_=null)}q_(){this.D_&&(this.D_.cancel(),this.D_=null)}close(e,t){return y(this,null,function*(){this.k_(),this.q_(),this.C_.cancel(),this.S_++,e!==4?this.C_.reset():t&&t.code===C.RESOURCE_EXHAUSTED?(Kt(t.toString()),Kt("Using maximum backoff delay to prevent overloading the backend."),this.C_.m_()):t&&t.code===C.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.Q_(),this.stream.close(),this.stream=null),this.state=e,yield this.listener.i_(t)})}Q_(){}auth(){this.state=1;let e=this.U_(this.S_),t=this.S_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,i])=>{this.S_===t&&this.K_(r,i)},r=>{e(()=>{let i=new x(C.UNKNOWN,"Fetching auth token failed: "+r.message);return this.W_(i)})})}K_(e,t){let r=this.U_(this.S_);this.stream=this.G_(e,t),this.stream.e_(()=>{r(()=>this.listener.e_())}),this.stream.n_(()=>{r(()=>(this.state=2,this.D_=this.xi.enqueueAfterDelay(this.w_,1e4,()=>(this.M_()&&(this.state=3),Promise.resolve())),this.listener.n_()))}),this.stream.i_(i=>{r(()=>this.W_(i))}),this.stream.onMessage(i=>{r(()=>++this.v_==1?this.z_(i):this.onNext(i))})}x_(){this.state=5,this.C_.f_(()=>y(this,null,function*(){this.state=0,this.start()}))}W_(e){return M(dv,`close with error: ${e}`),this.stream=null,this.close(4,e)}U_(e){return t=>{this.xi.enqueueAndForget(()=>this.S_===e?t():(M(dv,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}},Kd=class extends ec{constructor(e,t,r,i,s,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,r,i,o),this.serializer=s}G_(e,t){return this.connection.T_("Listen",e,t)}z_(e){return this.onNext(e)}onNext(e){this.C_.reset();let t=vC(this.serializer,e),r=function(s){if(!("targetChange"in s))return W.min();let o=s.targetChange;return o.targetIds&&o.targetIds.length?W.min():o.readTime?Ct(o.readTime):W.min()}(e);return this.listener.j_(t,r)}H_(e){let t={};t.database=_d(this.serializer),t.addTarget=function(s,o){let c,u=o.target;if(c=rd(u)?{documents:EC(s,u)}:{query:TC(s,u).gt},c.targetId=o.targetId,o.resumeToken.approximateByteSize()>0){c.resumeToken=_I(s,o.resumeToken);let h=gd(s,o.expectedCount);h!==null&&(c.expectedCount=h)}else if(o.snapshotVersion.compareTo(W.min())>0){c.readTime=Ga(s,o.snapshotVersion.toTimestamp());let h=gd(s,o.expectedCount);h!==null&&(c.expectedCount=h)}return c}(this.serializer,e);let r=SC(this.serializer,e);r&&(t.labels=r),this.L_(t)}J_(e){let t={};t.database=_d(this.serializer),t.removeTarget=e,this.L_(t)}},Qd=class extends ec{constructor(e,t,r,i,s,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,r,i,o),this.serializer=s}get Y_(){return this.v_>0}start(){this.lastStreamToken=void 0,super.start()}Q_(){this.Y_&&this.Z_([])}G_(e,t){return this.connection.T_("Write",e,t)}z_(e){return ne(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,ne(!e.writeResults||e.writeResults.length===0,55816),this.listener.X_()}onNext(e){ne(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.C_.reset();let t=wC(e.writeResults,e.commitTime),r=Ct(e.commitTime);return this.listener.ea(r,t)}ta(){let e={};e.database=_d(this.serializer),this.L_(e)}Z_(e){let t={streamToken:this.lastStreamToken,writes:e.map(r=>IC(this.serializer,r))};this.L_(t)}};var Yd=class{},Jd=class extends Yd{constructor(e,t,r,i){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=r,this.serializer=i,this.na=!1}ra(){if(this.na)throw new x(C.FAILED_PRECONDITION,"The client has already been terminated.")}zo(e,t,r,i){return this.ra(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,o])=>this.connection.zo(e,md(t,r),i,s,o)).catch(s=>{throw s.name==="FirebaseError"?(s.code===C.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new x(C.UNKNOWN,s.toString())})}Yo(e,t,r,i,s){return this.ra(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,c])=>this.connection.Yo(e,md(t,r),i,o,c,s)).catch(o=>{throw o.name==="FirebaseError"?(o.code===C.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new x(C.UNKNOWN,o.toString())})}terminate(){this.na=!0,this.connection.terminate()}},Xd=class{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.ia=0,this.sa=null,this.oa=!0}_a(){this.ia===0&&(this.aa("Unknown"),this.sa=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.sa=null,this.ua("Backend didn't respond within 10 seconds."),this.aa("Offline"),Promise.resolve())))}ca(e){this.state==="Online"?this.aa("Unknown"):(this.ia++,this.ia>=1&&(this.la(),this.ua(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.aa("Offline")))}set(e){this.la(),this.ia=0,e==="Online"&&(this.oa=!1),this.aa(e)}aa(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}ua(e){let t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.oa?(Kt(t),this.oa=!1):M("OnlineStateTracker",t)}la(){this.sa!==null&&(this.sa.cancel(),this.sa=null)}};var ar="RemoteStore",Zd=class{constructor(e,t,r,i,s){this.localStore=e,this.datastore=t,this.asyncQueue=r,this.remoteSyncer={},this.ha=[],this.Pa=new Map,this.Ta=new Set,this.Ia=[],this.Ea=s,this.Ea.No(o=>{r.enqueueAndForget(()=>y(this,null,function*(){lr(this)&&(M(ar,"Restarting streams for network reachability change."),yield function(u){return y(this,null,function*(){let h=H(u);h.Ta.add(4),yield js(h),h.da.set("Unknown"),h.Ta.delete(4),yield Ac(h)})}(this))}))}),this.da=new Xd(r,i)}};function Ac(n){return y(this,null,function*(){if(lr(n))for(let e of n.Ia)yield e(!0)})}function js(n){return y(this,null,function*(){for(let e of n.Ia)yield e(!1)})}function CI(n,e){let t=H(n);t.Pa.has(e.targetId)||(t.Pa.set(e.targetId,e),Uf(t)?Ff(t):hi(t).M_()&&Vf(t,e))}function Lf(n,e){let t=H(n),r=hi(t);t.Pa.delete(e),r.M_()&&PI(t,e),t.Pa.size===0&&(r.M_()?r.N_():lr(t)&&t.da.set("Unknown"))}function Vf(n,e){if(n.Aa.Ke(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(W.min())>0){let t=n.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}hi(n).H_(e)}function PI(n,e){n.Aa.Ke(e),hi(n).J_(e)}function Ff(n){n.Aa=new fd({getRemoteKeysForTarget:e=>n.remoteSyncer.getRemoteKeysForTarget(e),Rt:e=>n.Pa.get(e)||null,Pt:()=>n.datastore.serializer.databaseId}),hi(n).start(),n.da._a()}function Uf(n){return lr(n)&&!hi(n).F_()&&n.Pa.size>0}function lr(n){return H(n).Ta.size===0}function DI(n){n.Aa=void 0}function jC(n){return y(this,null,function*(){n.da.set("Online")})}function qC(n){return y(this,null,function*(){n.Pa.forEach((e,t)=>{Vf(n,e)})})}function zC(n,e){return y(this,null,function*(){DI(n),Uf(n)?(n.da.ca(e),Ff(n)):n.da.set("Unknown")})}function HC(n,e,t){return y(this,null,function*(){if(n.da.set("Online"),e instanceof Ha&&e.state===2&&e.cause)try{yield function(i,s){return y(this,null,function*(){let o=s.cause;for(let c of s.targetIds)i.Pa.has(c)&&(yield i.remoteSyncer.rejectListen(c,o),i.Pa.delete(c),i.Aa.removeTarget(c))})}(n,e)}catch(r){M(ar,"Failed to remove targets %s: %s ",e.targetIds.join(","),r),yield tc(n,r)}else if(e instanceof Kr?n.Aa.Xe(e):e instanceof za?n.Aa.ot(e):n.Aa.nt(e),!t.isEqual(W.min()))try{let r=yield RI(n.localStore);t.compareTo(r)>=0&&(yield function(s,o){let c=s.Aa.It(o);return c.targetChanges.forEach((u,h)=>{if(u.resumeToken.approximateByteSize()>0){let f=s.Pa.get(h);f&&s.Pa.set(h,f.withResumeToken(u.resumeToken,o))}}),c.targetMismatches.forEach((u,h)=>{let f=s.Pa.get(u);if(!f)return;s.Pa.set(u,f.withResumeToken(Ve.EMPTY_BYTE_STRING,f.snapshotVersion)),PI(s,u);let g=new Ms(f.target,u,h,f.sequenceNumber);Vf(s,g)}),s.remoteSyncer.applyRemoteEvent(c)}(n,t))}catch(r){M(ar,"Failed to raise snapshot:",r),yield tc(n,r)}})}function tc(n,e,t){return y(this,null,function*(){if(!li(e))throw e;n.Ta.add(1),yield js(n),n.da.set("Offline"),t||(t=()=>RI(n.localStore)),n.asyncQueue.enqueueRetryable(()=>y(null,null,function*(){M(ar,"Retrying IndexedDB access"),yield t(),n.Ta.delete(1),yield Ac(n)}))})}function kI(n,e){return e().catch(t=>tc(n,t,e))}function Sc(n){return y(this,null,function*(){let e=H(n),t=bn(e),r=e.ha.length>0?e.ha[e.ha.length-1].batchId:bf;for(;WC(e);)try{let i=yield FC(e.localStore,r);if(i===null){e.ha.length===0&&t.N_();break}r=i.batchId,GC(e,i)}catch(i){yield tc(e,i)}NI(e)&&OI(e)})}function WC(n){return lr(n)&&n.ha.length<10}function GC(n,e){n.ha.push(e);let t=bn(n);t.M_()&&t.Y_&&t.Z_(e.mutations)}function NI(n){return lr(n)&&!bn(n).F_()&&n.ha.length>0}function OI(n){bn(n).start()}function KC(n){return y(this,null,function*(){bn(n).ta()})}function QC(n){return y(this,null,function*(){let e=bn(n);for(let t of n.ha)e.Z_(t.mutations)})}function YC(n,e,t){return y(this,null,function*(){let r=n.ha.shift(),i=ud.from(r,e,t);yield kI(n,()=>n.remoteSyncer.applySuccessfulWrite(i)),yield Sc(n)})}function JC(n,e){return y(this,null,function*(){e&&bn(n).Y_&&(yield function(r,i){return y(this,null,function*(){if(function(o){return dC(o)&&o!==C.ABORTED}(i.code)){let s=r.ha.shift();bn(r).O_(),yield kI(r,()=>r.remoteSyncer.rejectFailedWrite(s.batchId,i)),yield Sc(r)}})}(n,e)),NI(n)&&OI(n)})}function fv(n,e){return y(this,null,function*(){let t=H(n);t.asyncQueue.verifyOperationInProgress(),M(ar,"RemoteStore received new credentials");let r=lr(t);t.Ta.add(3),yield js(t),r&&t.da.set("Unknown"),yield t.remoteSyncer.handleCredentialChange(e),t.Ta.delete(3),yield Ac(t)})}function XC(n,e){return y(this,null,function*(){let t=H(n);e?(t.Ta.delete(2),yield Ac(t)):e||(t.Ta.add(2),yield js(t),t.da.set("Unknown"))})}function hi(n){return n.Ra||(n.Ra=function(t,r,i){let s=H(t);return s.ra(),new Kd(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(n.datastore,n.asyncQueue,{e_:jC.bind(null,n),n_:qC.bind(null,n),i_:zC.bind(null,n),j_:HC.bind(null,n)}),n.Ia.push(e=>y(null,null,function*(){e?(n.Ra.O_(),Uf(n)?Ff(n):n.da.set("Unknown")):(yield n.Ra.stop(),DI(n))}))),n.Ra}function bn(n){return n.Va||(n.Va=function(t,r,i){let s=H(t);return s.ra(),new Qd(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(n.datastore,n.asyncQueue,{e_:()=>Promise.resolve(),n_:KC.bind(null,n),i_:JC.bind(null,n),X_:QC.bind(null,n),ea:YC.bind(null,n)}),n.Ia.push(e=>y(null,null,function*(){e?(n.Va.O_(),yield Sc(n)):(yield n.Va.stop(),n.ha.length>0&&(M(ar,`Stopping write stream with ${n.ha.length} pending writes`),n.ha=[]))}))),n.Va}var ef=class n{constructor(e,t,r,i,s){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=r,this.op=i,this.removalCallback=s,this.deferred=new At,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,t,r,i,s){let o=Date.now()+r,c=new n(e,t,o,i,s);return c.start(r),c}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new x(C.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}};function Bf(n,e){if(Kt("AsyncQueue",`${e}: ${n}`),li(n))return new x(C.UNAVAILABLE,`${e}: ${n}`);throw n}var nc=class n{static emptySet(e){return new n(e.comparator)}constructor(e){this.comparator=e?(t,r)=>e(t,r)||F.comparator(t.key,r.key):(t,r)=>F.comparator(t.key,r.key),this.keyedMap=As(),this.sortedSet=new ge(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){let t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((t,r)=>(e(t),!1))}add(e){let t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){let t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof n)||this.size!==e.size)return!1;let t=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;t.hasNext();){let i=t.getNext().key,s=r.getNext().key;if(!i.isEqual(s))return!1}return!0}toString(){let e=[];return this.forEach(t=>{e.push(t.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){let r=new n;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=t,r}};var rc=class{constructor(){this.ma=new ge(F.comparator)}track(e){let t=e.doc.key,r=this.ma.get(t);r?e.type!==0&&r.type===3?this.ma=this.ma.insert(t,e):e.type===3&&r.type!==1?this.ma=this.ma.insert(t,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.ma=this.ma.insert(t,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.ma=this.ma.insert(t,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.ma=this.ma.remove(t):e.type===1&&r.type===2?this.ma=this.ma.insert(t,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.ma=this.ma.insert(t,{type:2,doc:e.doc}):U(63341,{Vt:e,fa:r}):this.ma=this.ma.insert(t,e)}ga(){let e=[];return this.ma.inorderTraversal((t,r)=>{e.push(r)}),e}},si=class n{constructor(e,t,r,i,s,o,c,u,h){this.query=e,this.docs=t,this.oldDocs=r,this.docChanges=i,this.mutatedKeys=s,this.fromCache=o,this.syncStateChanged=c,this.excludesMetadataChanges=u,this.hasCachedResults=h}static fromInitialDocuments(e,t,r,i,s){let o=[];return t.forEach(c=>{o.push({type:0,doc:c})}),new n(e,t,nc.emptySet(t),o,r,i,!0,!1,s)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&wc(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;let t=this.docChanges,r=e.docChanges;if(t.length!==r.length)return!1;for(let i=0;i<t.length;i++)if(t[i].type!==r[i].type||!t[i].doc.isEqual(r[i].doc))return!1;return!0}};var tf=class{constructor(){this.pa=void 0,this.ya=[]}wa(){return this.ya.some(e=>e.Sa())}},nf=class{constructor(){this.queries=pv(),this.onlineState="Unknown",this.ba=new Set}terminate(){(function(t,r){let i=H(t),s=i.queries;i.queries=pv(),s.forEach((o,c)=>{for(let u of c.ya)u.onError(r)})})(this,new x(C.ABORTED,"Firestore shutting down"))}};function pv(){return new Jt(n=>sI(n),wc)}function xI(n,e){return y(this,null,function*(){let t=H(n),r=3,i=e.query,s=t.queries.get(i);s?!s.wa()&&e.Sa()&&(r=2):(s=new tf,r=e.Sa()?0:1);try{switch(r){case 0:s.pa=yield t.onListen(i,!0);break;case 1:s.pa=yield t.onListen(i,!1);break;case 2:yield t.onFirstRemoteStoreListen(i)}}catch(o){let c=Bf(o,`Initialization of query '${zr(e.query)}' failed`);return void e.onError(c)}t.queries.set(i,s),s.ya.push(e),e.Da(t.onlineState),s.pa&&e.va(s.pa)&&$f(t)})}function MI(n,e){return y(this,null,function*(){let t=H(n),r=e.query,i=3,s=t.queries.get(r);if(s){let o=s.ya.indexOf(e);o>=0&&(s.ya.splice(o,1),s.ya.length===0?i=e.Sa()?0:1:!s.wa()&&e.Sa()&&(i=2))}switch(i){case 0:return t.queries.delete(r),t.onUnlisten(r,!0);case 1:return t.queries.delete(r),t.onUnlisten(r,!1);case 2:return t.onLastRemoteStoreUnlisten(r);default:return}})}function ZC(n,e){let t=H(n),r=!1;for(let i of e){let s=i.query,o=t.queries.get(s);if(o){for(let c of o.ya)c.va(i)&&(r=!0);o.pa=i}}r&&$f(t)}function eP(n,e,t){let r=H(n),i=r.queries.get(e);if(i)for(let s of i.ya)s.onError(t);r.queries.delete(e)}function $f(n){n.ba.forEach(e=>{e.next()})}var rf,gv;(gv=rf||(rf={})).Ca="default",gv.Cache="cache";var ic=class{constructor(e,t,r){this.query=e,this.Fa=t,this.Ma=!1,this.xa=null,this.onlineState="Unknown",this.options=r||{}}va(e){if(!this.options.includeMetadataChanges){let r=[];for(let i of e.docChanges)i.type!==3&&r.push(i);e=new si(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.Ma?this.Oa(e)&&(this.Fa.next(e),t=!0):this.Na(e,this.onlineState)&&(this.Ba(e),t=!0),this.xa=e,t}onError(e){this.Fa.error(e)}Da(e){this.onlineState=e;let t=!1;return this.xa&&!this.Ma&&this.Na(this.xa,e)&&(this.Ba(this.xa),t=!0),t}Na(e,t){if(!e.fromCache||!this.Sa())return!0;let r=t!=="Offline";return(!this.options.La||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}Oa(e){if(e.docChanges.length>0)return!0;let t=this.xa&&this.xa.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}Ba(e){e=si.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Ma=!0,this.Fa.next(e)}Sa(){return this.options.source!==rf.Cache}};var sc=class{constructor(e){this.key=e}},oc=class{constructor(e){this.key=e}},sf=class{constructor(e,t){this.query=e,this.Ga=t,this.za=null,this.hasCachedResults=!1,this.current=!1,this.ja=Y(),this.mutatedKeys=Y(),this.Ha=oI(e),this.Ja=new nc(this.Ha)}get Ya(){return this.Ga}Za(e,t){let r=t?t.Xa:new rc,i=t?t.Ja:this.Ja,s=t?t.mutatedKeys:this.mutatedKeys,o=i,c=!1,u=this.query.limitType==="F"&&i.size===this.query.limit?i.last():null,h=this.query.limitType==="L"&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal((f,g)=>{let _=i.get(f),b=Ec(this.query,g)?g:null,P=!!_&&this.mutatedKeys.has(_.key),O=!!b&&(b.hasLocalMutations||this.mutatedKeys.has(b.key)&&b.hasCommittedMutations),k=!1;_&&b?_.data.isEqual(b.data)?P!==O&&(r.track({type:3,doc:b}),k=!0):this.eu(_,b)||(r.track({type:2,doc:b}),k=!0,(u&&this.Ha(b,u)>0||h&&this.Ha(b,h)<0)&&(c=!0)):!_&&b?(r.track({type:0,doc:b}),k=!0):_&&!b&&(r.track({type:1,doc:_}),k=!0,(u||h)&&(c=!0)),k&&(b?(o=o.add(b),s=O?s.add(f):s.delete(f)):(o=o.delete(f),s=s.delete(f)))}),this.query.limit!==null)for(;o.size>this.query.limit;){let f=this.query.limitType==="F"?o.last():o.first();o=o.delete(f.key),s=s.delete(f.key),r.track({type:1,doc:f})}return{Ja:o,Xa:r,Cs:c,mutatedKeys:s}}eu(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,r,i){let s=this.Ja;this.Ja=e.Ja,this.mutatedKeys=e.mutatedKeys;let o=e.Xa.ga();o.sort((f,g)=>function(b,P){let O=k=>{switch(k){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return U(20277,{Vt:k})}};return O(b)-O(P)}(f.type,g.type)||this.Ha(f.doc,g.doc)),this.tu(r),i=i!=null&&i;let c=t&&!i?this.nu():[],u=this.ja.size===0&&this.current&&!i?1:0,h=u!==this.za;return this.za=u,o.length!==0||h?{snapshot:new si(this.query,e.Ja,s,o,e.mutatedKeys,u===0,h,!1,!!r&&r.resumeToken.approximateByteSize()>0),ru:c}:{ru:c}}Da(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({Ja:this.Ja,Xa:new rc,mutatedKeys:this.mutatedKeys,Cs:!1},!1)):{ru:[]}}iu(e){return!this.Ga.has(e)&&!!this.Ja.has(e)&&!this.Ja.get(e).hasLocalMutations}tu(e){e&&(e.addedDocuments.forEach(t=>this.Ga=this.Ga.add(t)),e.modifiedDocuments.forEach(t=>{}),e.removedDocuments.forEach(t=>this.Ga=this.Ga.delete(t)),this.current=e.current)}nu(){if(!this.current)return[];let e=this.ja;this.ja=Y(),this.Ja.forEach(r=>{this.iu(r.key)&&(this.ja=this.ja.add(r.key))});let t=[];return e.forEach(r=>{this.ja.has(r)||t.push(new oc(r))}),this.ja.forEach(r=>{e.has(r)||t.push(new sc(r))}),t}su(e){this.Ga=e.$s,this.ja=Y();let t=this.Za(e.documents);return this.applyChanges(t,!0)}ou(){return si.fromInitialDocuments(this.query,this.Ja,this.mutatedKeys,this.za===0,this.hasCachedResults)}},jf="SyncEngine",of=class{constructor(e,t,r){this.query=e,this.targetId=t,this.view=r}},af=class{constructor(e){this.key=e,this._u=!1}},cf=class{constructor(e,t,r,i,s,o){this.localStore=e,this.remoteStore=t,this.eventManager=r,this.sharedClientState=i,this.currentUser=s,this.maxConcurrentLimboResolutions=o,this.au={},this.uu=new Jt(c=>sI(c),wc),this.cu=new Map,this.lu=new Set,this.hu=new ge(F.comparator),this.Pu=new Map,this.Tu=new Vs,this.Iu={},this.Eu=new Map,this.du=Ls.lr(),this.onlineState="Unknown",this.Au=void 0}get isPrimaryClient(){return this.Au===!0}};function tP(n,e,t=!0){return y(this,null,function*(){let r=$I(n),i,s=r.uu.get(e);return s?(r.sharedClientState.addLocalQueryTarget(s.targetId),i=s.view.ou()):i=yield LI(r,e,t,!0),i})}function nP(n,e){return y(this,null,function*(){let t=$I(n);yield LI(t,e,!0,!1)})}function LI(n,e,t,r){return y(this,null,function*(){let i=yield UC(n.localStore,bt(e)),s=i.targetId,o=n.sharedClientState.addLocalQueryTarget(s,t),c;return r&&(c=yield rP(n,e,s,o==="current",i.resumeToken)),n.isPrimaryClient&&t&&CI(n.remoteStore,i),c})}function rP(n,e,t,r,i){return y(this,null,function*(){n.Ru=(g,_,b)=>function(O,k,z,$){return y(this,null,function*(){let q=k.view.Za(z);q.Cs&&(q=yield lv(O.localStore,k.query,!1).then(({documents:E})=>k.view.Za(E,q)));let se=$&&$.targetChanges.get(k.targetId),Fe=$&&$.targetMismatches.get(k.targetId)!=null,re=k.view.applyChanges(q,O.isPrimaryClient,se,Fe);return yv(O,k.targetId,re.ru),re.snapshot})}(n,g,_,b);let s=yield lv(n.localStore,e,!0),o=new sf(e,s.$s),c=o.Za(s.documents),u=xs.createSynthesizedTargetChangeForCurrentChange(t,r&&n.onlineState!=="Offline",i),h=o.applyChanges(c,n.isPrimaryClient,u);yv(n,t,h.ru);let f=new of(e,t,o);return n.uu.set(e,f),n.cu.has(t)?n.cu.get(t).push(e):n.cu.set(t,[e]),h.snapshot})}function iP(n,e,t){return y(this,null,function*(){let r=H(n),i=r.uu.get(e),s=r.cu.get(i.targetId);if(s.length>1)return r.cu.set(i.targetId,s.filter(o=>!wc(o,e))),void r.uu.delete(e);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(i.targetId),r.sharedClientState.isActiveQueryTarget(i.targetId)||(yield $d(r.localStore,i.targetId,!1).then(()=>{r.sharedClientState.clearQueryState(i.targetId),t&&Lf(r.remoteStore,i.targetId),uf(r,i.targetId)}).catch(ui))):(uf(r,i.targetId),yield $d(r.localStore,i.targetId,!0))})}function sP(n,e){return y(this,null,function*(){let t=H(n),r=t.uu.get(e),i=t.cu.get(r.targetId);t.isPrimaryClient&&i.length===1&&(t.sharedClientState.removeLocalQueryTarget(r.targetId),Lf(t.remoteStore,r.targetId))})}function oP(n,e,t){return y(this,null,function*(){let r=fP(n);try{let i=yield function(o,c){let u=H(o),h=Re.now(),f=c.reduce((b,P)=>b.add(P.key),Y()),g,_;return u.persistence.runTransaction("Locally write mutations","readwrite",b=>{let P=Xt(),O=Y();return u.Bs.getEntries(b,f).next(k=>{P=k,P.forEach((z,$)=>{$.isValidDocument()||(O=O.add(z))})}).next(()=>u.localDocuments.getOverlayedDocuments(b,P)).next(k=>{g=k;let z=[];for(let $ of c){let q=hC($,g.get($.key).overlayedDocument);q!=null&&z.push(new Dt($.key,q,Xv(q.value.mapValue),Rt.exists(!0)))}return u.mutationQueue.addMutationBatch(b,h,z,c)}).next(k=>{_=k;let z=k.applyToLocalDocumentSet(g,O);return u.documentOverlayCache.saveOverlays(b,k.batchId,z)})}).then(()=>({batchId:_.batchId,changes:cI(g)}))}(r.localStore,e);r.sharedClientState.addPendingMutation(i.batchId),function(o,c,u){let h=o.Iu[o.currentUser.toKey()];h||(h=new ge(K)),h=h.insert(c,u),o.Iu[o.currentUser.toKey()]=h}(r,i.batchId,t),yield qs(r,i.changes),yield Sc(r.remoteStore)}catch(i){let s=Bf(i,"Failed to persist write");t.reject(s)}})}function VI(n,e){return y(this,null,function*(){let t=H(n);try{let r=yield LC(t.localStore,e);e.targetChanges.forEach((i,s)=>{let o=t.Pu.get(s);o&&(ne(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1,22616),i.addedDocuments.size>0?o._u=!0:i.modifiedDocuments.size>0?ne(o._u,14607):i.removedDocuments.size>0&&(ne(o._u,42227),o._u=!1))}),yield qs(t,r,e)}catch(r){yield ui(r)}})}function mv(n,e,t){let r=H(n);if(r.isPrimaryClient&&t===0||!r.isPrimaryClient&&t===1){let i=[];r.uu.forEach((s,o)=>{let c=o.view.Da(e);c.snapshot&&i.push(c.snapshot)}),function(o,c){let u=H(o);u.onlineState=c;let h=!1;u.queries.forEach((f,g)=>{for(let _ of g.ya)_.Da(c)&&(h=!0)}),h&&$f(u)}(r.eventManager,e),i.length&&r.au.j_(i),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}function aP(n,e,t){return y(this,null,function*(){let r=H(n);r.sharedClientState.updateQueryState(e,"rejected",t);let i=r.Pu.get(e),s=i&&i.key;if(s){let o=new ge(F.comparator);o=o.insert(s,pt.newNoDocument(s,W.min()));let c=Y().add(s),u=new qa(W.min(),new Map,new ge(K),o,c);yield VI(r,u),r.hu=r.hu.remove(s),r.Pu.delete(e),qf(r)}else yield $d(r.localStore,e,!1).then(()=>uf(r,e,t)).catch(ui)})}function cP(n,e){return y(this,null,function*(){let t=H(n),r=e.batch.batchId;try{let i=yield MC(t.localStore,e);UI(t,r,null),FI(t,r),t.sharedClientState.updateMutationState(r,"acknowledged"),yield qs(t,i)}catch(i){yield ui(i)}})}function uP(n,e,t){return y(this,null,function*(){let r=H(n);try{let i=yield function(o,c){let u=H(o);return u.persistence.runTransaction("Reject batch","readwrite-primary",h=>{let f;return u.mutationQueue.lookupMutationBatch(h,c).next(g=>(ne(g!==null,37113),f=g.keys(),u.mutationQueue.removeMutationBatch(h,g))).next(()=>u.mutationQueue.performConsistencyCheck(h)).next(()=>u.documentOverlayCache.removeOverlaysForBatchId(h,f,c)).next(()=>u.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(h,f)).next(()=>u.localDocuments.getDocuments(h,f))})}(r.localStore,e);UI(r,e,t),FI(r,e),r.sharedClientState.updateMutationState(e,"rejected",t),yield qs(r,i)}catch(i){yield ui(i)}})}function FI(n,e){(n.Eu.get(e)||[]).forEach(t=>{t.resolve()}),n.Eu.delete(e)}function UI(n,e,t){let r=H(n),i=r.Iu[r.currentUser.toKey()];if(i){let s=i.get(e);s&&(t?s.reject(t):s.resolve(),i=i.remove(e)),r.Iu[r.currentUser.toKey()]=i}}function uf(n,e,t=null){n.sharedClientState.removeLocalQueryTarget(e);for(let r of n.cu.get(e))n.uu.delete(r),t&&n.au.Vu(r,t);n.cu.delete(e),n.isPrimaryClient&&n.Tu.Hr(e).forEach(r=>{n.Tu.containsKey(r)||BI(n,r)})}function BI(n,e){n.lu.delete(e.path.canonicalString());let t=n.hu.get(e);t!==null&&(Lf(n.remoteStore,t),n.hu=n.hu.remove(e),n.Pu.delete(t),qf(n))}function yv(n,e,t){for(let r of t)r instanceof sc?(n.Tu.addReference(r.key,e),lP(n,r)):r instanceof oc?(M(jf,"Document no longer in limbo: "+r.key),n.Tu.removeReference(r.key,e),n.Tu.containsKey(r.key)||BI(n,r.key)):U(19791,{mu:r})}function lP(n,e){let t=e.key,r=t.path.canonicalString();n.hu.get(t)||n.lu.has(r)||(M(jf,"New document in limbo: "+t),n.lu.add(r),qf(n))}function qf(n){for(;n.lu.size>0&&n.hu.size<n.maxConcurrentLimboResolutions;){let e=n.lu.values().next().value;n.lu.delete(e);let t=new F(he.fromString(e)),r=n.du.next();n.Pu.set(r,new af(t)),n.hu=n.hu.insert(t,r),CI(n.remoteStore,new Ms(bt(Ic(t.path)),r,"TargetPurposeLimboResolution",Sf.le))}}function qs(n,e,t){return y(this,null,function*(){let r=H(n),i=[],s=[],o=[];r.uu.isEmpty()||(r.uu.forEach((c,u)=>{o.push(r.Ru(u,e,t).then(h=>{var f;if((h||t)&&r.isPrimaryClient){let g=h?!h.fromCache:(f=t?.targetChanges.get(u.targetId))===null||f===void 0?void 0:f.current;r.sharedClientState.updateQueryState(u.targetId,g?"current":"not-current")}if(h){i.push(h);let g=Vd.Rs(u.targetId,h);s.push(g)}}))}),yield Promise.all(o),r.au.j_(i),yield function(u,h){return y(this,null,function*(){let f=H(u);try{yield f.persistence.runTransaction("notifyLocalViewChanges","readwrite",g=>D.forEach(h,_=>D.forEach(_.ds,b=>f.persistence.referenceDelegate.addReference(g,_.targetId,b)).next(()=>D.forEach(_.As,b=>f.persistence.referenceDelegate.removeReference(g,_.targetId,b)))))}catch(g){if(!li(g))throw g;M(Mf,"Failed to update sequence numbers: "+g)}for(let g of h){let _=g.targetId;if(!g.fromCache){let b=f.xs.get(_),P=b.snapshotVersion,O=b.withLastLimboFreeSnapshotVersion(P);f.xs=f.xs.insert(_,O)}}})}(r.localStore,s))})}function hP(n,e){return y(this,null,function*(){let t=H(n);if(!t.currentUser.isEqual(e)){M(jf,"User change. New user:",e.toKey());let r=yield bI(t.localStore,e);t.currentUser=e,function(s,o){s.Eu.forEach(c=>{c.forEach(u=>{u.reject(new x(C.CANCELLED,o))})}),s.Eu.clear()}(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),yield qs(t,r.ks)}})}function dP(n,e){let t=H(n),r=t.Pu.get(e);if(r&&r._u)return Y().add(r.key);{let i=Y(),s=t.cu.get(e);if(!s)return i;for(let o of s){let c=t.uu.get(o);i=i.unionWith(c.view.Ya)}return i}}function $I(n){let e=H(n);return e.remoteStore.remoteSyncer.applyRemoteEvent=VI.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=dP.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=aP.bind(null,e),e.au.j_=ZC.bind(null,e.eventManager),e.au.Vu=eP.bind(null,e.eventManager),e}function fP(n){let e=H(n);return e.remoteStore.remoteSyncer.applySuccessfulWrite=cP.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=uP.bind(null,e),e}var jI=(()=>{class n{constructor(){this.kind="memory",this.synchronizeTabs=!1}initialize(t){return y(this,null,function*(){this.serializer=Tc(t.databaseInfo.databaseId),this.sharedClientState=this.pu(t),this.persistence=this.yu(t),yield this.persistence.start(),this.localStore=this.wu(t),this.gcScheduler=this.Su(t,this.localStore),this.indexBackfillerScheduler=this.bu(t,this.localStore)})}Su(t,r){return null}bu(t,r){return null}wu(t){return xC(this.persistence,new Ud,t.initialUser,this.serializer)}yu(t){return new Qa(Ld.fi,this.serializer)}pu(t){return new jd}terminate(){return y(this,null,function*(){var t,r;(t=this.gcScheduler)===null||t===void 0||t.stop(),(r=this.indexBackfillerScheduler)===null||r===void 0||r.stop(),this.sharedClientState.shutdown(),yield this.persistence.shutdown()})}}return n.provider={build:()=>new n},n})(),lf=class extends jI{constructor(e){super(),this.cacheSizeBytes=e}Su(e,t){ne(this.persistence.referenceDelegate instanceof Ya,46915);let r=this.persistence.referenceDelegate.garbageCollector;return new Td(r,e.asyncQueue,t)}yu(e){let t=this.cacheSizeBytes!==void 0?nt.withCacheSize(this.cacheSizeBytes):nt.DEFAULT;return new Qa(r=>Ya.fi(r,t),this.serializer)}};var pP=(()=>{class n{initialize(t,r){return y(this,null,function*(){this.localStore||(this.localStore=t.localStore,this.sharedClientState=t.sharedClientState,this.datastore=this.createDatastore(r),this.remoteStore=this.createRemoteStore(r),this.eventManager=this.createEventManager(r),this.syncEngine=this.createSyncEngine(r,!t.synchronizeTabs),this.sharedClientState.onlineStateHandler=i=>mv(this.syncEngine,i,1),this.remoteStore.remoteSyncer.handleCredentialChange=hP.bind(null,this.syncEngine),yield XC(this.remoteStore,this.syncEngine.isPrimaryClient))})}createEventManager(t){return function(){return new nf}()}createDatastore(t){let r=Tc(t.databaseInfo.databaseId),i=function(o){return new Gd(o)}(t.databaseInfo);return function(o,c,u,h){return new Jd(o,c,u,h)}(t.authCredentials,t.appCheckCredentials,i,r)}createRemoteStore(t){return function(i,s,o,c,u){return new Zd(i,s,o,c,u)}(this.localStore,this.datastore,t.asyncQueue,r=>mv(this.syncEngine,r,0),function(){return Xa.C()?new Xa:new qd}())}createSyncEngine(t,r){return function(s,o,c,u,h,f,g){let _=new cf(s,o,c,u,h,f);return g&&(_.Au=!0),_}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,t.initialUser,t.maxConcurrentLimboResolutions,r)}terminate(){return y(this,null,function*(){var t,r;yield function(s){return y(this,null,function*(){let o=H(s);M(ar,"RemoteStore shutting down."),o.Ta.add(5),yield js(o),o.Ea.shutdown(),o.da.set("Unknown")})}(this.remoteStore),(t=this.datastore)===null||t===void 0||t.terminate(),(r=this.eventManager)===null||r===void 0||r.terminate()})}}return n.provider={build:()=>new n},n})();var ac=class{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.vu(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.vu(this.observer.error,e):Kt("Uncaught Error in snapshot listener:",e.toString()))}Cu(){this.muted=!0}vu(e,t){setTimeout(()=>{this.muted||e(t)},0)}};var Rn="FirestoreClient",hf=class{constructor(e,t,r,i,s){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=r,this.databaseInfo=i,this.user=Te.UNAUTHENTICATED,this.clientId=Ma.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=s,this.authCredentials.start(r,o=>y(this,null,function*(){M(Rn,"Received user=",o.uid),yield this.authCredentialListener(o),this.user=o})),this.appCheckCredentials.start(r,o=>(M(Rn,"Received new app check token=",o),this.appCheckCredentialListener(o,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();let e=new At;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(()=>y(this,null,function*(){try{this._onlineComponents&&(yield this._onlineComponents.terminate()),this._offlineComponents&&(yield this._offlineComponents.terminate()),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){let r=Bf(t,"Failed to shutdown persistence");e.reject(r)}})),e.promise}};function Mh(n,e){return y(this,null,function*(){n.asyncQueue.verifyOperationInProgress(),M(Rn,"Initializing OfflineComponentProvider");let t=n.configuration;yield e.initialize(t);let r=t.initialUser;n.setCredentialChangeListener(i=>y(null,null,function*(){r.isEqual(i)||(yield bI(e.localStore,i),r=i)})),e.persistence.setDatabaseDeletedListener(()=>n.terminate()),n._offlineComponents=e})}function _v(n,e){return y(this,null,function*(){n.asyncQueue.verifyOperationInProgress();let t=yield gP(n);M(Rn,"Initializing OnlineComponentProvider"),yield e.initialize(t,n.configuration),n.setCredentialChangeListener(r=>fv(e.remoteStore,r)),n.setAppCheckTokenChangeListener((r,i)=>fv(e.remoteStore,i)),n._onlineComponents=e})}function gP(n){return y(this,null,function*(){if(!n._offlineComponents)if(n._uninitializedComponentsProvider){M(Rn,"Using user provided OfflineComponentProvider");try{yield Mh(n,n._uninitializedComponentsProvider._offline)}catch(e){let t=e;if(!function(i){return i.name==="FirebaseError"?i.code===C.FAILED_PRECONDITION||i.code===C.UNIMPLEMENTED:!(typeof DOMException<"u"&&i instanceof DOMException)||i.code===22||i.code===20||i.code===11}(t))throw t;Yr("Error using user provided cache. Falling back to memory cache: "+t),yield Mh(n,new jI)}}else M(Rn,"Using default OfflineComponentProvider"),yield Mh(n,new lf(void 0));return n._offlineComponents})}function qI(n){return y(this,null,function*(){return n._onlineComponents||(n._uninitializedComponentsProvider?(M(Rn,"Using user provided OnlineComponentProvider"),yield _v(n,n._uninitializedComponentsProvider._online)):(M(Rn,"Using default OnlineComponentProvider"),yield _v(n,new pP))),n._onlineComponents})}function mP(n){return qI(n).then(e=>e.syncEngine)}function df(n){return y(this,null,function*(){let e=yield qI(n),t=e.eventManager;return t.onListen=tP.bind(null,e.syncEngine),t.onUnlisten=iP.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=nP.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=sP.bind(null,e.syncEngine),t})}function yP(n,e,t={}){let r=new At;return n.asyncQueue.enqueueAndForget(()=>y(null,null,function*(){return function(s,o,c,u,h){let f=new ac({next:_=>{f.Cu(),o.enqueueAndForget(()=>MI(s,g));let b=_.docs.has(c);!b&&_.fromCache?h.reject(new x(C.UNAVAILABLE,"Failed to get document because the client is offline.")):b&&_.fromCache&&u&&u.source==="server"?h.reject(new x(C.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):h.resolve(_)},error:_=>h.reject(_)}),g=new ic(Ic(c.path),f,{includeMetadataChanges:!0,La:!0});return xI(s,g)}(yield df(n),n.asyncQueue,e,t,r)})),r.promise}function zI(n){let e={};return n.timeoutSeconds!==void 0&&(e.timeoutSeconds=n.timeoutSeconds),e}var vv=new Map;function HI(n,e,t){if(!t)throw new x(C.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${e}.`)}function _P(n,e,t,r){if(e===!0&&r===!0)throw new x(C.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}function Iv(n){if(!F.isDocumentKey(n))throw new x(C.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function wv(n){if(F.isDocumentKey(n))throw new x(C.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${n} has ${n.length}.`)}function bc(n){if(n===void 0)return"undefined";if(n===null)return"null";if(typeof n=="string")return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if(typeof n=="number"||typeof n=="boolean")return""+n;if(typeof n=="object"){if(n instanceof Array)return"an array";{let e=function(r){return r.constructor?r.constructor.name:null}(n);return e?`a custom ${e} object`:"an object"}}return typeof n=="function"?"a function":U(12329,{type:typeof n})}function it(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new x(C.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{let t=bc(n);throw new x(C.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}var WI="firestore.googleapis.com",Ev=!0,cc=class{constructor(e){var t,r;if(e.host===void 0){if(e.ssl!==void 0)throw new x(C.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=WI,this.ssl=Ev}else this.host=e.host,this.ssl=(t=e.ssl)!==null&&t!==void 0?t:Ev;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=SI;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<kC)throw new x(C.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}_P("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=zI((r=e.experimentalLongPollingOptions)!==null&&r!==void 0?r:{}),function(s){if(s.timeoutSeconds!==void 0){if(isNaN(s.timeoutSeconds))throw new x(C.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (must not be NaN)`);if(s.timeoutSeconds<5)throw new x(C.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (minimum allowed value is 5)`);if(s.timeoutSeconds>30)throw new x(C.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(r,i){return r.timeoutSeconds===i.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}},oi=class{constructor(e,t,r,i){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=r,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new cc({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new x(C.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new x(C.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new cc(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=function(r){if(!r)return new Lh;switch(r.type){case"firstParty":return new Bh(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new x(C.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}_restart(){return y(this,null,function*(){this._terminateTask==="notTerminated"?yield this._terminate():this._terminateTask="notTerminated"})}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(t){let r=vv.get(t);r&&(M("ComponentProvider","Removing Datastore"),vv.delete(t),r.terminate())}(this),Promise.resolve()}};function GI(n,e,t,r={}){var i;n=it(n,oi);let s=Hn(e),o=n._getSettings(),c=Object.assign(Object.assign({},o),{emulatorOptions:n._getEmulatorOptions()}),u=`${e}:${t}`;s&&(Jo(`https://${u}`),Xo("Firestore",!0)),o.host!==WI&&o.host!==u&&Yr("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");let h=Object.assign(Object.assign({},o),{host:u,ssl:s,emulatorOptions:r});if(!lt(h,c)&&(n._setSettings(h),r.mockUserToken)){let f,g;if(typeof r.mockUserToken=="string")f=r.mockUserToken,g=Te.MOCK_USER;else{f=ty(r.mockUserToken,(i=n._app)===null||i===void 0?void 0:i.options.projectId);let _=r.mockUserToken.sub||r.mockUserToken.user_id;if(!_)throw new x(C.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");g=new Te(_)}n._authCredentials=new Vh(new Oa(f,g))}}var cr=class n{constructor(e,t,r){this.converter=t,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new n(this.firestore,e,this._query)}},Le=class n{constructor(e,t,r){this.converter=t,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new En(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new n(this.firestore,e,this._key)}},En=class n extends cr{constructor(e,t,r){super(e,t,Ic(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){let e=this._path.popLast();return e.isEmpty()?null:new Le(this.firestore,null,new F(e))}withConverter(e){return new n(this.firestore,e,this._path)}};function KI(n,e,...t){if(n=fe(n),HI("collection","path",e),n instanceof oi){let r=he.fromString(e,...t);return wv(r),new En(n,null,r)}{if(!(n instanceof Le||n instanceof En))throw new x(C.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");let r=n._path.child(he.fromString(e,...t));return wv(r),new En(n.firestore,null,r)}}function zf(n,e,...t){if(n=fe(n),arguments.length===1&&(e=Ma.newId()),HI("doc","path",e),n instanceof oi){let r=he.fromString(e,...t);return Iv(r),new Le(n,null,new F(r))}{if(!(n instanceof Le||n instanceof En))throw new x(C.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");let r=n._path.child(he.fromString(e,...t));return Iv(r),new Le(n.firestore,n instanceof En?n.converter:null,new F(r))}}var Tv="AsyncQueue",uc=class{constructor(e=Promise.resolve()){this.zu=[],this.ju=!1,this.Hu=[],this.Ju=null,this.Yu=!1,this.Zu=!1,this.Xu=[],this.C_=new Za(this,"async_queue_retry"),this.ec=()=>{let r=xh();r&&M(Tv,"Visibility state changed to "+r.visibilityState),this.C_.p_()},this.tc=e;let t=xh();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this.ec)}get isShuttingDown(){return this.ju}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.nc(),this.rc(e)}enterRestrictedMode(e){if(!this.ju){this.ju=!0,this.Zu=e||!1;let t=xh();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this.ec)}}enqueue(e){if(this.nc(),this.ju)return new Promise(()=>{});let t=new At;return this.rc(()=>this.ju&&this.Zu?Promise.resolve():(e().then(t.resolve,t.reject),t.promise)).then(()=>t.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.zu.push(e),this.sc()))}sc(){return y(this,null,function*(){if(this.zu.length!==0){try{yield this.zu[0](),this.zu.shift(),this.C_.reset()}catch(e){if(!li(e))throw e;M(Tv,"Operation failed with retryable error: "+e)}this.zu.length>0&&this.C_.f_(()=>this.sc())}})}rc(e){let t=this.tc.then(()=>(this.Yu=!0,e().catch(r=>{throw this.Ju=r,this.Yu=!1,Kt("INTERNAL UNHANDLED ERROR: ",Av(r)),r}).then(r=>(this.Yu=!1,r))));return this.tc=t,t}enqueueAfterDelay(e,t,r){this.nc(),this.Xu.indexOf(e)>-1&&(t=0);let i=ef.createAndSchedule(this,e,t,r,s=>this.oc(s));return this.Hu.push(i),i}nc(){this.Ju&&U(47125,{_c:Av(this.Ju)})}verifyOperationInProgress(){}ac(){return y(this,null,function*(){let e;do e=this.tc,yield e;while(e!==this.tc)})}uc(e){for(let t of this.Hu)if(t.timerId===e)return!0;return!1}cc(e){return this.ac().then(()=>{this.Hu.sort((t,r)=>t.targetTimeMs-r.targetTimeMs);for(let t of this.Hu)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.ac()})}lc(e){this.Xu.push(e)}oc(e){let t=this.Hu.indexOf(e);this.Hu.splice(t,1)}};function Av(n){let e=n.message||"";return n.stack&&(e=n.stack.includes(n.message)?n.stack:n.message+`
`+n.stack),e}function Sv(n){return function(t,r){if(typeof t!="object"||t===null)return!1;let i=t;for(let s of r)if(s in i&&typeof i[s]=="function")return!0;return!1}(n,["next","error","complete"])}var kt=class extends oi{constructor(e,t,r,i){super(e,t,r,i),this.type="firestore",this._queue=new uc,this._persistenceKey=i?.name||"[DEFAULT]"}_terminate(){return y(this,null,function*(){if(this._firestoreClient){let e=this._firestoreClient.terminate();this._queue=new uc(e),this._firestoreClient=void 0,yield e}})}};function QI(n,e){let t=typeof n=="object"?n:Gn(),r=typeof n=="string"?n:e||Ua,i=Mr(t,"firestore").getImmediate({identifier:r});if(!i._initialized){let s=ey("firestore");s&&GI(i,...s)}return i}function Hf(n){if(n._terminated)throw new x(C.FAILED_PRECONDITION,"The client has already been terminated.");return n._firestoreClient||vP(n),n._firestoreClient}function vP(n){var e,t,r;let i=n._freezeSettings(),s=function(c,u,h,f){return new Hh(c,u,h,f.host,f.ssl,f.experimentalForceLongPolling,f.experimentalAutoDetectLongPolling,zI(f.experimentalLongPollingOptions),f.useFetchStreams,f.isUsingEmulator)}(n._databaseId,((e=n._app)===null||e===void 0?void 0:e.options.appId)||"",n._persistenceKey,i);n._componentsProvider||!((t=i.localCache)===null||t===void 0)&&t._offlineComponentProvider&&(!((r=i.localCache)===null||r===void 0)&&r._onlineComponentProvider)&&(n._componentsProvider={_offline:i.localCache._offlineComponentProvider,_online:i.localCache._onlineComponentProvider}),n._firestoreClient=new hf(n._authCredentials,n._appCheckCredentials,n._queue,s,n._componentsProvider&&function(c){let u=c?._online.build();return{_offline:c?._offline.build(u),_online:u}}(n._componentsProvider))}var Fs=class n{constructor(e){this._byteString=e}static fromBase64String(e){try{return new n(Ve.fromBase64String(e))}catch(t){throw new x(C.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new n(Ve.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}};var ai=class{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new x(C.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Xe(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}};var ur=class{constructor(e){this._methodName=e}};var Us=class{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new x(C.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new x(C.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return K(this._lat,e._lat)||K(this._long,e._long)}};var Bs=class{constructor(e){this._values=(e||[]).map(t=>t)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(r,i){if(r.length!==i.length)return!1;for(let s=0;s<r.length;++s)if(r[s]!==i[s])return!1;return!0}(this._values,e._values)}};var IP=/^__.*__$/,ff=class{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return this.fieldMask!==null?new Dt(e,this.data,this.fieldMask,t,this.fieldTransforms):new or(e,this.data,t,this.fieldTransforms)}},lc=class{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return new Dt(e,this.data,this.fieldMask,t,this.fieldTransforms)}};function YI(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw U(40011,{hc:n})}}var hc=class n{constructor(e,t,r,i,s,o){this.settings=e,this.databaseId=t,this.serializer=r,this.ignoreUndefinedProperties=i,s===void 0&&this.Pc(),this.fieldTransforms=s||[],this.fieldMask=o||[]}get path(){return this.settings.path}get hc(){return this.settings.hc}Tc(e){return new n(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Ic(e){var t;let r=(t=this.path)===null||t===void 0?void 0:t.child(e),i=this.Tc({path:r,Ec:!1});return i.dc(e),i}Ac(e){var t;let r=(t=this.path)===null||t===void 0?void 0:t.child(e),i=this.Tc({path:r,Ec:!1});return i.Pc(),i}Rc(e){return this.Tc({path:void 0,Ec:!0})}Vc(e){return fc(e,this.settings.methodName,this.settings.mc||!1,this.path,this.settings.fc)}contains(e){return this.fieldMask.find(t=>e.isPrefixOf(t))!==void 0||this.fieldTransforms.find(t=>e.isPrefixOf(t.field))!==void 0}Pc(){if(this.path)for(let e=0;e<this.path.length;e++)this.dc(this.path.get(e))}dc(e){if(e.length===0)throw this.Vc("Document fields must not be empty");if(YI(this.hc)&&IP.test(e))throw this.Vc('Document fields cannot begin and end with "__"')}},pf=class{constructor(e,t,r){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=r||Tc(e)}gc(e,t,r,i=!1){return new hc({hc:e,methodName:t,fc:r,path:Xe.emptyPath(),Ec:!1,mc:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}};function Rc(n){let e=n._freezeSettings(),t=Tc(n._databaseId);return new pf(n._databaseId,!!e.ignoreUndefinedProperties,t)}function JI(n,e,t,r,i,s={}){let o=n.gc(s.merge||s.mergeFields?2:0,e,t,i);Wf("Data must be an object, but it was:",o,r);let c=XI(r,o),u,h;if(s.merge)u=new rt(o.fieldMask),h=o.fieldTransforms;else if(s.mergeFields){let f=[];for(let g of s.mergeFields){let _=yf(e,g,t);if(!o.contains(_))throw new x(C.INVALID_ARGUMENT,`Field '${_}' is specified in your field mask but missing from your input data.`);ew(f,_)||f.push(_)}u=new rt(f),h=o.fieldTransforms.filter(g=>u.covers(g.field))}else u=null,h=o.fieldTransforms;return new ff(new Je(c),u,h)}var dc=class n extends ur{_toFieldTransform(e){if(e.hc!==2)throw e.hc===1?e.Vc(`${this._methodName}() can only appear at the top level of your update data`):e.Vc(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof n}};function wP(n,e,t){return new hc({hc:3,fc:e.settings.fc,methodName:n._methodName,Ec:t},e.databaseId,e.serializer,e.ignoreUndefinedProperties)}var gf=class n extends ur{_toFieldTransform(e){return new ja(e.path,new ir)}isEqual(e){return e instanceof n}},mf=class n extends ur{constructor(e,t){super(e),this.yc=t}_toFieldTransform(e){let t=wP(this,e,!0),r=this.yc.map(s=>di(s,t)),i=new Sn(r);return new ja(e.path,i)}isEqual(e){return e instanceof n&&lt(this.yc,e.yc)}};function EP(n,e,t,r){let i=n.gc(1,e,t);Wf("Data must be an object, but it was:",i,r);let s=[],o=Je.empty();Cn(r,(u,h)=>{let f=Gf(e,u,t);h=fe(h);let g=i.Ac(f);if(h instanceof dc)s.push(f);else{let _=di(h,g);_!=null&&(s.push(f),o.set(f,_))}});let c=new rt(s);return new lc(o,c,i.fieldTransforms)}function TP(n,e,t,r,i,s){let o=n.gc(1,e,t),c=[yf(e,r,t)],u=[i];if(s.length%2!=0)throw new x(C.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let _=0;_<s.length;_+=2)c.push(yf(e,s[_])),u.push(s[_+1]);let h=[],f=Je.empty();for(let _=c.length-1;_>=0;--_)if(!ew(h,c[_])){let b=c[_],P=u[_];P=fe(P);let O=o.Ac(b);if(P instanceof dc)h.push(b);else{let k=di(P,O);k!=null&&(h.push(b),f.set(b,k))}}let g=new rt(h);return new lc(f,g,o.fieldTransforms)}function AP(n,e,t,r=!1){return di(t,n.gc(r?4:3,e))}function di(n,e){if(ZI(n=fe(n)))return Wf("Unsupported field value:",e,n),XI(n,e);if(n instanceof ur)return function(r,i){if(!YI(i.hc))throw i.Vc(`${r._methodName}() can only be used with update() and set()`);if(!i.path)throw i.Vc(`${r._methodName}() is not currently supported inside arrays`);let s=r._toFieldTransform(i);s&&i.fieldTransforms.push(s)}(n,e),null;if(n===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),n instanceof Array){if(e.settings.Ec&&e.hc!==4)throw e.Vc("Nested arrays are not supported");return function(r,i){let s=[],o=0;for(let c of r){let u=di(c,i.Rc(o));u==null&&(u={nullValue:"NULL_VALUE"}),s.push(u),o++}return{arrayValue:{values:s}}}(n,e)}return function(r,i){if((r=fe(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return oC(i.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){let s=Re.fromDate(r);return{timestampValue:Ga(i.serializer,s)}}if(r instanceof Re){let s=new Re(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:Ga(i.serializer,s)}}if(r instanceof Us)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof Fs)return{bytesValue:_I(i.serializer,r._byteString)};if(r instanceof Le){let s=i.databaseId,o=r.firestore._databaseId;if(!o.isEqual(s))throw i.Vc(`Document reference is for database ${o.projectId}/${o.database} but should be for database ${s.projectId}/${s.database}`);return{referenceValue:xf(r.firestore._databaseId||i.databaseId,r._key.path)}}if(r instanceof Bs)return function(o,c){return{mapValue:{fields:{[Cf]:{stringValue:Pf},[Xr]:{arrayValue:{values:o.toArray().map(h=>{if(typeof h!="number")throw c.Vc("VectorValues must only contain numeric values.");return Of(c.serializer,h)})}}}}}}(r,i);throw i.Vc(`Unsupported field value: ${bc(r)}`)}(n,e)}function XI(n,e){let t={};return zv(n)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Cn(n,(r,i)=>{let s=di(i,e.Ic(r));s!=null&&(t[r]=s)}),{mapValue:{fields:t}}}function ZI(n){return!(typeof n!="object"||n===null||n instanceof Array||n instanceof Date||n instanceof Re||n instanceof Us||n instanceof Fs||n instanceof Le||n instanceof ur||n instanceof Bs)}function Wf(n,e,t){if(!ZI(t)||!function(i){return typeof i=="object"&&i!==null&&(Object.getPrototypeOf(i)===Object.prototype||Object.getPrototypeOf(i)===null)}(t)){let r=bc(t);throw r==="an object"?e.Vc(n+" a custom object"):e.Vc(n+" "+r)}}function yf(n,e,t){if((e=fe(e))instanceof ai)return e._internalPath;if(typeof e=="string")return Gf(n,e);throw fc("Field path arguments must be of type string or ",n,!1,void 0,t)}var SP=new RegExp("[~\\*/\\[\\]]");function Gf(n,e,t){if(e.search(SP)>=0)throw fc(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,t);try{return new ai(...e.split("."))._internalPath}catch{throw fc(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,t)}}function fc(n,e,t,r,i){let s=r&&!r.isEmpty(),o=i!==void 0,c=`Function ${e}() called with invalid data`;t&&(c+=" (via `toFirestore()`)"),c+=". ";let u="";return(s||o)&&(u+=" (found",s&&(u+=` in field ${r}`),o&&(u+=` in document ${i}`),u+=")"),new x(C.INVALID_ARGUMENT,c+n+u)}function ew(n,e){return n.some(t=>t.isEqual(e))}var pc=class{constructor(e,t,r,i,s){this._firestore=e,this._userDataWriter=t,this._key=r,this._document=i,this._converter=s}get id(){return this._key.path.lastSegment()}get ref(){return new Le(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){let e=new _f(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){let t=this._document.data.field(Kf("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}},_f=class extends pc{data(){return super.data()}};function Kf(n,e){return typeof e=="string"?Gf(n,e):e instanceof ai?e._internalPath:e._delegate._internalPath}function bP(n){if(n.limitType==="L"&&n.explicitOrderBy.length===0)throw new x(C.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}var $s=class{},gc=class extends $s{};function RP(n,e,...t){let r=[];e instanceof $s&&r.push(e),r=r.concat(t),function(s){let o=s.filter(u=>u instanceof If).length,c=s.filter(u=>u instanceof vf).length;if(o>1||o>0&&c>0)throw new x(C.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(r);for(let i of r)n=i._apply(n);return n}var vf=class n extends gc{constructor(e,t,r){super(),this._field=e,this._op=t,this._value=r,this.type="where"}static _create(e,t,r){return new n(e,t,r)}_apply(e){let t=this._parse(e);return tw(e._query,t),new cr(e.firestore,e.converter,id(e._query,t))}_parse(e){let t=Rc(e.firestore);return function(s,o,c,u,h,f,g){let _;if(h.isKeyField()){if(f==="array-contains"||f==="array-contains-any")throw new x(C.INVALID_ARGUMENT,`Invalid Query. You can't perform '${f}' queries on documentId().`);if(f==="in"||f==="not-in"){Rv(g,f);let P=[];for(let O of g)P.push(bv(u,s,O));_={arrayValue:{values:P}}}else _=bv(u,s,g)}else f!=="in"&&f!=="not-in"&&f!=="array-contains-any"||Rv(g,f),_=AP(c,o,g,f==="in"||f==="not-in");return _e.create(h,f,_)}(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value)}};var If=class n extends $s{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new n(e,t)}_parse(e){let t=this._queryConstraints.map(r=>r._parse(e)).filter(r=>r.getFilters().length>0);return t.length===1?t[0]:gt.create(t,this._getOperator())}_apply(e){let t=this._parse(e);return t.getFilters().length===0?e:(function(i,s){let o=i,c=s.getFlattenedFilters();for(let u of c)tw(o,u),o=id(o,u)}(e._query,t),new cr(e.firestore,e.converter,id(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}};var wf=class n extends gc{constructor(e,t){super(),this._field=e,this._direction=t,this.type="orderBy"}static _create(e,t){return new n(e,t)}_apply(e){let t=function(i,s,o){if(i.startAt!==null)throw new x(C.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(i.endAt!==null)throw new x(C.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new rr(s,o)}(e._query,this._field,this._direction);return new cr(e.firestore,e.converter,function(i,s){let o=i.explicitOrderBy.concat([s]);return new An(i.path,i.collectionGroup,o,i.filters.slice(),i.limit,i.limitType,i.startAt,i.endAt)}(e._query,t))}};function CP(n,e="asc"){let t=e,r=Kf("orderBy",n);return wf._create(r,t)}function bv(n,e,t){if(typeof(t=fe(t))=="string"){if(t==="")throw new x(C.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!iI(e)&&t.indexOf("/")!==-1)throw new x(C.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${t}' contains a '/' character.`);let r=e.path.child(he.fromString(t));if(!F.isDocumentKey(r))throw new x(C.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return H_(n,new F(r))}if(t instanceof Le)return H_(n,t._key);throw new x(C.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${bc(t)}.`)}function Rv(n,e){if(!Array.isArray(n)||n.length===0)throw new x(C.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function tw(n,e){let t=function(i,s){for(let o of i)for(let c of o.getFlattenedFilters())if(s.indexOf(c.op)>=0)return c.op;return null}(n.filters,function(i){switch(i){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(t!==null)throw t===e.op?new x(C.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new x(C.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${t.toString()}' filters.`)}var Ef=class{convertValue(e,t="none"){switch(Tn(e)){case 0:return null;case 1:return e.booleanValue;case 2:return le(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(Yt(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw U(62114,{value:e})}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){let r={};return Cn(e,(i,s)=>{r[i]=this.convertValue(s,t)}),r}convertVectorValue(e){var t,r,i;let s=(i=(r=(t=e.fields)===null||t===void 0?void 0:t[Xr].arrayValue)===null||r===void 0?void 0:r.values)===null||i===void 0?void 0:i.map(o=>le(o.doubleValue));return new Bs(s)}convertGeoPoint(e){return new Us(le(e.latitude),le(e.longitude))}convertArray(e,t){return(e.values||[]).map(r=>this.convertValue(r,t))}convertServerTimestamp(e,t){switch(t){case"previous":let r=vc(e);return r==null?null:this.convertValue(r,t);case"estimate":return this.convertTimestamp(ks(e));default:return null}}convertTimestamp(e){let t=Qt(e);return new Re(t.seconds,t.nanos)}convertDocumentKey(e,t){let r=he.fromString(e);ne(AI(r),9688,{name:e});let i=new Ba(r.get(1),r.get(3)),s=new F(r.popFirst(5));return i.isEqual(t)||Kt(`Document ${s} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),s}};function nw(n,e,t){let r;return r=n?t&&(t.merge||t.mergeFields)?n.toFirestore(e,t):n.toFirestore(e):e,r}var er=class{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}},mc=class extends pc{constructor(e,t,r,i,s,o){super(e,t,r,i,o),this._firestore=e,this._firestoreImpl=e,this.metadata=s}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){let t=new Qr(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){let r=this._document.data.field(Kf("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,t.serverTimestamps)}}},Qr=class extends mc{data(e={}){return super.data(e)}},Tf=class{constructor(e,t,r,i){this._firestore=e,this._userDataWriter=t,this._snapshot=i,this.metadata=new er(i.hasPendingWrites,i.fromCache),this.query=r}get docs(){let e=[];return this.forEach(t=>e.push(t)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach(r=>{e.call(t,new Qr(this._firestore,this._userDataWriter,r.key,r,new er(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){let t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new x(C.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=function(i,s){if(i._snapshot.oldDocs.isEmpty()){let o=0;return i._snapshot.docChanges.map(c=>{let u=new Qr(i._firestore,i._userDataWriter,c.doc.key,c.doc,new er(i._snapshot.mutatedKeys.has(c.doc.key),i._snapshot.fromCache),i.query.converter);return c.doc,{type:"added",doc:u,oldIndex:-1,newIndex:o++}})}{let o=i._snapshot.oldDocs;return i._snapshot.docChanges.filter(c=>s||c.type!==3).map(c=>{let u=new Qr(i._firestore,i._userDataWriter,c.doc.key,c.doc,new er(i._snapshot.mutatedKeys.has(c.doc.key),i._snapshot.fromCache),i.query.converter),h=-1,f=-1;return c.type!==0&&(h=o.indexOf(c.doc.key),o=o.delete(c.doc.key)),c.type!==1&&(o=o.add(c.doc),f=o.indexOf(c.doc.key)),{type:PP(c.type),doc:u,oldIndex:h,newIndex:f}})}}(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}};function PP(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return U(61501,{type:n})}}function DP(n){n=it(n,Le);let e=it(n.firestore,kt);return yP(Hf(e),n._key).then(t=>ow(e,n,t))}var yc=class extends Ef{constructor(e){super(),this.firestore=e}convertBytes(e){return new Fs(e)}convertReference(e){let t=this.convertDocumentKey(e,this.firestore._databaseId);return new Le(this.firestore,null,t)}};function rw(n,e,t){n=it(n,Le);let r=it(n.firestore,kt),i=nw(n.converter,e,t);return Cc(r,[JI(Rc(r),"setDoc",n._key,i,n.converter!==null,t).toMutation(n._key,Rt.none())])}function iw(n,e,t,...r){n=it(n,Le);let i=it(n.firestore,kt),s=Rc(i),o;return o=typeof(e=fe(e))=="string"||e instanceof ai?TP(s,"updateDoc",n._key,e,t,r):EP(s,"updateDoc",n._key,e),Cc(i,[o.toMutation(n._key,Rt.exists(!0))])}function kP(n){return Cc(it(n.firestore,kt),[new Os(n._key,Rt.none())])}function sw(n,e){let t=it(n.firestore,kt),r=zf(n),i=nw(n.converter,e);return Cc(t,[JI(Rc(n.firestore),"addDoc",r._key,i,n.converter!==null,{}).toMutation(r._key,Rt.exists(!1))]).then(()=>r)}function Qf(n,...e){var t,r,i;n=fe(n);let s={includeMetadataChanges:!1,source:"default"},o=0;typeof e[o]!="object"||Sv(e[o])||(s=e[o],o++);let c={includeMetadataChanges:s.includeMetadataChanges,source:s.source};if(Sv(e[o])){let g=e[o];e[o]=(t=g.next)===null||t===void 0?void 0:t.bind(g),e[o+1]=(r=g.error)===null||r===void 0?void 0:r.bind(g),e[o+2]=(i=g.complete)===null||i===void 0?void 0:i.bind(g)}let u,h,f;if(n instanceof Le)h=it(n.firestore,kt),f=Ic(n._key.path),u={next:g=>{e[o]&&e[o](ow(h,n,g))},error:e[o+1],complete:e[o+2]};else{let g=it(n,cr);h=it(g.firestore,kt),f=g._query;let _=new yc(h);u={next:b=>{e[o]&&e[o](new Tf(h,_,g,b))},error:e[o+1],complete:e[o+2]},bP(n._query)}return function(_,b,P,O){let k=new ac(O),z=new ic(b,k,P);return _.asyncQueue.enqueueAndForget(()=>y(null,null,function*(){return xI(yield df(_),z)})),()=>{k.Cu(),_.asyncQueue.enqueueAndForget(()=>y(null,null,function*(){return MI(yield df(_),z)}))}}(Hf(h),f,c,u)}function Cc(n,e){return function(r,i){let s=new At;return r.asyncQueue.enqueueAndForget(()=>y(null,null,function*(){return oP(yield mP(r),i,s)})),s.promise}(Hf(n),e)}function ow(n,e,t){let r=t.docs.get(e._key),i=new yc(n);return new mc(n,i,e._key,r,new er(t.hasPendingWrites,t.fromCache),e.converter)}function a1(){return new gf("serverTimestamp")}function c1(...n){return new mf("arrayUnion",n)}(function(e,t=!0){(function(i){ci=i})(pn),ht(new je("firestore",(r,{instanceIdentifier:i,options:s})=>{let o=r.getProvider("app").getImmediate(),c=new kt(new Fh(r.getProvider("auth-internal")),new $h(o,r.getProvider("app-check-internal")),function(h,f){if(!Object.prototype.hasOwnProperty.apply(h.options,["projectId"]))throw new x(C.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Ba(h.options.projectId,f)}(o,i),o);return s=Object.assign({useFetchStreams:t},s),c._setSettings(s),c},"PUBLIC").setMultipleInstances(!0)),pe(M_,L_,e),pe(M_,L_,"esm2017")})();var Pc=function(){return Pc=Object.assign||function(e){for(var t,r=1,i=arguments.length;r<i;r++){t=arguments[r];for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&(e[s]=t[s])}return e},Pc.apply(this,arguments)};var xP={includeMetadataChanges:!1};function Yf(n,e){return e===void 0&&(e=xP),new On(function(t){var r=Qf(n,e,{next:t.next.bind(t),error:t.error.bind(t),complete:t.complete.bind(t)});return{unsubscribe:r}})}function aw(n){return Yf(n,{includeMetadataChanges:!0})}function cw(n,e){return e===void 0&&(e={}),aw(n).pipe(Z(function(t){return Jf(t,e)}))}function Jf(n,e){var t;e===void 0&&(e={});var r=n.data(e);return!n.exists()||typeof r!="object"||r===null||!e.idField?r:Pc(Pc({},r),(t={},t[e.idField]=n.id,t))}function uw(n){return Yf(n,{includeMetadataChanges:!0}).pipe(Z(function(e){return e.docs}))}function lw(n,e){return e===void 0&&(e={}),uw(n).pipe(Z(function(t){return t.map(function(r){return Jf(r,e)})}))}var zs=class{constructor(e){return e}},hw="firestore",Xf=class{constructor(){return Vr(hw)}};var Zf=new ue("angularfire2.firestore-instances");function MP(n,e){let t=ls(hw,n,e);return t&&new zs(t)}function LP(n){return(e,t)=>{let r=e.runOutsideAngular(()=>n(t));return new zs(r)}}var VP={provide:Xf,deps:[[new Ze,Zf]]},FP={provide:zs,useFactory:MP,deps:[[new Ze,Zf],Bt]};function Tx(n,...e){return pe("angularfire",gn.full,"fst"),an([FP,VP,{provide:Zf,useFactory:LP(n),multi:!0,deps:[Ie,et,mn,Qn,[new Ze,Es],[new Ze,$r],...e]}])}var Ax=Ee(lw,!0);var Sx=Ee(cw,!0);var bx=Ee(sw,!0,2);var Rx=Ee(KI,!0,2);var Cx=Ee(zf,!0,2);var Px=Ee(QI,!0);var Dx=Ee(rw,!0,2);var kx=Ee(iw,!0,2);var dw=class n{message=new Ne(null);display=new Ne(!1);type=new Ne(null);alert$=gr([this.message,this.type,this.display]).pipe(Z(([e,t,r])=>({message:e??"",type:t??void 0,display:r})));displayAlert(e,t){if(!e)throw new Error("Alert message cannot be empty");this.message.next(e),this.type.next(t),this.display.next(!0),setTimeout(()=>{this.display.next(!1),setTimeout(()=>{this.message.next(null),this.type.next(null)},300)},3e3)}closeAlert(){this.display.next(!1),this.message.next(null),this.type.next(null)}static \u0275fac=function(t){return new(t||n)};static \u0275prov=ee({token:n,factory:n.\u0275fac,providedIn:"root"})};export{sE as a,Zu as b,Ft as c,$T as d,jT as e,QT as f,IN as g,wN as h,ZS as i,u_ as j,gh as k,v_ as l,_h as m,ws as n,LO as o,VO as p,FO as q,UO as r,BO as s,$O as t,Re as u,KI as v,RP as w,CP as x,DP as y,rw as z,kP as A,a1 as B,c1 as C,zs as D,Tx as E,Ax as F,Sx as G,bx as H,Rx as I,Cx as J,Px as K,Dx as L,kx as M,dw as N};
