<main>
  @if (modalOpen()) {
  <div class="modal-component">
    <app-chat-create-modal
      (emitChatName)="createChat($event)"
      (closeModal)="modalOpen.set(!modalOpen())"
    />
  </div>
  }

  <section>
    <aside id="left-panel">
      <div class="chat-list">
        <!-- áƒ˜áƒ£áƒ–áƒ”áƒ áƒ˜áƒ¡ áƒ©áƒáƒ¢áƒ”áƒ‘áƒ˜áƒ¡ áƒ“áƒáƒ¡áƒáƒ áƒ”áƒœáƒ“áƒ”áƒ áƒ”áƒ‘áƒšáƒáƒ“ -->
        @for (chat of combinedChats(); track $index) {

        <div
          class="chat-wrap"
          [ngClass]="{ active: currentChat() === chat.chatId }"
        >
          <app-mini-chat [chatData]="chat" (chatSelected)="setChat($event)" />
        </div>

        }
      </div>
      <div class="user-m-profile">
        <!-- áƒ˜áƒ£áƒ–áƒ”áƒ áƒ˜áƒ¡ áƒžáƒáƒ¢áƒáƒ áƒ áƒ›áƒ˜áƒœáƒ˜ áƒžáƒ áƒáƒ¤áƒ˜áƒšáƒ˜ áƒ¡áƒáƒ“áƒáƒª áƒ’áƒáƒ›áƒáƒ©áƒ“áƒ”áƒ‘áƒ áƒ›áƒáƒ¬áƒ•áƒ”áƒ•áƒ”áƒ‘áƒ˜-->
        <app-user-mini-profile [user]="currentUser()" />
      </div>
    </aside>
    <aside id="chat-content">
      <div class="content" [appScroll]="chatContent() || currentChat() !== ''">
        <!-- áƒ›áƒ”áƒ¡áƒ˜áƒ¯áƒ”áƒ‘áƒ˜áƒ¡ áƒ“áƒáƒ¡áƒáƒ áƒ”áƒœáƒ“áƒ”áƒ áƒ”áƒ‘áƒšáƒáƒ“ áƒ’áƒáƒ›áƒáƒ˜áƒ§áƒ”áƒœáƒ”áƒ‘áƒ -->

        @if (loadingChat()) {
        <h1>Loading...</h1>
        }@else if (currentChat() === '') {

        <div class="n-chat">
          <p>ðŸ’¬ No messages yet â€” start the conversation and say hello! ðŸ‘‹</p>
        </div>

        }@else {

        <div class="chat-content-wrap">
          @if (chatContent().length === 0) {

          <div class="n-chat">
            <p>ðŸ’¬ No messages sent yet â€” say hello to members! ðŸ‘‹</p>
          </div>

          } @else { @for (messageData of chatContent(); track $index) {
          <app-chat-content
            [chatContent]="messageData"
            [ngClass]="
              messageData.user_id === currentUser()?.uid ? 'myMsg' : ''
            "
          />
          } }
        </div>
        }
      </div>

      @if (currentChat() !== '') {
      <div class="input-area">
        <form [formGroup]="messageControl" (ngSubmit)="sendMessage()">
          <input
            type="text"
            placeholder="Type your message here..."
            formControlName="message"
          />
          <button type="submit">Send</button>
          <button type="button" (click)="modalOpen.set(!modalOpen())">
            Create chat
          </button>
        </form>
      </div>
      }
    </aside>
  </section>
</main>
